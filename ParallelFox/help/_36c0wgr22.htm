<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head> 
	<topictype value="TOPIC" />
	<title>Running Code in Parallel</title>
	<link rel="stylesheet" type="text/css" href="templates/wwhelp.css">
	<script src="templates/wwhelp.js" type="text/javascript"></script>
</head>
<body>
<div class="banner">
  <div>
		  <img src="bmp/seealso.gif" border=0  alt="Related Topics" style="cursor:hand" onmouseover="SeeAlsoButton();" />
	<div id="See" class="hotlinkbox" style="display:none" onmouseleave="SeeAlsoButton();">
	  <b>See also</b><br>
	  <div class="seealsotopics"><a href="_36c0wgcqa.htm" >Training Videos</a> <br/> 
<a href="_36c0walje.htm" >parallel::Do</a> <br/> 
<a href="_36c0waljj.htm" >parallel::Call</a> <br/> 
<a href="_36c0waljm.htm" >parallel::CallMethod</a> <br/> 
<a href="_36c0waljh.htm" >parallel::DoCmd</a> <br/> 
<a href="_36c0walji.htm" >parallel::ExecScript</a> <br/> 
<a href="_36c0waljl.htm" >parallel::Wait</a></div>
	</div>
	<span class="projectname">ParallelFox</span>
 </div>
 <div class="topicname">
	<img src="bmp/TOPIC.gif">&nbsp;Running Code in Parallel
 </div>
</div>

<div class="contentpane">

<div class="contentbody">ParallelFox offers a variety of ways to run your programs in parallel:<p><a href="_36c0walje.htm" >Parallel.Do()</a>: Execute a program or procedure on worker.<br><a href="_36c0waljj.htm" >Parallel.Call()</a>: Execute/call a function on worker.<br><a href="_36c0waljm.htm" >Parallel.CallMethod()</a>: Execute/call a class method on worker.<br><a href="_36c0waljh.htm" >Parallel.DoCmd()</a>: Execute a single command on worker.<br><a href="_36c0walji.htm" >Parallel.ExecScript()</a>: Execute a script on worker.<p>All of these methods contain an <b>lAllWorkers</b> parameter that tells ParallelFox to run your command on all workers, rather than just one.  This is handy for setting up the environment in the worker processes.  Perhaps your main process has a startup program that instantiates an application object and establishes your environment.  You'll probably want to do the same types of things in your workers, but it needs to be done on all workers before you run other programs.  Pass .T. as lAllWorkers to run your command on all workers.<p>ParallelFox adds commands to a queue, then executes those commands as workers become available.  You can queue as many commands as you like, but the number of workers determines how many commands will run simultaneously.<p>All commands run asynchronously, so there will be times you need to tell the main process to wait until your commands are complete before continuing. <a href="_36c0waljl.htm" >Parallel.Wait()</a> is used for that purpose.  Here is a simple example:<p><pre><div class="vfpcode"><span class="programcontrol">Local</span> Parallel as Parallel
Parallel = <span class="functions">NewObject</span>(<span class="codestring">"Parallel"</span>, <span class="codestring">"ParallelFox.vcx"</span>)

<span class="programcontrol">For</span> i = 1 <span class="commands">to</span> 100
   Parallel.<span class="programcontrol">Do</span>(<span class="codestring">"MyProgram"</span>,,,i)
<span class="programcontrol">EndFor</span> 
<span class="codecomment">* Wait until commands are complete</span>
Parallel.<span class="commands">Wait</span>()
<span class="codecomment">* Continue rest of program in main process</span></div></pre><p>For a more in-depth discussion of this topic including examples, be sure to watch the training video.
</div>

<h3 class="outdent">See also</h3><a href="_36c0wgcqa.htm" >Training Videos</a> | 
<a href="_36c0walje.htm" >parallel::Do</a> | 
<a href="_36c0waljj.htm" >parallel::Call</a> | 
<a href="_36c0waljm.htm" >parallel::CallMethod</a> | 
<a href="_36c0waljh.htm" >parallel::DoCmd</a> | 
<a href="_36c0walji.htm" >parallel::ExecScript</a> | 
<a href="_36c0waljl.htm" >parallel::Wait</a>

</div><hr />
<small>&nbsp;&nbsp;Last Updated: 03/26/11 | 
&copy Joel Leach, 2012</small>
<br clear="all" />
<br/>
</body>
</html>