# Changes Made to Thor 2021-12-28

These changes were made so Thor's Check for Updates function now checks GitHub rather than VFPXRepository.com for updates.

## Thor Changes

* Thor\Source\Thor_Main.prg: changed the #DEFINE in the GetThor_Proc_Check_For_Updates function to point to GitHub instead of VFPXRepository.com and added SET SAFETY OFF. Also, added TRY around copying files to CreateThorInternalTools. Also, added this:

    ```
    loThor = execscript(_screen.cThorDispatcher, 'Thor Engine=')
    addproperty(_screen, 'cThorAppFolder', loThor.cAppFolder)
    ```

  before CLEAR ALL and this:

    ```
    if lower(loUpdate.AppName) = 'thor.app'
    	erase (addbs(_screen.cThorAppFolder) + 'Thor.app')
    endif
    ```

    just before the RETURN statement in the code generated by the GetThor_Proc_DownloadAndInstallUpdates function

* Thor\Source\ThorVersion.h: changed #DEFINEs to version 1.43

* Thor\Source\Procs_For_Thor\Thor_Proc_Check_For_Updates.prg: changed #DEFINE to point to GitHub instead of VFPXRepository.com

* Thor\Source\Thor_Run.vcx: changed AssignThorDispatcher to use a TRY structure around this statement:

    ```
    _Screen.AddProperty('oThor', Newobject ('oThor', 'Thor.vcx', lcThorApp, lcThorFolder))
    ```

    This prevents an error after Thor.app is deleted while being being updated.

* Thor\Source\Thor_UI.vcx, Thor_UI.h, Thor_Run.vcx, ThorFormRunTool.scx, and Thor_Main.prg: removed CodePlex references (had updated them 2018-04-10 but left in commented code)

* Built updated Thor\Thor.app

* Added ThorUpdater folder with the following contents:
	* _ThorVersionFile.txt: the updated version from http://vfpxrepository.com/dl/ThorUpdate/Thor as discussed below
	* Thor.zip: the Thor source code (zipped contents of Thor folder, with no root folder i.e. the zip contains Source and Thor.app)
	* Updates.zip: a ZIP file containing updated versions of the updater PRGs from http://vfpxrepository.com/dl/ThorUpdate/Updater_PRGs, most of which now point to GitHub instead of VFPXRepository.com (those that weren't updated point to sites other than VFPX)

## VFPXRepository.com Changes

* Updated http://vfpxrepository.com/dl/ThorUpdate/Thor/_ThorVersionFile.txt: when downloaded and run, it updates Thor_Proc_Check_For_Updates.prg to point to GitHub instead of VFPXRepository.com, SourceFileURL points to GitHub instead of VFPXRepository.com, and AvailableVersion is 1.43
