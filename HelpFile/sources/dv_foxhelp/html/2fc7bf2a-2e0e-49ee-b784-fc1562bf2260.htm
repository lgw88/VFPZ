<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>DEFINE BAR Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">DEFINE BAR Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Creates a menu item on a menu created with DEFINE POPUP.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
DEFINE BAR <span class="parameter">nMenuItemNumber1</span> | <span class="parameter">SystemItemName </span>OF <span class="parameter">MenuName</span> 
   PROMPT <span class="parameter">cMenuItemText</span> [PICTURE <span class="parameter">cFileName</span>] [PICTRES c<span class="parameter">MenubarName</span>]
   [BEFORE <span class="parameter">nMenuItemNumber2</span> | AFTER <span class="parameter">nMenuItemNumber3</span>]
   [FONT <span class="parameter">cFontName</span> [, <span class="parameter">nFontSize</span> [, <span class="parameter">nFontCharSet</span>]]] [STYLE <span class="parameter">cFontStyle</span>]
   [KEY <span class="parameter">KeyLabel</span> [, <span class="parameter">cKeyText</span>]] [MARK <span class="parameter">cMarkCharacter</span>]
   [MESSAGE <span class="parameter">cMessageText</span>] [SKIP [FOR <span class="parameter">lExpression</span>]] 
   [COLOR SCHEME <span class="parameter">nSchemeNumber</span> | COLOR <span class="parameter">ColorPairList</span>] 
   [MRU] [INVERT]</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">nMenuItemNumber1</span>
        </span></dt><dd>
          <p>Specifies the menu item number. The menu item number makes it possible for you to reference the menu item in other commands and functions.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">SystemItemName</span>
        </span></dt><dd>
          <p>Specifies a menu item on the Visual FoxPro system menu. For example, to provide access to the Print menu item, issue the following:  </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR _MFI_PRINT OF popMyPopup PROMPT "Print..."</pre></td></tr></table></span></div>
          <p>Not all Visual FoxPro system menu items are available. Use SYS(2013) to return a list of the Visual FoxPro system menu names that are available. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">OF <span class="parameter">MenuName</span></span></dt><dd>
          <p>Specifies the name of the menu on which the menu items are placed.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">PROMPT <span class="parameter">cMenuItemText</span></span></dt><dd>
          <p>Specifies the caption that appears on the menu item.</p>
          <p>You can create a separator bar by specifying a backslash and a dash (\-) for <span class="parameter">cMenuItemText</span>. A separator bar is used to separate item groups on a menu. For example, including the following command in a menu definition creates a separator bar between the third and fifth menu items:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR 4 OF popMyPopup PROMPT '\-'</pre></td></tr></table></span></div>
          <p>You can create multi-column menus by specifying a backslash and a vertical bar (\|) at the beginning of <span class="parameter">cMenuItemText</span>. The menu item starts a new column, and subsequent menu items are placed in the same column until another menu item beginning with \| is encountered. For example, including the following command in a menu definition creates a new column in the menu:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR 4 OF popMyPopup PROMPT '\|Start a new column'</pre></td></tr></table></span></div>
          <p>You can create an access key for a menu item by placing a backslash and a less-than sign (\&lt;) before the character to be the access key. For example:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE POPUP popReceive
DEFINE BAR 1 OF popReceive PROMPT '\&lt;Invoices'
DEFINE BAR 2 OF popReceive PROMPT 'In\&lt;quiry'
ACTIVATE POPUP popReceive</pre></td></tr></table></span></div>
          <p>The user can press the I key to choose Invoices from the Receive menu and press the Q key to choose Inquiry from the same menu. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">PICTURE <span class="parameter">cPictureName </span></span></dt><dd>
          <p>Enables you to use an existing image with the menu bar. You can specify <span class="parameter">cPictureName</span> in a relative path.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">PICTRES <span class="parameter">cMenubarName</span></span></dt><dd>
          <p>Specifies a system menu bar name as a resource for a menu. If <span class="parameter">cPictureName </span>= "", then contents of Resname field of the .mnx table structure is treated as filename for use in DEFINE BAR...PICTURE. This functionality was introduced in Visual FoxPro 7.0.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>You must include a MARGIN clause in the appropriate DEFINE POPUP command in order for the PICTURE or PICTRES clauses to function properly.</p>
          </td></tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">BEFORE <span class="parameter">nMenuItemNumber2</span></span></dt><dd>
          <p>Places a menu item before the menu item specified with <span class="parameter">nMenuItemNumber2</span>.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">AFTER <span class="parameter">nMenuItemNumber3</span></span></dt><dd>
          <p>Places a menu item after the menu item specified with <span class="parameter">nMenuItemNumber3</span>.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>In order for BEFORE or AFTER to have an effect, you must include the RELATIVE clause when you create the menu with DEFINE POPUP.</p>
          </td></tr></table></div>
          <p>You can also include _MFIRST and _MLAST in the BEFORE and AFTER clauses. If you include_MFIRST in the BEFORE clause, the menu item is the first item on the menu. If you include_MFIRST in the AFTER clause, the menu item is the second item on the menu. If you include_MLAST in the AFTER clause, the menu item is the last item on the menu. If you include_MLAST in the BEFORE clause, the menu item is the next-to-last item on the menu.   </p>
          <p>Menus created with DEFINE POPUP RELATIVE do not reserve space for undefined menu items. For example, if you define items 1, 2, 4, and 5 on a menu, a space for item 3 is not reserved. You can later insert item 3. The menu expands to accommodate it.   </p>
          <p>The following program displays the differences in the order and placement of the items on each type of menu:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>   * DEFINE POPUP... relative example
   DEFINE POPUP popRelatYes RELATIVE FROM 1,1
   DEFINE BAR 4  OF popRelatYes PROMPT '4444'
   DEFINE BAR 3  OF popRelatYes PROMPT '3333'
   DEFINE BAR 2  OF popRelatYes PROMPT '2222'
   DEFINE BAR 1  OF popRelatYes PROMPT '1111'
   DEFINE BAR 6  OF popRelatYes PROMPT '6666' BEFORE 4
   
   * DEFINE POPUP... non-relative example
   DEFINE POPUP popRelatNo FROM 1,10
   DEFINE BAR 4 OF popRelatNo PROMPT '4444'
   DEFINE BAR 3 OF popRelatNo PROMPT '3333'
   DEFINE BAR 2 OF popRelatNo PROMPT '2222'
   DEFINE BAR 1 OF popRelatNo PROMPT '1111'
   DEFINE BAR 6 OF popRelatNo PROMPT '6666'
   ACTIVATE POPUP popRelatYes NOWAIT
             &amp;&amp; Display "relative" poup
   ACTIVATE POPUP popRelatNo
             &amp;&amp; Display "non-relative" popup</pre></td></tr></table></span></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">FONT <span class="parameter">cFontName</span>[, <span class="parameter">nFontSize</span> [, <span class="parameter">nFontCharSet</span>]] </span></dt><dd>
          <p>Specifies a font for the menu item. <span class="parameter">cFontName</span> specifies the name of the font, and <span class="parameter">nFontSize</span> specifies the point size. You can specify a language script with <span class="parameter">nFontCharSet</span>. See the <span class="linkTerms"><a href="/html/53a11bb9-6a3b-4539-a343-ffd75ae45dbe.htm">GETFONT( ) Function</a></span> for a list of available language script values.</p>
          <p>For example, the following command creates a menu item in 12-point Courier font:  </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR 1 OF popReceive PROMPT '\&lt;Invoices' FONT 'Courier', 12</pre></td></tr></table></span></div>
          <p>If the font you specify is not available, a font with similar font characteristics is substituted. If you include the FONT clause but omit the point size <span class="parameter">nFontSize</span>, a 10-point font is used. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">STYLE <span class="parameter">cFontStyle</span></span></dt><dd>
          <p>Specifies a font style for the menu item. If you omit the STYLE clause, the normal font style is used. If the font style you specify is not available, the normal font style is used.</p>
          <p>The font styles you can specify with <span class="parameter">cFontStyle</span> are as follows:   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  Character
                </th>
                <th>
                  Font style
                </th>
              </tr><tr>
              <td>
                <p>B</p>
              </td>
              <td>
                <p>Bold</p>
              </td>
            </tr><tr>
              <td>
                <p>I</p>
              </td>
              <td>
                <p>Italic</p>
              </td>
            </tr><tr>
              <td>
                <p>N</p>
              </td>
              <td>
                <p>Normal</p>
              </td>
            </tr><tr>
              <td>
                <p>Q</p>
              </td>
              <td>
                <p>Opaque</p>
              </td>
            </tr><tr>
              <td>
                <p>–</p>
              </td>
              <td>
                <p>Strikeout </p>
              </td>
            </tr><tr>
              <td>
                <p>T</p>
              </td>
              <td>
                <p>Transparent</p>
              </td>
            </tr><tr>
              <td>
                <p>U</p>
              </td>
              <td>
                <p>Underline</p>
              </td>
            </tr></table></div>
          <p>You can include more than one character to specify a combination of font styles. For example, the following command specifies Bold Italic:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>   DEFINE BAR 1 OF popReceive PROMPT '\&lt;Invoices' STYLE 'BI'</pre></td></tr></table></span></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">KEY <span class="parameter">KeyLabel</span>[, <span class="parameter">cKeyText</span>] </span></dt><dd>
          <p>Specifies an access key or key combination for a menu item. The menu does not have to be activated in order for the menu item to be chosen, unlike when you assign an access key using a backslash and a less-than sign (\&lt;).</p>
          <p>For a list of available keys and key combinations and their key label names, see <span class="linkTerms"><a href="/html/3b90dacf-2ab1-4457-b73a-70fbad80948c.htm">ON KEY LABEL Command</a></span>.   </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>If a keyboard macro is already defined with the same key label, the keyboard macro takes precedence, and the menu item cannot be chosen with the specified key or key combination.</p>
          </td></tr></table></div>
          <p>Include <span class="parameter">cKeyText</span> to replace the key label with your own text. You can use any character in the <span class="parameter">cKeyText</span> parameter; for example, you can use the text "^B" to indicate a key label of CTRL+B. For example, including KEY CTRL+B places the text CTRL+B on the menu to the right of the menu item name, but specifying KEY CTRL+B, "^B" places the text ^+B on the menu. You can suppress the display of a key label by specifying an empty string for <span class="parameter">cKeyText</span>. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">MARK <span class="parameter">cMarkCharacter</span></span></dt><dd>
          <p>Specifies a mark character that appears to the left of the menu item. MARK can be included to change the default mark character to a character specified with <span class="parameter">cMarkCharacter</span>. If <span class="parameter">cMarkCharacter</span> includes more than one character, only the first character is used as the mark character.</p>
          <p>The default mark character is a check.   </p>
          <p>The MARK clause is ignored and the default mark character is used if the menu containing the menu item is integrated into the Visual FoxPro system menu. Also, the MARK clause is ignored if FoxFont is not the font for the main Visual FoxPro window or the user-defined window in which the menu containing the menu item is placed.   </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>Specifying a mark character does not mark a menu item. Use SET MARK OF to mark a menu item.</p>
          </td></tr></table></div>
          <p>Mark characters specified in DEFINE BAR take precedence over mark characters specified with MARK in DEFINE POPUP. SET MARK OF is used to toggle mark characters on or off, and can also be used to specify a mark character for an individual menu item or for all menu items. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">MESSAGE <span class="parameter">cMessageText</span></span></dt><dd>
          <p>Displays a message when the user selects a menu item. The message is placed in the graphical status bar. If the graphical status bar is turned off with SET STATUS BAR OFF, the message is centered on the last line of the main Visual FoxPro window.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">SKIP [FOR <span class="parameter">lExpression</span>] </span></dt><dd>
          <p>Specifies a condition whereby if <span class="parameter">lExpression</span> evaluates to true (.T.), the menu item is disabled, preventing the user from choosing it; if false (.F.), the menu item is enabled. A disabled menu item appears in the disabled colors.</p>
          <p>You can also disable a menu item by placing a backslash (\) before the text of the prompt. For example:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR 1 OF popReceive PROMPT '\Invoices'</pre></td></tr></table></span></div>
          <p>A menu item disabled with SKIP or \ cannot be selected.  </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">COLOR SCHEME <span class="parameter">nSchemeNumber</span></span></dt><dd>
          <p>Specifies the colors for an individual menu item, overriding the default colors or the colors specified with DEFINE POPUP.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">COLOR <span class="parameter">ColorPairList</span></span></dt><dd>
          <p>Specifies the colors for an individual menu item, overriding the default colors or the colors specified with DEFINE POPUP. You can specify the colors of all menu items, mark characters, and messages.</p>
          <p>By default, the colors of menu items are determined by color scheme 2 of the current color set. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">MRU </span></dt><dd>
          <p>Specifies that the menu displays vertical chevrons indicating a Most Recently Used type menu. You must provide script that dynamically handles the menus and adds any new menu bars. For menus invoked with the MRU keyword, Visual FoxPro imposes a 1-2 second delay before triggering the ON SELECTION BAR command. A user can click on the menu bar to immediately trigger the ON SELECTION BAR command.</p>
          <p>If you use the MRU keyword, Visual FoxPro ignores PROMPT and other keywords associated with the bar.   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR 4 OF popMyPopup MRU</pre></td></tr></table></span></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">INVERT </span></dt><dd>
          <p>Specifies that the menu displays with a sunken effect.  </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE BAR 4 OF popMyPopup PROMPT '\|Start a new column' ;
   PICTRES _med_copy INVERT</pre></td></tr></table></span></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>DEFINE BAR is used with DEFINE POPUP to create menus. A menu is created and assigned a name with DEFINE POPUP. Menu items are placed on the menu with a series of DEFINE BAR commands.</p>
      <p>If you use the <span class="linkTerms"><a href="/html/331479bc-d5c1-4d26-8394-d04673f0dd0c.htm">Menu and Shortcut Designers</a></span> to create your menu, you may not have to use these commands at all. The Menu Designer automatically creates the commands for your menu. The Menu Designer uses the Visual FoxPro system menu, which you can then modify by adding your own menu items. For more information on creating menus, see <span class="linkTerms"><a href="/html/21eaee88-6fbe-452b-839d-aa519d16892c.htm">Designing Menus and Toolbars</a></span>.</p>
      <p>You can also create a menu that contains records or fields from a table or a list of files available on disk. For more information, see the PROMPT FIELD, PROMPT STRUCTURE and PROMPT FILES clauses in <span class="linkTerms"><a href="/html/fc04167c-d5e1-4933-bbfb-95fd6115413a.htm">DEFINE POPUP Command</a></span>.</p>
      <p>Use ON BAR to create a cascading submenu for a menu item.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">The following example uses DEFINE BAR to create items on menus. The current system menu bar is first saved to memory with SET SYSMENU SAVE, and then all system menu titles are removed with SET SYSMENU TO.</p>
        <p xmlns="">Two new system menu titles are created with DEFINE PAD, and DEFINE POPUP is used to create a drop-down menu for each menu title. DEFINE BAR is used to create items on each of the menus. When a menu title is chosen, ON PAD uses ACTIVATE POPUP to activate the corresponding menu.</p>
        <p xmlns="">When an item is chosen from a menu, ON SELECTION POPUP uses PROMPT( ) and POPUP( ) to pass the item number and menu name to the CHOICE procedure. CHOICE displays the prompt of the chosen item and the name of the menu containing the item. If Exit is chosen from the Card Info menu, the original Visual FoxPro system menu is restored.</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>   *** Name this program DEFINBAR.PRG ***
   CLEAR
   SET SYSMENU SAVE
   SET SYSMENU TO
   DEFINE PAD convpad OF _MSYSMENU PROMPT '\&lt;Conversions' COLOR SCHEME 3 ;
      KEY ALT+C, ''
   DEFINE PAD cardpad OF _MSYSMENU PROMPT 'Card \&lt;Info' COLOR SCHEME 3 ;
      KEY ALT+I, ''
   ON PAD convpad OF _MSYSMENU ACTIVATE POPUP conversion
   ON PAD cardpad OF _MSYSMENU ACTIVATE POPUP cardinfo
   DEFINE POPUP conversion MARGIN RELATIVE COLOR SCHEME 4
   DEFINE BAR 1 OF conversion PROMPT 'Ar\&lt;ea' KEY CTRL+E, '^E'
   DEFINE BAR 2 OF conversion PROMPT '\&lt;Length' ;
      KEY CTRL+L, '^L'
   DEFINE BAR 3 OF conversion PROMPT 'Ma\&lt;ss' ;
      KEY CTRL+S, '^S'
   DEFINE BAR 4 OF conversion PROMPT 'Spee\&lt;d' ;
      KEY CTRL+D, '^D'
   DEFINE BAR 5 OF conversion PROMPT '\&lt;Temperature' ;
      KEY CTRL+T, '^T'
   DEFINE BAR 6 OF conversion PROMPT 'T\&lt;ime' ;
      KEY CTRL+I, '^I'
   DEFINE BAR 7 OF conversion PROMPT 'Volu\&lt;me' ;
      KEY CTRL+M, '^M'
   ON SELECTION POPUP conversion;
      DO choice IN definbar WITH PROMPT( ), POPUP( )
   DEFINE POPUP cardinfo MARGIN RELATIVE COLOR SCHEME 4
   DEFINE BAR 1 OF cardinfo PROMPT '\&lt;View Charges' ;
      KEY ALT+V, ''
   DEFINE BAR 2 OF cardinfo PROMPT 'View \&lt;Payments' ;
      KEY ALT+P, ''
   DEFINE BAR 3 OF cardinfo PROMPT 'Vie\&lt;w Users' KEY ALT+W, ''
   DEFINE BAR 4 OF cardinfo PROMPT '\-'
   DEFINE BAR 5 OF cardinfo PROMPT '\&lt;Charges '
   DEFINE BAR 6 OF cardinfo PROMPT '\-'
   DEFINE BAR 7 OF cardinfo PROMPT 'E\&lt;xit '
   ON SELECTION POPUP cardinfo;
      DO choice IN definbar WITH PROMPT( ), POPUP( )
   PROCEDURE choice
   PARAMETERS mprompt, mpopup
   WAIT WINDOW 'You chose ' + mprompt + ;
      ' from popup ' + mpopup NOWAIT
   IF mprompt = 'Exit'
      SET SYSMENU TO DEFAULT
   ENDIF</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/03809745-bd0d-4ba4-9871-4d0dfdead918.htm">ACTIVATE POPUP Command</a></span><br /><span class="linkTerms"><a href="/html/fe1d7478-6eed-4a3b-b109-3dff56409a9d.htm">DEACTIVATE POPUP Command</a></span><br /><span class="linkTerms"><a href="/html/fc04167c-d5e1-4933-bbfb-95fd6115413a.htm">DEFINE POPUP Command</a></span><br /><span class="linkTerms"><a href="/html/d34e9ca8-bc8d-4d95-990e-4ac4d2b4d770.htm">HIDE POPUP Command</a></span><br /><span class="linkTerms"><a href="/html/6c574fd8-d2a0-48cf-8c60-24199b8cda37.htm">RELEASE BAR Command</a></span><br /><span class="linkTerms"><a href="/html/c90cace5-fb83-4d3a-8cd0-1347321744b6.htm">SET MESSAGE Command</a></span><br /><span class="linkTerms"><a href="/html/94d22fc1-ab55-4366-adba-181ee17d8dc2.htm">SHOW POPUP Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="DEFINE BAR Command">
<param name="ALink Name" value="DEFINE BAR">
</OBJECT>
