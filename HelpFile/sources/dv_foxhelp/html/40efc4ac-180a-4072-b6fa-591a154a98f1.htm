<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>TEXT ... ENDTEXT Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">TEXT ... ENDTEXT Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Sends lines of text specified by <span class="parameter">TextLines</span> to the current output device or memory variable. Visual FoxPro sends lines of text to the current output device until it encounters an <b>ENDTEXT</b> statement or until the program ends. </p>
    <p>The current output device can include the main Visual FoxPro window, a user-defined window, a printer, a text file, or a low-level file.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
TEXT [TO <span class="parameter">VarName</span> [ADDITIVE] [TEXTMERGE] [NOSHOW] [FLAGS <span class="parameter">nValue</span>] [PRETEXT <span class="parameter">eExpression</span>]]
      <span class="parameter">TextLines</span>
ENDTEXT</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">TextLines</span>
        </span></dt><dd>
          <p>Specifies text to send to the current output device. <span class="parameter">TextLines</span> can consist of text, memory variables, array elements, expressions, functions, or any combination of these.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>Visual FoxPro evaluates expressions, functions, memory variables, and array elements specified with <span class="parameter">TextLines</span> only if you set <b>SET TEXTMERGE</b> to <code>ON</code> and enclose them with the delimiters specified by <b>SET TEXTMERGE DELIMITERS</b>. If <b>SET TEXTMERGE</b> is <code>OFF</code>, Visual FoxPro outputs expressions, functions, memory variables, and array elements as string literals along with their delimiters.</p>
          </td></tr></table></div>
          <p>For example, Visual FoxPro evaluates and outputs the current date when you specify the <code>DATE( )</code> function as <span class="parameter">TextLines</span> only if <b>SET TEXTMERGE</b> is <code>ON</code>, and <span class="parameter">TextLines</span> contains the function and the appropriate delimiters, such as <code>&lt;&lt;DATE( )&gt;&gt;</code>. If <b>SET TEXTMERGE</b> is <code>OFF</code>, Visual FoxPro outputs <code>&lt;&lt;DATE( )&gt;&gt;</code> as a string literal.</p>
          <p>If you place comments within <b>TEXT</b>...<b>ENDTEXT</b> or after the single backslash character (\) or double backslash characters (\\), Visual FoxPro outputs the comments. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">TO <span class="parameter">VarName</span></span></dt><dd>
          <p>Specifies the memory variable name to use for passing the contents of the <b>TEXT...ENDTEXT</b>. This variable can already exist. </p>
          <p>If the variable has not yet been declared, Visual FoxPro automatically creates it as a private variable. The <b>TO</b> clause operates regardless of how <b>SET TEXTMERGE</b> is set. If <b>SET TEXTMERGE</b> is set to a file, and the <b>TO</b> statement is included, Visual FoxPro outputs both the file and variable. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">ADDITIVE </span></dt><dd>
          <p>Determines whether the contents of the <b>TO</b> variable are overwritten or added to existing contents. </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>If the contents of <b>TO </b> <span class="parameter">VarName</span> is not a string, Visual FoxPro always overwrites the contents in <span class="parameter">VarName</span>.</p>
          </td></tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">TEXTMERGE </span></dt><dd>
          <p>Enables evaluation of contents surrounded by delimiters without setting <b>SET TEXTMERGE</b> to <code>ON</code>.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">NOSHOW </span></dt><dd>
          <p>Disables display of the text merge to the screen.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">FLAGS <span class="parameter">nValue</span></span></dt><dd>
          <p>Specifies a numerical value that determines if output is suppressed to an output file, or if blank lines preceding any text are included in the output.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>Value (additive)</b>
                  
                </th>
                <th>
                  
                    <b>Description</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>1</p>
              </td>
              <td>
                <p>Suppresses output to the file specified with the <span class="linkTerms"><a href="/html/231cebe2-8608-4a2d-83dd-4b9103b1b8c8.htm">_TEXT System Variable</a></span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>2</p>
              </td>
              <td>
                <p>When the NOSHOW clause is included, preserves blank lines preceding text that appears within <b>TEXT</b>...<b>ENDTEXT</b>. Setting <span class="parameter">nValue</span> to 2 will separate current <b>TEXT</b>...<b>ENDTEXT</b> output from previous <b>TEXT</b>...<b>ENDTEXT</b> output with a line feed.</p>
                <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                  <p> Combining an nValue setting of 2 and PRETEXT of 4 will separate current TEXT…ENDTEXT output from previous TEXT…ENDTEXT output with a line feed while removing empty lines in the TEXT...ENDTEXT output.</p>
                </td></tr></table></div>
              </td>
            </tr></table></div>
          <p>
          </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">PRETEXT <span class="parameter">eExpression</span></span></dt><dd>
          <p>Specifies a character string to insert before each line of the text merge contents between <b>TEXT...ENDTEXT</b> or a numeric expression. </p>
          <p>The following table describes behaviors of the <b>PRETEXT</b> clause depending on the expression specified by <span class="parameter">eExpression</span>.   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">eExpression</span>
                  
                </th>
                <th>
                  PRETEXT behavior
                </th>
              </tr><tr>
              <td>
                <p>Character expression</p>
              </td>
              <td>
                <p>Insert the expression before each line of the text merge contents appearing between the <b>TEXT...ENDTEXT</b> statement. When using <b>PRETEXT</b> with <b>TEXT...ENDTEXT</b>, <span class="parameter">eExpression</span> is limited to a maximum length of 255 characters.</p>
                <p>
                  <span class="parameter">eExpression</span> overrides the contents of the <b>_PRETEXT</b> system variable. When <span class="parameter">eExpression</span> contains an expression that needs to be evaluated, for example, a user-defined function (UDF), Visual FoxPro evaluates it only once when the <b>TEXT</b> command first appears.</p>
              </td>
            </tr><tr>
              <td>
                <p>Numeric expression</p>
              </td>
              <td>
                <p>Specify additive flag values to determine behavior for the text merge contents appearing between the <b>TEXT...ENDTEXT</b> statement. </p>
                <p>For example, a value of 7 specifies that Visual FoxPro eliminate all white space including spaces, tabs, and carriage returns. A value falling outside of the range of 0-15 produces an error.</p>
                <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                  <p>Specifying a value of zero does not eliminate white space.</p>
                </td></tr></table></div>
                <p>When <span class="parameter">eExpression</span> is a numeric expression, you can use the <b>_PRETEXT</b> system variable to insert additional text after Visual FoxPro eliminates white space.</p>
              </td>
            </tr></table></div>
          <p>The following table lists numeric additive flags that you can use in <span class="parameter">eExpression</span> to specify additional behavior.   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  Value (Additive)
                </th>
                <th>
                  Description
                </th>
              </tr><tr>
              <td>
                <p>1</p>
              </td>
              <td>
                <p>Eliminate spaces before each line.</p>
              </td>
            </tr><tr>
              <td>
                <p>2</p>
              </td>
              <td>
                <p>Eliminate tabs before each line.</p>
              </td>
            </tr><tr>
              <td>
                <p>4</p>
              </td>
              <td>
                <p>Eliminate carriage returns, for example, blank lines, before each line.</p>
              </td>
            </tr><tr>
              <td>
                <p>8</p>
              </td>
              <td>
                <p>Eliminate line feeds.</p>
              </td>
            </tr></table></div>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>Unlike the <b>_PRETEXT</b> system variable, the <b>PRETEXT</b> clause does not have global scope and applies only to the <b>TEXT...ENDTEXT</b> statement in which it appears. </p>
          </td></tr></table></div>
          <p>Characters removed using the <b>PRETEXT</b> clause apply only to text within the <b>TEXT...ENDTEXT</b> statement and not to evaluated text merged from <span class="parameter">cExpression</span>. In the following example, the spaces in the memory variable, <code>myvar</code>, are not removed when merged with the text in <b>TEXT...ENDTEXT</b>:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>myvar = "   AAA"
TEXT TO x NOSHOW ADDITIVE TEXTMERGE PRETEXT 7
Start Line
&lt;&lt;myvar&gt;&gt;
      BBB
   CCC
ENDTEXT</pre></td></tr></table></span></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>By default, <b>TEXT ... ENDTEXT</b> sends output to the main Visual FoxPro window or the active window. To suppress output to the main Visual FoxPro window or the active window, issue <b>SET CONSOLE OFF</b>. To send output to a printer or a text file, use <b>SET PRINTER</b>. To send output from <b>TEXT ... ENDTEXT</b> to a low-level file that you created or opened using <b>FCREATE( )</b> or <b>FOPEN( )</b>, store the file handle returned by <b>FCREATE( )</b> or <b>FOPEN( )</b> to the <b>_TEXT</b> system variable, which you can use to direct output to the corresponding low-level file.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>The text merge process usually includes any white space that might appear before each line in a <b>TEXT...ENDTEXT</b> statement. However, the inclusion of white space might cause the text merge to fail, for example, when XML is used in a Web browser. You must remove such white space to avoid incorrectly formatted XML.</p>
      </td></tr></table></div>
      <p>Nesting TEXT...ENDTEXT statements is not recommended, especially if using the PRETEXT clause because the nested statements can affect the format of the outer statements.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">
          <b>Example 1</b>
        </p>
        <p xmlns="">The following example demonstrates creating a low-level file called <code>myNamesFile.txt</code> and storing its file handle in the <b>_TEXT</b> system variable. The program exits if the <code>myNamesFile.txt</code> file cannot be created. </p>
        <p xmlns="">Visual FoxPro opens the customer table and outputs the names of the first ten contacts to <code>myNamesFile.txt</code>. Visual FoxPro outputs the text and results of the functions to the text file. The example uses <b>MODIFY FILE</b> to open <code>myNamesFile.txt</code>.</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CLEAR
CLOSE DATABASES
SET TALK OFF
SET TEXTMERGE ON     
STORE FCREATE('myNamesFile.txt') TO _TEXT     
IF _TEXT = -1  
   WAIT WINDOW 'Cannot create an output file. Press a key to exit.'
   CANCEL
ENDIF
CLOSE DATABASES
OPEN DATABASE (HOME(2) + 'Data\testdata')
USE customer  
TEXT
         CONTACT NAMES
   &lt;&lt;DATE( )&gt;&gt;    &lt;&lt;TIME( )&gt;&gt;
ENDTEXT
WAIT WINDOW 'Press a key to generate the first ten names.'
SCAN NEXT 10
   TEXT
      &lt;&lt;contact&gt;&gt;
   ENDTEXT
ENDSCAN
CLOSE ALL  
MODIFY FILE myNamesFile.txt
ERASE myNamesFile.txt</pre></td></tr></table></span></div>
    <comments xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">
          <b>Example 2</b>
        </p>
        <p xmlns="">The following example shows a custom procedure that uses <b>TEXT...ENDTEXT</b> to store an XML DataSet to a variable. In the example, all spaces, tabs, and carriage returns are eliminated.</p>
        <div class="code" xmlns=""><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>PROCEDURE myProcedure
   DO CASE
   CASE nValue = 1
      TEXT TO myVar NOSHOW TEXT PRETEXT 7
         &lt;?xml version="1.0" encoding="utf-8"?&gt;
         &lt;DataSet xmlns="http://tempuri.org"&gt;
         &lt;&lt;ALLTRIM(STRCONV(leRetVal.item(0).xml,9))&gt;&gt;
         &lt;/DataSet&gt;
      ENDTEXT
   OTHERWISE
   ENDCASE
ENDPROC</pre></td></tr></table></span></div>
      
    </comments>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/f8c60315-bed3-48ef-919b-3b18a197f868.htm">FOPEN( ) Function</a></span><br /><span class="linkTerms"><a href="/html/45afea55-e808-4623-aa6e-0ed6648ec029.htm">_PRETEXT System Variable</a></span><br /><span class="linkTerms"><a href="/html/0c509f57-18ae-4580-a9a9-0032fc2f315c.htm">SET TEXTMERGE Command</a></span><br /><span class="linkTerms"><a href="/html/e16e6233-51a4-4f82-b979-f7ef9f95e967.htm">SET TEXTMERGE DELIMITERS Command</a></span><br /><span class="linkTerms"><a href="/html/231cebe2-8608-4a2d-83dd-4b9103b1b8c8.htm">_TEXT System Variable</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="TEXT ... ENDTEXT Command">
<param name="ALink Name" value="TEXT ... ENDTEXT">
</OBJECT>
