<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>CREATE TRIGGER Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">CREATE TRIGGER Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Creates a Delete, Insert, or Update trigger for a table.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
CREATE TRIGGER ON <span class="parameter">TableName</span>   FOR DELETE | INSERT | 
UPDATE AS <span class="parameter">lExpression</span></pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">TableName</span>
        </span></dt><dd>
          <p>Specifies the table in the current database for which a trigger is created.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">FOR DELETE | INSERT | UPDATE </span></dt><dd>
          <p>Specifies the type of trigger Visual FoxPro creates.</p>
          <p>If a trigger of the type you specify already exists and SET SAFETY is ON, Visual FoxPro asks you if you would like to overwrite the existing trigger. If SET SAFETY is OFF, the existing trigger is automatically overwritten. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">AS <span class="parameter">lExpression</span></span></dt><dd>
          <p>Specifies the logical expression evaluated when the trigger occurs. <span class="parameter">lExpression</span> can be a user-defined function or a stored procedure that returns a logical value. Stored procedures are created for a table with MODIFY PROCEDURE.</p>
          <p>A user-defined function or a stored procedure can use AERROR( ) to determine the name of the table for which the trigger occurred and the trigger type.   </p>
          <p>If <span class="parameter">lExpression</span> evaluates to true (.T.), the command or event that caused the trigger to occur is executed.   </p>
          <p>If <span class="parameter">lExpression</span> evaluates to false (.F.), the command or event that caused the trigger to occur is not executed. If an ON ERROR procedure is in effect, the ON ERROR procedure is executed instead of the command or event. If an ON ERROR procedure is not in effect, the command or event is not executed and Visual FoxPro generates an error message. </p>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Use CREATE TRIGGER to trap for events that cause records in a table to be deleted, added, or changed. Delete, Insert, or Update triggers can be created only for a table that has been added to a database. Use CREATE DATABASE to create a database, and ADD TABLE to add a table to a database.</p>
      <p>The following table describes the events that cause a Delete, Insert, or Update trigger to occur.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Event
            </th>
            <th>
              Result
            </th>
          </tr><tr>
          <td>
            <p>Delete Trigger</p>
          </td>
          <td>
            <ul><li>
                <p>DELETE is issued.</p>
              </li><li>
                <p>A record is marked for deletion from the Table Menu in a Browse window or Edit window.</p>
              </li><li>
                <p>Note that issuing ZAP does not cause the Delete trigger to occur.</p>
              </li></ul>
          </td>
        </tr><tr>
          <td>
            <p>Insert Trigger</p>
          </td>
          <td>
            <ul><li>
                <p>APPEND FROM is issued.</p>
              </li><li>
                <p>APPEND FROM ARRAY is issued.</p>
              </li><li>
                <p>APPEND BLANK is issued.</p>
              </li><li>
                <p>A record is appended from the Table Menu in a Browse window or Edit window.</p>
              </li><li>
                <p>IMPORT is issued.</p>
              </li><li>
                <p>INSERT – SQL is issued.</p>
              </li><li>
                <p>RECALL is issued.</p>
              </li><li>
                <p>A record is recalled from the Table Menu in a Browse window or Edit window.</p>
              </li></ul>
          </td>
        </tr><tr>
          <td>
            <p>Update Trigger</p>
          </td>
          <td>
            <ul><li>
                <p>GATHER is issued. </p>
                <p>The following rules apply to triggers created with CREATE TRIGGER:  </p>
                <ul><li>
                    <p>INSERT cannot be issued for a table with a trigger. However, INSERT – SQL can be used.</p>
                  </li><li>
                    <p>Issuing PACK does not cause any triggers to occur.</p>
                  </li><li>
                    <p>Issuing ZAP does not cause a Delete trigger to occur.</p>
                  </li><li>
                    <p>No trigger occurs if you update a record marked for deletion.</p>
                  </li><li>
                    <p>A trigger may not occur immediately, depending on the current buffering mode:</p>
                  </li></ul>
              </li><li>
                <p>REPLACE is issued.</p>
              </li><li>
                <p>REPLACE FROM ARRAY is issued.</p>
              </li><li>
                <p>UPDATE – SQL is issued.</p>
              </li><li>
                <p>Other event that causes a record to be modified, such as when a Form changes the contents of a field.</p>
              </li></ul>
          </td>
        </tr></table></div>
      <p>If table buffering is in effect, the Update trigger occurs when TABLEUPDATE( ) is issued and each buffered record is updated in the table.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>When a trigger is called, the Alias is always that of the cursor being updated, regardless of the Alias selected in the code that caused the trigger to fire.</p>
      </td></tr></table></div>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">The following example creates an Update trigger which prevents values greater than 50 from being entered in the <code>maxordamt</code> field in the <code>customer</code> table. An error message is generated when the first REPLACE command is executed because the value for the <code>maxordamt</code> field is greater than 50. The second REPLACE command does not generate an error because the value for the <code>maxordamt</code> field is less than or equal to 50.</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CLOSE DATABASES
OPEN DATABASE (HOME(2) + 'data\testdata')
USE customer  &amp;&amp; Open customer table
* Set trigger on maxordamt field to fail with values &lt;= 50
CREATE TRIGGER ON customer FOR UPDATE AS maxordamt &lt;= 50
ON ERROR  &amp;&amp; Restore the system error handler
WAIT WINDOW "Press a key to test trigger with value of 60"+CHR(13);
 +"When you get the error message, press Ignore."
REPLACE maxordamt WITH 60    &amp;&amp; Displays an error message
? maxordamt
WAIT WINDOW "Press a key to test with value of 50."
REPLACE maxordamt WITH 50    &amp;&amp; Value is accepted
? maxordamt
DELETE TRIGGER ON customer FOR UPDATE  &amp;&amp; Remove the trigger</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/00312970-64d1-4f0f-a539-9687382bdcd9.htm">ADD TABLE Command</a></span><br /><span class="linkTerms"><a href="/html/cf8d9a30-f8dc-4181-bebd-1181c3554308.htm">AERROR( ) Function</a></span><br /><span class="linkTerms"><a href="/html/64ff85c1-0480-419d-97f5-b6d1195d1a3e.htm">CREATE DATABASE Command</a></span><br /><span class="linkTerms"><a href="/html/c2c5dec2-f99c-4fb7-a7b0-66146e67efc2.htm">DELETE TRIGGER Command</a></span><br /><span class="linkTerms"><a href="/html/d78424c2-8d6a-4c63-b505-5bd74ee0a4c0.htm">DISPLAY DATABASE Command</a></span><br /><span class="linkTerms"><a href="/html/480d0ed1-6798-41e1-a26f-ec23549d4f79.htm">LIST DATABASE Command</a></span><br /><span class="linkTerms"><a href="/html/167e24f6-0e6f-4cc1-a1a9-dffc9491d85a.htm">OPEN DATABASE Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="CREATE TRIGGER Command">
<param name="ALink Name" value="CREATE TRIGGER">
</OBJECT>
