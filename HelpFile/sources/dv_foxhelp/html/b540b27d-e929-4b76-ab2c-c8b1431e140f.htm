<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>AdjustObjectSize Event</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">AdjustObjectSize Event</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Occurs just before ReportListener begins rendering layout elements of type Shape or Picture.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
PROCEDURE <span class="parameter">Object</span>.AdjustObjectSize
LPARAMETERS nFRXRecno, oObjProperties</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <p>Visual FoxPro passes the AdjustObjectSize event parameters in the following order:  </p>
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">nFRXRecno</span>
        </span></dt><dd>
          <p>Integer data type, specifying the record number in the report or label definition file (frx or lbx) describing the layout element being rendered.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">oObjProperties</span>
        </span></dt><dd>
          <p>An object of Empty class, with members providing values relevant to adjusting the size of a Shape or Picture.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>oObjProperties member</b>
                  
                </th>
                <th>
                  
                    <b>Type</b>
                  
                </th>
                <th>
                  
                    <b>Usage</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>
                  <span class="parameter">reload</span>
                </p>
              </td>
              <td>
                <p>Logical, defaults to .F.</p>
              </td>
              <td>
                <p>Flag to alert the ReportListener if you make changes. </p>
                <p>Set this value to True (<code>.T.</code>) to notify the ReportListener of changes to <span class="parameter">height</span> or <span class="parameter">width</span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">height</span>
                </p>
              </td>
              <td>
                <p>Integer, valid values from 0 to 64000</p>
              </td>
              <td>
                <p>Height of layout element, in 960ths of an inch.</p>
                <p>If you change this value and set <span class="parameter">reload</span> to <code>.T.</code>, the ReportListener renders with the revised value.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">width</span>
                </p>
              </td>
              <td>
                <p>Integer, valid values from 0 to 64000</p>
              </td>
              <td>
                <p>Width of layout element, in 960ths of an inch. </p>
                <p>If you change this value and set <span class="parameter">reload</span> to <code>.T.</code>, the ReportListener renders with the revised value.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">top,left</span>
                </p>
              </td>
              <td>
                <p>Integer, readonly</p>
              </td>
              <td>
                <p>Coordinates of top- and left-most point of the Shape or Picture element.  Provides information about the position of the layout element on the output page, for reference in calculations.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">reattempt</span>
                </p>
              </td>
              <td>
                <p>Logical, readonly</p>
              </td>
              <td>
                <p>Indicates whether this element has been pushed to a second page because it did not fit on the previous page.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">maxheightavailable</span>
                </p>
              </td>
              <td>
                <p>Integer, readonly</p>
              </td>
              <td>
                <p>Indicates the available room on this page for this element, allowing for the height of subsequent bands (such as the page footer) for which space must be reserved.</p>
              </td>
            </tr></table></div>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>Microsoft reserves the right to invoke AdjustObjectSize for additional report and label layout elements, as needed, and to add to the <span class="parameter">oObjProperties</span> members appropriately for these additional layout element types.  You can use <span class="parameter">nFRXRecno</span> to test for layout element type, as shown in the sample code in <span class="linkTerms"><a href="/html/d84ca220-1017-4d03-92d0-907fb6f61f21.htm">Render Method</a></span>. </p>
          </td></tr></table></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Applies To: <span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span>.</p>
      <p>VisualFoxPro invokes AdjustObjectSize once for each layout element of type Shape or Picture, unless it finds no code in the derived ReportListener class at run time.  It also does not call AdjustObjectSize if the element is in a band not marked Stretchable (fixed band height).  For more information, see <span class="linkTerms"><a href="/html/bf4c21c6-bfdf-43cb-a0f0-ae7ac710a9a5.htm">Report Band Properties Dialog Box</a></span>.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>To enhance performance, Visual FoxPro does not call either AdjustObjectSize or EvaluateContents if it determines that there is no code in the ReportListener for the event.  If you usually include placeholder code or generalized code in every event, consider omitting such code for these two events, especially if the class level is <i>abstract</i> (never directly instantiated).  Only include code at the class levels that actually use this functionality.  The performance cost for AdjustObjectSize increases by approximately the same amount for each Shape or Picture element in a report; the performance cost for EvaluateContents varies.  For more information, see <span class="linkTerms"><a href="/html/89a8e39e-b39f-483d-bcda-74dffe42667c.htm">EvaluateContents Event</a></span>.</p>
      </td></tr></table></div>
      <p>This feature is primarily for the use of ReportListeners interpreting certain Shapes as placeholders for custom objects, which they draw in the space reserved for the Shape in the layout. </p>
      <p>AdjustObjectSize is not supported for Shapes or Pictures that stretch between any header and footer pair of bands, and does not support changes to shape curvature.</p>
      <p>Although the <span class="parameter">oObjProperties</span> parameter has several members, the only value that will affect the ReportListener’s rendering behavior is a change to <span class="parameter">oObjProperties.height</span>.  Change to <span class="parameter">oObjProperties.height</span> is respected only if the new height is greater than the original height. This change will cause a change to the element’s height as rendered by the ReportListener and also cause other floating layout elements to be pushed down, and the band to stretch to accommodate the new height.</p>
      <p>Because it is not supported for Shapes or Pictures that span bands, you cannot adjust the height of a Shape to continue through multiple pages.  If the element does not fit on the page after the ReportListener has changed its height, the entire element will be pushed down to the next page.  In some cases, because not all bands can span pages, this determination may result in the entire band being pushed to the next page.  Refer to <span class="linkTerms"><a href="/html/49265836-568c-4121-9aa1-789162d15091.htm">Report Bands</a></span> for more information on which bands can span pages.</p>
      <p>Use the <span class="parameter">oObjProperties.maxheightavailable</span> member to determine the maximum size you can give the Shape or Picture without its being pushed entirely to the next page.  </p>
      <p>When you set a higher value than <span class="parameter">oObjProperties.maxheightavailable</span> for <span class="parameter">oObjProperties.height</span> and set oObjProperties.reload to True (<code>.T.</code>), the ReportListener's Render event is not called for this element on the current page.  Instead, AdjustObjectPage is called again for the same element on the next page.  </p>
      <p>On the next page, <span class="parameter">oObjProperties.height</span> is set back to its original value, <span class="parameter">oObjProperties.reattempt</span> is set to True (<code>.T.</code>), and <span class="parameter">oObjProperties.maxheightavailable</span> has a new value, based on the new value of <span class="parameter">oObjProperties.top</span> on this page.  At this point, you can re-evaluate the height you want for the element on the new page. </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Caution note" src="../local/Caution.gif"></img>Caution </th></tr><tr><td>
        <p>If you have set a height value too large for any page, the element will not display. No immediate error occurs, but continued assignments of such a value will cause the element to be re-pushed to subsequent pages repeatedly.  Use <span class="parameter">oObjProperties.reattempt</span> to avoid trying to reload the same value repeatedly, after your initial attempt.  </p>
      </td></tr></table></div>
      <p>Changes to the <span class="parameter">oObjProperties.width</span> value do not affect the ReportListener’s base rendering behavior; however, they will be passed to your derived class for use in Render if <span class="parameter">oObjProperties.reload</span> is True (<code>.T.</code>).</p>
      <p>Both <span class="parameter">oObjProperties.height</span> and <span class="parameter">oObjProperties.width</span> have a valid range of 0 to 64000.  If either value is set out of range, it snaps to 0 or 64000 and no error occurs.</p>
      <p>
        <span class="parameter">oObjProperties.top</span> and <span class="parameter">oObjProperties.left</span> are read-only. They are passed for your derived class' reference, since there is no other way for the ReportListener to determine where in the page layout this instance of the element will be rendered.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">This example adjusts the height of a layout element in a report to display a differently-sized image for each record in a table.  The  filename for the image is stored in one column of the table and the desired image height (in inches) is stored in a second column of the table.   The images referenced in each record may be a different height, and some records have no image file included. In the report layout, the image element is set to be only a few pixels high, an expression representing the table column holding the image filename is associated with this layout element. Elements in the same band below this region are set to float and stretch.  </p>
        <p xmlns="">In the BeforeReport code, the ReportListener determines which record in the FRX layout definition describes the image, and saves this information for later use.  When the AdjustObjectSize event occurs, the ReportListener checks its nFRXRecno argument to see if FRX element being evaluated matches its stored record number for the image element.  If it does, the ReportListener adjusts the height of the image element to match whatever image is associated with this record.</p>
        <div class="alert" xmlns=""><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
          <p>Notice that the AdjustObjectSize code multiples the height value stored in the table by 960.  The table stores its measurements in inches, and the ReportListener's rendering code handles measurements in 960 dots per inch (DPI).</p>
        </td></tr></table></div>
        <p xmlns=""> </p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE CLASS rl AS ReportListener
   FrxPic = 0
    
  PROCEDURE BeforeReport()
     SET DATASESSION TO (THIS.FRXDataSession)
     SELECT FRX
     LOCATE FOR ObjType = 17 &amp;&amp; image
     IF EOF()
        THIS.FrxPic = 0
     ELSE
        THIS.FrxPic = RECNO()
     ENDIF
   ENDPROC
   PROCEDURE AdjustObjectSize(nFrxRecno,oProps)
       IF nFrxRecno = THIS.FrxPic 
          SET DATASESSION TO (THIS.CurrentDataSession)
          IF (NOT EMPTY(MyTable.picFile))
             * express in DPI units:
             oProps.Height = MyTable.picInches * 960
             oProps.Reload = .T.
          ENDIF
       ENDIF
   ENDPROC
   
ENDDEFINE</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/cdef88be-f099-4df5-8839-d6f67681ad2a.htm">How to: Add Shapes to Reports</a></span><br /><span class="linkTerms"><a href="/html/73639c67-232f-4a9d-ada7-16c7fcffa7b4.htm">How to: Add Pictures to Reports</a></span><br /><span class="linkTerms"><a href="/html/ed978ad1-da0e-4c5b-bdd4-4b029d0bef3b.htm">How to: Set Stretching Report Controls</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span><br /><span class="linkTerms"><a href="/html/3c373386-539d-44f1-894c-37b5724cc961.htm">Round Rectangle Dialog Box</a></span><br /><span class="linkTerms"><a href="/html/7bdcc90d-bc58-4b62-b4a5-244e1f0ec1e5.htm">Rectangle/Line Dialog Box</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/45aa16ed-5a77-45e0-a382-dcb7be6f10d7.htm">Events (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="AdjustObjectSize Event">
<param name="ALink Name" value="AdjustObjectSize">
<param name="Alink Name" value="vfp.50000907">
</OBJECT>
