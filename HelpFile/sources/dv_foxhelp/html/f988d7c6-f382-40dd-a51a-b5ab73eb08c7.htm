<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>Language Enhancements</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Language Enhancements</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>In the current release of Visual FoxPro, you will find enhanced functionality via new and enhanced commands and functions. Expand and collapse this topic to see information about miscellaneous language additions and improvements.</p>
  <a name="foorilanguageenhancementsanchor18"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0)" tabindex="0"><img id="sectionToggle0" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Class Enhancements</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro contains significant language enhancements for classes, forms, controls, and object-oriented related features. For more information, see <span class="linkTerms"><a href="/html/ec67c781-ea65-402c-9b5f-91697f2a0746.htm">Class Enhancements</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor19"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1)" tabindex="0"><img id="sectionToggle1" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Data and XML Enhancements</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro contains significant language enhancements for Data, SQL and XML features. For more information, see <span class="linkTerms"><a href="/html/6c75fbec-8d4a-4809-a521-c54802e59ea5.htm">SQL Language Improvements</a></span> and <span class="linkTerms"><a href="/html/f8ce8cf6-5def-40d0-9dcb-65570d47ce92.htm">Data and XML Feature Enhancements</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor15"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle2)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle2)" tabindex="0"><img id="sectionToggle2" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>IDE Enhancements</span></h1><div id="sectionSection2" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro contains a number of language enhancements for features related to the IDE (Interactive Development Environment). For more information, see <span class="linkTerms"><a href="/html/eca7fa6d-ec9c-411a-b3ea-6f5d71991a70.htm">Interactive Development Environment (IDE) Enhancements</a></span> and <span class="linkTerms"><a href="/html/3d8b88b7-28b8-4d71-a4a1-4da3f1a6dd70.htm">Enhancements to Visual FoxPro Designers</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor20"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle3)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle3)" tabindex="0"><img id="sectionToggle3" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Printing and Reporting Enhancements</span></h1><div id="sectionSection3" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro contains a number of language enhancements to support new Reporting functionality:</p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/fdcc3a57-94e0-40f8-aea1-47931c4b8449.htm">REPORT FORM Command</a></span>
          </p>
          <p>Displays or prints out a report specified by a report definitions file. This command has been enhanced to support Report Listener objects.</p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/5d6e4527-8b6f-4f39-a670-c3397eff3bfd.htm">SET REPORTBEHAVIOR Command</a></span>
          </p>
          <p>Controls use of Report Preview and Report Output applications with the Visual FoxPro Report System.</p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/d55ca0b9-d0c6-477e-b489-234a0d4906ba.htm">SYS(2024) - Detect Report Cancellation</a></span>
          </p>
          <p>Determines if user canceled out of a running report.</p>
        </li></ul>
      <p>Additionally, there are improvements to the following related Printing language elements:</p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/291ca481-a1bf-4a78-ac59-da3dfaba4037.htm">SYS(1037) - Page Setup Dialog Box</a></span>
          </p>
          <p>Displays Visual FoxPro default or report <b>Page Setup</b> dialog box or sets printer settings for the default printer in Visual FoxPro or for the report printer environment. In this version, a new <span class="parameter">nValue</span> parameter is available.</p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/95287c74-24b9-460b-bfec-4c78f5358417.htm">APRINTERS( ) Function</a></span>
          </p>
          <p>Returns a five-column array with the name of the printer, connected port, driver, comment, and location. The last three columns are available if the new optional parameter is passed.</p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/53a11bb9-6a3b-4539-a343-ffd75ae45dbe.htm">GETFONT( ) Function</a></span>
          </p>
          <p>Contains an additional setting to display only those fonts available on the current default printer and clarified values for the language script.</p>
        </li></ul>
      <p>New Reporting functionality is described in more detail in separate Reporting topics. For more information, see <span class="linkTerms"><a href="/html/46e99caf-fe50-4d55-aa78-e37cffeca2d1.htm">Guide to Reporting Improvements</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor16"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle4)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle4)" tabindex="0"><img id="sectionToggle4" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Specifying Arrays with More Than 65K Elements</span></h1><div id="sectionSection4" class="section" name="collapseableSection" style="display: none;">
      <p>You can now specify arrays containing more than 65,000 elements, for example, when using the <b>DIMENSION</b> command. Normal arrays and member arrays have a new limit of 2GB. Arrays containing member objects retain a limit of 65,000 elements.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>Array sizes can also be limited by available memory, which affects performance, especially for very large arrays. Make sure your computer has enough memory to accommodate the upper limits of your arrays. </p>
      </td></tr></table></div>
      <p>The Library Construction Kit, which contains the files Pro_Ext.h, WinAPIMS.lib, and OcxAPI.lib, still has a limit of 65,000 elements. For more information about these files, see <span class="linkTerms"><a href="/html/566a1828-db5f-432f-8940-c4dd53c08920.htm">Accessing the Visual FoxPro API</a></span>, <span class="linkTerms"><a href="/html/9f65d44f-5cd5-407e-bd20-c6a8ca584db9.htm">How to: Add Visual FoxPro API Calls</a></span>, and <span class="linkTerms"><a href="/html/a185d080-15c9-4187-a534-c105108dbd15.htm">How to: Build and Debug Libraries and ActiveX Controls</a></span>. The <b>SAVE TO</b> command does not support saving arrays larger than 65,000 elements.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/6e27027b-806b-4f96-b7e5-5f24af2901e0.htm">Visual FoxPro System Capacities</a></span> and <span class="linkTerms"><a href="/html/17270153-1977-40bc-9f17-ab0132b20e90.htm">DIMENSION Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor21"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle5)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle5)" tabindex="0"><img id="sectionToggle5" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>STACKSIZE Setting Increases Nesting Levels to 64k</span></h1><div id="sectionSection5" class="section" name="collapseableSection" style="display: none;">
      <p>For operations such as the <b>DO</b> command, you can change the default number of nesting levels from 128 levels to 32 and up to 64,000 levels of nesting by including the new <b>STACKSIZE</b> setting in a Visual FoxPro configuration file.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>You can change the nesting level only during Visual FoxPro startup. </p>
      </td></tr></table></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/7d2c52b2-b8cc-421b-bfb8-28c9ba8e2ec1.htm">Special Terms for Configuration Files</a></span> and <span class="linkTerms"><a href="/html/6e27027b-806b-4f96-b7e5-5f24af2901e0.htm">Visual FoxPro System Capacities</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor14"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle6)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle6)" tabindex="0"><img id="sectionToggle6" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Program and Procedure File Size Is Unrestricted</span></h1><div id="sectionSection6" class="section" name="collapseableSection" style="display: none;">
      <p>In previous versions of Visual FoxPro, the size of a procedure or program could not exceed 65K. Visual FoxPro now removes this restriction for programs and procedures. For more information, see <span class="linkTerms"><a href="/html/6e27027b-806b-4f96-b7e5-5f24af2901e0.htm">Visual FoxPro System Capacities</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor10"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle7)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle7)" tabindex="0"><img id="sectionToggle7" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>PROGCACHE Configuration File Setting</span></h1><div id="sectionSection7" class="section" name="collapseableSection" style="display: none;">
      <p>In previous versions of Visual FoxPro, you could not specify the program cache size or amount of memory reserved to run programs. This configuration file setting allows you to control this. It is especially useful for MTDLL scenarios. For more information, see <span class="linkTerms"><a href="/html/7d2c52b2-b8cc-421b-bfb8-28c9ba8e2ec1.htm">Special Terms for Configuration Files</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor22"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle8)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle8)" tabindex="0"><img id="sectionToggle8" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>ICASE( ) Function</span></h1><div id="sectionSection8" class="section" name="collapseableSection" style="display: none;">
      <p>The new <b>ICASE( )</b> function makes it possible for you to evaluate a list of conditions and return results depending on the result of evaluating those conditions. For more information, see <span class="linkTerms"><a href="/html/bca0f8fe-644c-460e-aef6-d4d4a38af727.htm">ICASE( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor23"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle9)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle9)" tabindex="0"><img id="sectionToggle9" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>TTOC( ) Converts DateTime Expressions to XML DateTime Format</span></h1><div id="sectionSection9" class="section" name="collapseableSection" style="display: none;">
      <p>You can convert a <span class="parameter">DateTime</span> expression into a character string in XML DateTime format by passing a new optional value of 3 to the <b>TTOC( )</b> function. For more information, see <span class="linkTerms"><a href="/html/2854910f-6bc3-40a8-a32d-ad799b045205.htm">TTOC( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor24"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle10)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle10)" tabindex="0"><img id="sectionToggle10" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET COVERAGE Command Available at Run Time</span></h1><div id="sectionSection10" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>SET COVERAGE</b> command is now available at run time so that you can debug errors that occur at run time but not at design time. For more information, see <span class="linkTerms"><a href="/html/69db76fd-c964-46b4-b848-c81c02b0f08a.htm">SET COVERAGE Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor28"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle11)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle11)" tabindex="0"><img id="sectionToggle11" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>CLEAR ERROR Command</span></h1><div id="sectionSection11" class="section" name="collapseableSection" style="display: none;">
      <p>The new <b>ERROR</b> clause for the <b>CLEAR</b> command makes it possible to reset the error structures as if no error occurred. This affects the following functions:  </p>
      <ul><li>
          <p>The <b>AERROR( )</b> function will return 0.</p>
        </li><li>
          <p>The <b>ERROR( )</b> function will return 0.</p>
        </li><li>
          <p>The output from <b>MESSAGE( )</b>, <b>MESSAGE(1)</b> and <b>SYS(2018)</b> will return a blank string.</p>
        </li></ul>
      <p>The <b>CLEAR</b> command should not be used with the <b>ERROR</b> clause within a <b>TRY...CATCH...FINALLY</b> structure. For more information, see <span class="linkTerms"><a href="/html/b89737d7-7dac-455e-9088-fa0ec6c93b98.htm">CLEAR Commands</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor31"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle12)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle12)" tabindex="0"><img id="sectionToggle12" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Write Options Dialog Settings to Registry Using SYS(3056)</span></h1><div id="sectionSection12" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>SYS(3056)</b> function can now be used to write out settings from the <b>Options</b> dialog box to the registry.</p>
      <p>
        <code>SYS(3056 [, nValue ])</code>
      </p>
      <p>The following table lists values for <span class="parameter">nValue</span>.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>nValue</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>1</p>
          </td>
          <td>
            <p>Update only from registry settings, with the exception of SET commands and file locations.</p>
          </td>
        </tr><tr>
          <td>
            <p>2</p>
          </td>
          <td>
            <p>Write out settings to the registry.</p>
          </td>
        </tr></table></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/2aa93cc3-123d-4e16-8175-760d3a7630b7.htm">SYS(3056) - Read Registry Settings</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor34"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle13)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle13)" tabindex="0"><img id="sectionToggle13" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>FOR EACH ... ENDFOR Command Preserves Object Types</span></h1><div id="sectionSection13" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro now includes the <b>FOXOBJECT</b> keyword for the <b>FOR EACH ... ENDFOR</b> command to support preservation of native Visual FoxPro object types.</p>
      <p>
        <code>FOR EACH objectVar [AS Type [OF ClassLibrary ]] IN Group FOXOBJECT</code>
      </p>
      <p>
        <code>   Commands</code>
      </p>
      <p>
        <code>   [EXIT]</code>
      </p>
      <p>
        <code>   [LOOP]</code>
      </p>
      <p>
        <code>ENDFOR | NEXT [Var]</code>
      </p>
      <p>The <b>FOXOBJECT</b> keyword specifies that the <span class="parameter">objectVar</span> parameter created will be a Visual FoxPro object. The <b>FOXOBJECT</b> keyword only applies to collections where the collection is based on a native Visual FoxPro <b>Collection</b> class. Collections that are COM-based will not support the <b>FOXOBJECT</b> keyword.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/b21ba88f-aeda-48e0-a3c5-de9984020281.htm">FOR EACH ... ENDFOR Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor36"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle14)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle14)" tabindex="0"><img id="sectionToggle14" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET PATH Command Enhancements</span></h1><div id="sectionSection14" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>SET PATH</b> command now supports the <b>ADDITIVE</b> keyword. The <b>ADDITIVE</b> keyword appends the specified path to the end of the current <b>SET PATH</b> list. If the path already exists in the <b>SET PATH</b> list, Visual FoxPro does not add it or change the order of the list. Paths specified with the <b>ADDITIVE</b> keyword must be strings in quotes or valid expressions.</p>
      <p>In addition, the length of the <b>SET PATH</b> list has been increased to 4095 characters.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/047f2e74-3552-43b7-a18d-ee2c7dd2db6e.htm">SET PATH Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor40"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle15)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle15)" tabindex="0"><img id="sectionToggle15" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Trim Functions Control Which Characters Are Trimmed</span></h1><div id="sectionSection15" class="section" name="collapseableSection" style="display: none;">
      <p>It is now possible to specify which characters are trimmed from an expression when using the <b>TRIM( )</b>, <b>LTRIM( )</b>, <b>RTRIM( )</b>, and <b>ALLTRIM( )</b> functions.</p>
      <p>
        <code>TRIM(cExpression[, nFlags] [, cParseChar [, cParseChar2 [, ...]]])</code>
      </p>
      <p>
        <code>LTRIM(cExpression[, nFlags] [, cParseChar [, cParseChar2 [, ...]]])</code>
      </p>
      <p>
        <code>RTRIM(cExpression[, nFlags] [, cParseChar [, cParseChar2 [, ...]]])</code>
      </p>
      <p>
        <code>ALLTRIM(cExpression[, nFlags] [, cParseChar [, cParseChar2 [, ...]]])</code>
      </p>
      <p>You can specify that the trim is case-insensitive using the nFlag value of 0 bit and 1.</p>
      <p>The <span class="parameter">cParseChar</span> parameter specifies one or more character strings to be trimmed from <span class="parameter">cExpression</span>. A maximum of 23 strings can be specified in <span class="parameter">cParseChar</span>.</p>
      <p>By default, if <span class="parameter">cParseChar</span> is not specified, then leading and trailing spaces are trimmed from character strings or 0 bytes are removed for <b>Varbinary</b> data types.</p>
      <p>The <span class="parameter">cParseChar</span> parameters are applied in the order they are entered. When a match is found, <span class="parameter">cExpression</span> is truncated and the process repeats from the first <span class="parameter">cParseChar</span> parameter.</p>
      <p>For more information, see the <span class="linkTerms"><a href="/html/c6552ab0-6cbf-4843-a745-fdaafeced24c.htm">TRIM( ) Function</a></span>, <span class="linkTerms"><a href="/html/6f2653be-ab4a-4f23-8d54-97fd733aca09.htm">LTRIM( ) Function</a></span>, <span class="linkTerms"><a href="/html/b457b31b-dd86-4436-bd09-ddfae22c13db.htm">RTRIM( ) Function</a></span>, and <span class="linkTerms"><a href="/html/767f9fa5-5271-4fe2-baf8-332cf8d15fb5.htm">ALLTRIM( ) Function</a></span> topics.</p>
    </div><a name="foorilanguageenhancementsanchor50"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle16)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle16)" tabindex="0"><img id="sectionToggle16" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>ALINES( ) Offers More Flexible Parsing Options</span></h1><div id="sectionSection16" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>ALINES( )</b> function has been enhanced to provide several additional options such as case-insensitive parsing and improved handling of empty array elements. These options are available using the new <span class="parameter">nFlags</span> parameter that replaces the older <span class="parameter">lTrim</span> 3rd parameter. For more information, see <span class="linkTerms"><a href="/html/9105b2f8-0648-4fad-8d59-a2dbd9859d8e.htm">ALINES( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor51"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle17)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle17)" tabindex="0"><img id="sectionToggle17" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Improvements in TEXT…ENDTEXT Statement</span></h1><div id="sectionSection17" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the TEXT…ENDTEXT command to eliminate line feeds using the new <span class="parameter">PRETEXT</span> setting. A new <span class="parameter">FLAGS</span> parameter controls additional output settings. For more information, see <span class="linkTerms"><a href="/html/40efc4ac-180a-4072-b6fa-591a154a98f1.htm">TEXT ... ENDTEXT Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor52"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle18)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle18)" tabindex="0"><img id="sectionToggle18" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Include Delimiters in STREXTRACT( ) Results</span></h1><div id="sectionSection18" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>STREXTRACT( )</b> function has a new <span class="parameter">nFlags</span> setting that allows you to include the specified delimiters with the returned expression. For more information, see <span class="linkTerms"><a href="/html/c1f77249-8327-4abe-81c6-d89d6ff7f121.htm">STREXTRACT( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor53"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle19)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle19)" tabindex="0"><img id="sectionToggle19" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>STRCONV( ) Enhanced to Allow for Code Page and FontCharSet</span></h1><div id="sectionSection19" class="section" name="collapseableSection" style="display: none;">
      <p>For certain conversion settings, you can specify an optional Code Page or Fontcharset setting for use in the conversion. For more information, see <span class="linkTerms"><a href="/html/e2b743ac-dec7-43ae-82db-ba6fa1e2cbd9.htm">STRCONV( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor42"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle20)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle20)" tabindex="0"><img id="sectionToggle20" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>TYPE( ) Determines if an Expression is an Array</span></h1><div id="sectionSection20" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>TYPE( )</b> function accepts the parameter, <span class="parameter">1</span>, to evaluate an expression to determine if it is an array. </p>
      <p>
        <code>Type(cExpression, 1)</code>
      </p>
      <p>The following character values are returned if the <span class="parameter">1</span> parameter is specified.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Return Value</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>A</p>
          </td>
          <td>
            <p>
              <span class="parameter">cExpression</span> is an array.</p>
          </td>
        </tr><tr>
          <td>
            <p>U</p>
          </td>
          <td>
            <p>
              <span class="parameter">cExpression</span> is not an array.</p>
          </td>
        </tr><tr>
          <td>
            <p>C</p>
          </td>
          <td>
            <p>
              <span class="parameter">cExpression</span> is a collection.</p>
          </td>
        </tr></table></div>
      <p>
        <span class="parameter">cExpression</span> must be passed as a character string. </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/7e83da43-86c1-4b0d-a00d-ea412382331f.htm">TYPE( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor47"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle21)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle21)" tabindex="0"><img id="sectionToggle21" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>BINTOC( ) and CTOBIN( ) Have Additional Conversion Capabilities</span></h1><div id="sectionSection21" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>BINTOC( )</b> and <b>CTOBIN( )</b> functions have update or new parameters that provide you with more control over the output of these functions. Additionally, these enhancements offer some improvements for working with Win32 API routines. For more information, see <span class="linkTerms"><a href="/html/c3b28578-7b4f-487f-9192-fb619ff83ad6.htm">BINTOC( ) Function</a></span> and <span class="linkTerms"><a href="/html/b1758fd8-354c-452d-a5f9-ca81292eb71e.htm">CTOBIN( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor48"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle22)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle22)" tabindex="0"><img id="sectionToggle22" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>MROW( ) and MCOL( ) Can Detect the Position of the Mouse Pointer</span></h1><div id="sectionSection22" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>MROW( )</b> and <b>MCOL( )</b> functions now have a zero (0) parameter for detecting the position of the mouse pointer based on the currently active form instead of the form returned by the <b>WOUTPUT( )</b> function. Although they are typically reference the same form, if the <b>AllowOutput</b> property of the form is set to False (.F.), <b>WOUTPUT( )</b> does not return the current active form. The mismatch of references and can lead to unexpected results. By using the zero (0) parameter, you can avoid misplacing items, such as Shortcut menus, as the currently active form is always used.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/feb8a105-3235-4bf1-8e94-ff14e806dad7.htm">MROW( ) Function</a></span> and <span class="linkTerms"><a href="/html/106501e8-c30b-4ed3-ada7-fab25313ed0e.htm">MCOL( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor60"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle23)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle23)" tabindex="0"><img id="sectionToggle23" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>INPUTBOX( ) Returns A Cancel Operation</span></h1><div id="sectionSection23" class="section" name="collapseableSection" style="display: none;">
      <p>The INPUTBOX( ) function contains an additional parameter that allows you to determine if the user canceled out of the dialog. For more information, see <span class="linkTerms"><a href="/html/94f45e5d-f96f-4ef3-a967-d20043a27165.htm">INPUTBOX( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor61"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle24)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle24)" tabindex="0"><img id="sectionToggle24" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>AGETCLASS( ) Supported for Runtime Applications</span></h1><div id="sectionSection24" class="section" name="collapseableSection" style="display: none;">
      <p>The AGETCLASS( ) fiunction is now supported for runtime applications. For more information, see <span class="linkTerms"><a href="/html/9bf66c50-2714-4578-985c-54cf2a3e0431.htm">AGETCLASS( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor62"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle25)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle25)" tabindex="0"><img id="sectionToggle25" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SYS(2019) Extends Handling of Configuration Files</span></h1><div id="sectionSection25" class="section" name="collapseableSection" style="display: none;">
      <p>You can use SYS(2019) to obtain the name and location of both internal and external configuration files. For more information, see <span class="linkTerms"><a href="/html/60c1a9a7-3f99-486a-a131-590baf487aa2.htm">SYS(2019) - Configuration File Name and Location</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor63"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle26)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle26)" tabindex="0"><img id="sectionToggle26" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SYS(2910) Controls List Display Count</span></h1><div id="sectionSection26" class="section" name="collapseableSection" style="display: none;">
      <p>You can control the number of items that appear in a drop-down list such as the one used by <span class="linkTerms"><a href="/html/92f08a56-b040-4fc3-b40a-164dc4602527.htm">AutoComplete Property</a></span>. This is the setting that is available on the <span class="linkTerms"><a href="/html/24853717-8586-4747-97a7-3c5cee39fc1e.htm">View Tab, Options Dialog Box</a></span> of the <span class="linkTerms"><a href="/html/a8286b0c-6b2c-4b8d-8e16-7db8dbda2a1f.htm">Options Dialog Box (Visual FoxPro)</a></span>. </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/0bbd417e-6c90-4bd3-ba43-6ec3e56aa4ce.htm">SYS(2910) - List Display Count</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor64"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle27)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle27)" tabindex="0"><img id="sectionToggle27" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SYS(3008) Turns Off Hyperlink Tip</span></h1><div id="sectionSection27" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro will display a tip such as "CTRL+Click to follow the link" when you hover over a hyperlink in the editor. If you desire to not have this tip show, you can use SYS(3008) to turn it off. This function is also useful for international applications where you do not want to display the English text for this tip. For more information, see <span class="linkTerms"><a href="/html/efe61d47-ff56-497f-9201-6796b5baf491.htm">SYS(3008) - Hyperlink Tooltips</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor71"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle28)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle28)" tabindex="0"><img id="sectionToggle28" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SYS(3065) Internal Program Cache</span></h1><div id="sectionSection28" class="section" name="collapseableSection" style="display: none;">
      <p>You can obtain the internal program cache (PROGCACHE configuration file setting). For more information, see <span class="linkTerms"><a href="/html/edad20a8-e3a2-4372-9d14-443d18b16944.htm">SYS(3065) - Internal Program Cache</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor70"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle29)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle29)" tabindex="0"><img id="sectionToggle29" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SYS(3101) COM Code Page Translation</span></h1><div id="sectionSection29" class="section" name="collapseableSection" style="display: none;">
      <p>You can now specify a code page to use for character data translation involving COM interoperability. For more information, see <span class="linkTerms"><a href="/html/cba9d8f0-9f0b-4a3d-b1bf-554b5b5a8ecc.htm">SYS(3101) - COM Code Page Translation</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor65"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle30)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle30)" tabindex="0"><img id="sectionToggle30" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Bidirectional Support for Tooltips and Popups</span></h1><div id="sectionSection30" class="section" name="collapseableSection" style="display: none;">
      <p>For international applications that display text from right to left, you can use the following new enhancements to control text justification:</p>
      <ul><li>
          <p>SYS(3009) - right justifies text in ToolTips.</p>
        </li><li>
          <p>DEFINE POPUP…RTLJUSTIFY - right justifies items in a popup, such as a shortcut menu.</p>
        </li><li>
          <p>SET SYSMENU TO RTLJUSTIFY - right justifies an entire menu system.</p>
        </li></ul>
      <p>The SYS(3009) function is a global setting. For more information, see <span class="linkTerms"><a href="/html/915bf9b9-4359-44b8-8908-031e20b13265.htm">SYS(3009) - Bidirectional Text Justification for ToolTips</a></span>, <span class="linkTerms"><a href="/html/fc04167c-d5e1-4933-bbfb-95fd6115413a.htm">DEFINE POPUP Command</a></span> and <span class="linkTerms"><a href="/html/737fa94e-e1a7-4f98-a6bb-2a33e15ca729.htm">SET SYSMENU Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor66"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle31)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle31)" tabindex="0"><img id="sectionToggle31" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Enhanced Font Script Support</span></h1><div id="sectionSection31" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro 9.0 contains a number of enhancements that extend ability to specify a Font Language Script (or FontCharSet) along with existing Font settings:</p>
      <ul><li>
          <p>SYS(3007) - specifies a FontCharSet for ToolTips. This is a global setting.</p>
        </li><li>
          <p>FONT Clause - the following table lists commands that support an optional FONT clause that allows for specification of a FontCharSet in the following format:</p>
          <p>
            <b>FONT cFontName [, nFontSize [, nFontCharSet]]</b>
          </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>Command</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>DEFINE MENU</p>
              </td>
            </tr><tr>
              <td>
                <p>DEFINE POPUP</p>
              </td>
            </tr><tr>
              <td>
                <p>DEFINE BAR</p>
              </td>
            </tr><tr>
              <td>
                <p>DEFINE PAD</p>
              </td>
            </tr><tr>
              <td>
                <p>DEFINE WINDOW</p>
              </td>
            </tr><tr>
              <td>
                <p>MODIFY WINDOW</p>
              </td>
            </tr><tr>
              <td>
                <p>BROWSE/EDIT/CHANGE</p>
              </td>
            </tr><tr>
              <td>
                <p>?/??</p>
              </td>
            </tr></table></div>
        </li><li>
          <p>Browse - the <span class="linkTerms"><a href="/html/3fb8da1c-c326-4de8-a5f1-7d7ac29e8366.htm">Font Dialog Box</a></span> that you can invoke by selecting the <b>Font menu item</b> from the <b>Table menu</b> with a <span class="linkTerms"><a href="/html/25d92e4a-4a6b-4d9b-80a2-f00e2ae9f8f8.htm">Browse Window</a></span> active now allows for selection of a font language script. You can specify a global default font script from the <span class="linkTerms"><a href="/html/31021b21-a7aa-43fb-aa33-ff8e410e0671.htm">IDE Tab, Options Dialog Box</a></span> in the <span class="linkTerms"><a href="/html/a8286b0c-6b2c-4b8d-8e16-7db8dbda2a1f.htm">Options Dialog Box (Visual FoxPro)</a></span>. To do this, you must first check the <b>Use font script</b> checkbox.</p>
        </li><li>
          <p>Editors - the <span class="linkTerms"><a href="/html/3fb8da1c-c326-4de8-a5f1-7d7ac29e8366.htm">Font Dialog Box</a></span> that you can invoke with an editor window active by selecting the <b>Font menu item</b> from the <b>Format menu</b> or right-click shortcut menu <span class="linkTerms"><a href="/html/eb8fa5c3-e4af-42a6-a614-d24aa477e404.htm">Edit Properties Dialog Box</a></span> now allows for selection of a font language script. You can specify a global default font script from the <span class="linkTerms"><a href="/html/31021b21-a7aa-43fb-aa33-ff8e410e0671.htm">IDE Tab, Options Dialog Box</a></span> in the <span class="linkTerms"><a href="/html/a8286b0c-6b2c-4b8d-8e16-7db8dbda2a1f.htm">Options Dialog Box (Visual FoxPro)</a></span>. To do this, you must first check the <b>Use font script</b> checkbox.</p>
        </li></ul>
      <p>For more information, see <span class="linkTerms"><a href="/html/c2cbb401-0225-419c-85e4-be62c35e4bd6.htm">SYS(3007) - ToolTipText Property Font Language Script</a></span>, <span class="linkTerms"><a href="/html/31021b21-a7aa-43fb-aa33-ff8e410e0671.htm">IDE Tab, Options Dialog Box</a></span>, and <span class="linkTerms"><a href="/html/8ac09fef-2dc1-44be-86a1-5592d41c4a68.htm">FontCharSet Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor67"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle32)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle32)" tabindex="0"><img id="sectionToggle32" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>ToolTip Timeout Control</span></h1><div id="sectionSection32" class="section" name="collapseableSection" style="display: none;">
      <p>You can specify how long a ToolTip is displayed if the mouse pointer is left stationary. For more information, see <span class="linkTerms"><a href="/html/59928880-1ee3-45d6-8d01-34dda1f01ae9.htm">_TOOLTIPTIMEOUT System Variable</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor68"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle33)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle33)" tabindex="0"><img id="sectionToggle33" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Tablet PC Features</span></h1><div id="sectionSection33" class="section" name="collapseableSection" style="display: none;">
      <p>The following features are available to assist with applications designed to run on a Tablet PC computer.</p>
      <ul><li>
          <p>ISPEN( ) - determines if the last Visual FoxPro application mouse event on a Tablet PC was a pen tap.</p>
        </li><li>
          <p>_SCREEN.DisplayOrientation - this read-write property specifies the screen display orientation for a Tablet PC. The value returned is the current orientation.</p>
        </li><li>
          <p>_TOOLTIPTIMEOUT - specifies how long a ToolTip is displayed if the mouse pointer is left stationary.</p>
        </li></ul>
      <p>For more information, see <span class="linkTerms"><a href="/html/95e6044a-79c9-4a0c-a0f5-dc28807412bb.htm">ISPEN( ) Function</a></span>, <span class="linkTerms"><a href="/html/878d66d8-f603-4e46-8368-814ede036b2f.htm">DisplayOrientation Property</a></span>, and <span class="linkTerms"><a href="/html/59928880-1ee3-45d6-8d01-34dda1f01ae9.htm">_TOOLTIPTIMEOUT System Variable</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor69"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle34)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle34)" tabindex="0"><img id="sectionToggle34" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Windows Message Event Handling</span></h1><div id="sectionSection34" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro allows you to trap and handle window messages from the Microsoft® Windows® operating system using existing BINDEVENT functions. Some examples of common events you might wish to trap for include:</p>
      <ul><li>
          <p>A power broadcast message used to intercept standby or power-down activities.</p>
        </li><li>
          <p>Media insertion and removal events, such as the insertion of a CD into a drive.</p>
        </li><li>
          <p>The insertion and/or removal of a Plug and Play hard disk (e.g., USB Drive).</p>
        </li><li>
          <p>Interception of screen saver queries to stop the screen saver from activating.</p>
        </li><li>
          <p>Operating system level font changes and Windows XP Theme changes.</p>
        </li><li>
          <p>New network connections/shares added or removed from system.</p>
        </li><li>
          <p>Switching between applications.</p>
        </li></ul>
      <p>You can use the Visual FoxPro BINDEVENT functions to register (and unregister) event handlers used to intercept messages (i.e., Win32 API window messages that get processed by the Win32 WindowProc function). See MSDN for more details.</p>
      <p>The new BINDEVENT( ) syntax requires the hWnd (integer) of the window receiving the message you desire to intercept, and the specific message itself (integer). For example, power-management events such as standby and power-down use the Win32 WM_POWERBROADCAST message (value of 536).</p>
      <p>
        <b>BINDEVENT(hWnd, nMessage, oEventHandler, cDelegate)</b>
      </p>
      <p>The following example illustrates detection of a Windows XP Theme change:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>#DEFINE WM_THEMECHANGED    0x031A
#DEFINE GWL_WNDPROC    (-4)
PUBLIC oHandler
oHandler=CREATEOBJECT("AppState")
BINDEVENT(_SCREEN.hWnd, WM_THEMECHANGED, oHandler, "HandleEvent")
MESSAGEBOX("Test by changing Themes.")
DEFINE CLASS AppState AS Custom
nOldProc=0
PROCEDURE Destroy
    UNBINDEVENT(_SCREEN.hWnd, WM_THEMECHANGED)
ENDPROC
PROCEDURE Init
    DECLARE integer GetWindowLong IN WIN32API ;
        integer hWnd, ;
        integer nIndex
    DECLARE integer CallWindowProc IN WIN32API ;
        integer lpPrevWndFunc, ;
        integer hWnd,integer Msg,;
        integer wParam,;
        integer lParam
    THIS.nOldProc=GetWindowLong(_VFP.HWnd,GWL_WNDPROC)
ENDPROC
PROCEDURE HandleEvent(hWnd as Integer, Msg as Integer, ;
    wParam as Integer, lParam as Integer)
    lResult=0
    IF msg=WM_THEMECHANGED
        MESSAGEBOX("Theme changed...")
    ENDIF
    lResult=CallWindowProc(this.nOldProc,hWnd,msg,wParam,lParam)
    RETURN lResult
ENDPROC
ENDDEFINE</pre></td></tr></table></span></div>
      <p>The following SYS( ) functions are also available to assist with handing these events:</p>
      <ul><li>
          <p>SYS(2325) - returns the hWnd of a client window from the parent window's WHANDLE.</p>
        </li><li>
          <p>SYS(2326) - returns a Visual FoxPro WHANDLE from a window’s hWnd.</p>
        </li><li>
          <p>SYS(2327) - returns a window's hWnd from a Visual FoxPro window’s WHANDLE.</p>
        </li></ul>
      <p>For more information, see <span class="linkTerms"><a href="/html/e0aaf535-c606-44bd-b7c1-7d0341331d8f.htm">BINDEVENT( ) Function</a></span>, <span class="linkTerms"><a href="/html/b64acd53-4196-48ce-9ab3-8da9dc8ed49a.htm">UNBINDEVENTS( ) Function</a></span>, and <span class="linkTerms"><a href="/html/d8025938-9dc6-4091-840b-2770396946c8.htm">AEVENTS( ) Function</a></span>. Also, see <span class="linkTerms"><a href="/html/95a36787-89ac-4e4f-ac50-60708ab61363.htm">SYS(2325) - WCLIENTWINDOW from Visual FoxPro WHANDLE</a></span>, <span class="linkTerms"><a href="/html/06f2cee1-b3aa-4f81-a37c-2efcd611af41.htm">SYS(2326) - WHANDLE from a Window's hWnd</a></span>, and <span class="linkTerms"><a href="/html/f30fb98e-e1df-4e6b-bf9e-1ad506e06174.htm">SYS(2327) - Window's hWnd from Visual FoxPro WHANDLE</a></span> for related topics. Refer to MSDN as reference source for details on specific window messages.</p>
    </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/46e99caf-fe50-4d55-aa78-e37cffeca2d1.htm">Guide to Reporting Improvements</a></span><br /><span class="linkTerms"><a href="/html/f8ce8cf6-5def-40d0-9dcb-65570d47ce92.htm">Data and XML Feature Enhancements</a></span><br /><span class="linkTerms"><a href="/html/6c75fbec-8d4a-4809-a521-c54802e59ea5.htm">SQL Language Improvements</a></span><br /><span class="linkTerms"><a href="/html/ec67c781-ea65-402c-9b5f-91697f2a0746.htm">Class Enhancements</a></span><br /><span class="linkTerms"><a href="/html/eca7fa6d-ec9c-411a-b3ea-6f5d71991a70.htm">Interactive Development Environment (IDE) Enhancements</a></span><br /><span class="linkTerms"><a href="/html/3d8b88b7-28b8-4d71-a4a1-4da3f1a6dd70.htm">Enhancements to Visual FoxPro Designers</a></span><br /><span class="linkTerms"><a href="/html/ebf2f62e-2ae6-4e78-aeee-e4b322dfc9b9.htm">Miscellaneous Enhancements</a></span><br /><span class="linkTerms"><a href="/html/1845aee0-11f6-4d09-bfbd-b1847476a3d1.htm">Changes in Functionality for the Current Release</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/d18b257b-4e8c-4bd7-bc46-682526474e68.htm">What's New in Visual FoxPro</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="Language Enhancements">
</OBJECT>
