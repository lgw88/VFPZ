<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>EvaluateContents Event</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">EvaluateContents Event</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Occurs just before ReportListener begins rendering objects for a band, for each layout element of Expression type, providing an opportunity to change its attributes.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
PROCEDURE <span class="parameter">Object</span>.EvaluateContents
LPARAMETERS nFRXRecno, oObjProperties</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <p>Visual FoxPro passes the EvaluateContents event parameters in the following order:  </p>
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">nFRXRecno</span>
        </span></dt><dd>
          <p>Integer data type, specifying the record number in the report or label definition file (frx or lbx) describing the layout element being rendered.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">oObjProperties</span>
        </span></dt><dd>
          <p>An object of Empty class, with members providing values relevant to adjusting the attributes of an Expression layout element.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>oObjProperties member</b>
                  
                </th>
                <th>
                  
                    <b>Type</b>
                  
                </th>
                <th>
                  
                    <b>Usage</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>
                  <span class="parameter">reload</span>
                </p>
              </td>
              <td>
                <p>Logical, defaults to .F.</p>
              </td>
              <td>
                <p>Flag to alert the ReportListener if you make changes. </p>
                <p>Set this value to True (<code>.T.</code>) to notify the ReportListener of changes to any of the read/write members of <span class="parameter">oObjProperties</span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">text</span>
                </p>
              </td>
              <td>
                <p>Character, defaults to evaluated contents of the Expression layout element.</p>
              </td>
              <td>
                <p>You can change this value to change the rendered contents of the Expression at run time.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">value</span>
                </p>
              </td>
              <td>
                <p>Variant, readonly </p>
              </td>
              <td>
                <p>This value provides the evaluated results of report expressions, including calculated fields, of the following data types:</p>
                <p>Double (B)</p>
                <p>Date (D)</p>
                <p>Float (F)</p>
                <p>Integer (I) </p>
                <p>Logical (L)</p>
                <p>Numeric (N)</p>
                <p>DateTime (T)</p>
                <p>Currency (Y)</p>
                <p>Null (X)</p>
                <p>For other data types, its contents is a null string (<code>""</code>). </p>
                <p>Expressions concatenated with the special operators "<code>;</code>" and "<code>,</code>" may have elements of mixed type, and are considered character strings (type "C") in this context.  For more information, see <span class="linkTerms"><a href="/html/15fb5410-c1a9-427b-9045-d1a235bc20d2.htm">Trimming and Concatenating Expressions</a></span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">fontname</span>
                </p>
              </td>
              <td>
                <p>Character, defaults to the font stored in the report or label definition table for this layout element.</p>
              </td>
              <td>
                <p>You can change this value to change the font of the Expression at run time.  </p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">fontstyle, fontsize</span>
                </p>
              </td>
              <td>
                <p>Integer, default to the numeric style and size values stored in the report or label definition table for this layout element.</p>
              </td>
              <td>
                <p>You can change these values to change the size and style of the font used to render this Expression at run time.  </p>
                <p>Recognized numeric values for <span class="parameter">oObjProperties.fontstyle</span> are documented in the 60FRX.DBF table in the FILESPEC directory. </p>
                <p>For more information about 60FRX, see <span class="linkTerms"><a href="/html/b9fde125-b9df-4688-bae7-7ae28ebd99ee.htm">Table Structures of Table Files (.dbc, .frx, .lbx, .mnx, .pjx, .scx, .vcx)</a></span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">fillred, fillblue, fillgreen, penred, penblue, pengreen</span>
                </p>
              </td>
              <td>
                <p>Integer, valid values <code>0</code> to <code>255</code>, defaults to <code>255</code>, defaults to the values stored in the report or label definition table, unless the table value was <code>-1</code> to indicate "use default".  If the table value was -<code>1</code>, the ReportListener substitutes the real value it intends to use.</p>
              </td>
              <td>
                <p>You can change these values to change the Red, Blue, and Green components of the Fill and Pen colors for an Expression element.</p>
                <p>For more information, see <span class="linkTerms"><a href="/html/7b5546f4-4e1b-4d79-b038-340988662178.htm">How to: Change Colors in Report Controls</a></span>.</p>
                <p>If a non-valid value or non-numeric value is passed for any of the color properties, they revert to default values stored in the report definition table.  No error occurs.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">fillalpha</span>
                </p>
              </td>
              <td>
                <p>Integer, valid values <code>0</code> to <code>255</code>, defaults to <code>0</code> when backstyle is transparent and <code>255</code> when backstyle is opaque. </p>
              </td>
              <td>
                <p>See Remarks below for information on using the alpha values of report layout elements.  If a non-valid value or non-numeric value is passed for this value, it reverts to the default value as shown in this chart.</p>
                <p>For information on report backstyle settings (transparent and opaque), see <span class="linkTerms"><a href="/html/e812b366-8c88-48c9-ba3c-c1ea7084eecb.htm">How to: Change Opacity of Report Controls</a></span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <span class="parameter">penalpha</span>
                </p>
              </td>
              <td>
                <p>Integer, valid values <code>0</code> to <code>255</code>, defaults to <code>255</code> (opaque).</p>
              </td>
              <td>
                <p>See Remarks below for information on using the alpha values of report layout elements.  </p>
                <p>If a non-valid value or non-numeric value is passed for this value, it reverts to the default value as shown in this chart.</p>
              </td>
            </tr></table></div>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>Microsoft reserves the right to invoke EvaluateContents for additional report and label layout elements, as needed, and to add to the <span class="parameter">oObjProperties</span> members appropriately for these additional layout element types.  You can use <span class="parameter">nFRXRecno</span> to test for layout element type, as shown in the sample code in <span class="linkTerms"><a href="/html/d84ca220-1017-4d03-92d0-907fb6f61f21.htm">Render Method</a></span>. </p>
          </td></tr></table></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Applies To: <span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span>.</p>
      <p>Visual FoxPro calls EvaluateContents at the beginning of band processing, once for each Expression element.  It is not guaranteed to be called exactly once; it may be called multiple times for evaluated expressions that span bands or pages if the Report System deems necessary (for example, if the expression includes _PAGENO). </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>If you write code to try to forecast when EvaluateContents might be called multiple times, consider that not all band types support spanning pages.  Refer to <span class="linkTerms"><a href="/html/49265836-568c-4121-9aa1-789162d15091.htm">Report Bands</a></span> for more information.</p>
      </td></tr></table></div>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>To enhance performance, Visual FoxPro does not call either AdjustObjectSize or EvaluateContents if it determines that there is no code in the ReportListener for the event.  If you usually include placeholder code or generalized code in every event, consider omitting such code for these two events, especially if the class level is <i>abstract</i> (never directly instantiated).  Only include code at the class levels that actually use this functionality. The performance cost for EvaluateContents increases with amount of text the native ReportListener provides in the <span class="parameter">oObjProperties.text</span> member property, so it may vary with each call.</p>
      </td></tr></table></div>
      <p>You can use this method to change various characteristics of Expression layout elements. However, you cannot change the width of the layout element, so you should adjust the font characteristics and contents of the Expression with this limitation in mind.  If the layout element has been marked to stretch, it follows the same rules as Shape and Picture elements to which you make height adjustments in the AdjustObjectSize event.  For more information, see <span class="linkTerms"><a href="/html/b540b27d-e929-4b76-ab2c-c8b1431e140f.htm">AdjustObjectSize Event</a></span>.</p>
      <p>EvaluateContents gives you the means to change the <i>Alpha value</i> (transparency) of both the Pen and Fill values for an Expression. Report and label definition files store only RGB (Red, Green, Blue) components of color values, with a single setting for "opaque" or "transparent."  Using EvaluateContents, you can provide more subtle color effects by direct manipulation of the Alpha value.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>The ability to use Alpha color values when rendering is a feature provided by Microsoft Windows GDI+.  For more information, see <span class="linkTerms"><a href="/html/e11b3ffe-ee6b-4af3-94f8-7a5ed30ea83d.htm">Using GDI+ in Reports</a></span>.</p>
      </td></tr></table></div>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">The following example cycles through different color combinations based for the odd and even instances of any report's Detail band Expressions, providing a "greenbar" output effect. It also applies some style attributes to elements not in Detail bands.  Notice that these effects are applied only to Expressions (for example, labels in a Page Header band are not affected).</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>oReportListener = CREATEOBJECT("greenBar")
oReportListener.ListenerType = 1
REPORT FORM (GETFILE("frx")) PREVIEW OBJECT oReportListener 
#DEFINE DETAIL_BAND 4
#DEFINE BOLD_UNDERLINE_ITALIC 1+4+2
DEFINE CLASS greenBar AS ReportListener
   detailInstance = 0
   isDetail = .F.
   PROC BeforeBand(nBandObjCode, nFRXRecno)
     IF nBandObjCode = DETAIL_BAND
        THIS.detailInstance = THIS.detailInstance + 1
        THIS.isDetail = .T.
     ELSE
        THIS.isDetail = .F.     
     ENDIF
   ENDPROC
   PROC EvaluateContents(nFRXRecno, oProps)
       oProps.Reload = .T. 
       * re-load every time, in this example,
       * since we want to change every Expression
       IF THIS.isDetail
          IF THIS.detailInstance % 2 = 0 
             oProps.penRed = 0
             oProps.penBlue = 125
             oProps.penGreen = 0
          ELSE
             oProps.penRed = 0
             oProps.penBlue = 0
             oProps.penGreen = 0
             oProps.fillRed = 0
             oProps.FillBlue = 0
             oProps.FillGreen = 255
             oProps.FillAlpha = 125
              *half-transparent background color
          ENDIF
       ELSE   
          oProps.FontStyle = BOLD_UNDERLINE_ITALIC
       ENDIF
   ENDPROC
ENDDEFINE</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/7b16861e-08b8-4cc4-9050-3cb090e00657.htm">How to: Add Field Controls to Reports</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/45aa16ed-5a77-45e0-a382-dcb7be6f10d7.htm">Events (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="EvaluateContents Event">
<param name="ALink Name" value="EvaluateContents">
<param name="Alink Name" value="vfp.50000906">
</OBJECT>
