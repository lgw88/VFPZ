<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>ReportListener XML Display-Style Foundation Class</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">ReportListener XML Display-Style Foundation Class</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>The XmlDisplayListener class tunes XmlListener's default VFP Report XML schema settings suitably for presentation output needs.  For full information on the VFP Reporting XML Schema and its options, see <span class="linkTerms"><a href="/html/85f74bc8-b2a7-4ef5-8f2d-cd381c33331f.htm">Using VFP Report Output XML</a></span>.</p>
    <p>XmlDisplayListener also adds image-file-publishing capabilities:</p>
    <ul><li>
        <p>You can copy the image files used in your report to a new location. </p>
      </li><li>
        <p>You can save images rendered during the report from general fields or image control references, which were not based on files, to files on disk.</p>
      </li></ul>
    <p>These capabilities are useful when you are preparing reporting output to be published or packaged for display on the Web or for further processing by another publishing application.</p>
    <p>See <span class="linkTerms"><a href="/html/5f0a1dab-ce24-4c87-ac2e-cb9e631d0115.htm">ReportListener HTML Foundation Class</a></span> for sample code.</p>
    <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
          <th>
            
              <b>Category</b>
            
          </th>
          <th>
            
              <b>Reporting</b>
            
          </th>
        </tr><tr>
        <td>
          <p>Default Catalog</p>
        </td>
        <td>
          <p>Visual FoxPro Catalog\Foundation Classes\Output\Report Listeners</p>
        </td>
      </tr><tr>
        <td>
          <p>Class</p>
        </td>
        <td>
          <p>XmlDisplayListener</p>
        </td>
      </tr><tr>
        <td>
          <p>Base Class</p>
        </td>
        <td>
          <p>ReportListener</p>
        </td>
      </tr><tr>
        <td>
          <p>Class Library</p>
        </td>
        <td>
          <p>_REPORTLISTENER.vcx</p>
        </td>
      </tr><tr>
        <td>
          <p>Parent Class</p>
        </td>
        <td>
          <p>XmlListener (<span class="linkTerms"><a href="/html/9631e586-cecd-44de-8ef9-be5805625c59.htm">ReportListener XML Foundation Class</a></span>)</p>
        </td>
      </tr></table></div>
  <h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0)" tabindex="0"><img id="sectionToggle0" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>XmlDisplayListener, General Fields, and Image Controls</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="display: none;">
      <p>When processing images that did not come from a file on disk, XmlDisplayListener always provides a copy on disk for your use.  By default, these files are placed in the same location as your generated report output file, but you can set this location to a different folder, using the XmlDisplayListener.externalFileLocation property. The folder you nominate for this use must exist; otherwise, XmlDisplayListener ignores the instruction.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>When preparing to publish web documents, you will often want to set the location of the image files to a separate directory from the main output file.  It is a good idea to set the location as a <i>relative reference</i>, such as <code>".\images</code>.<code>"</code>  XmlDisplayListener understands these references to be relative to your main output file. </p>
      </td></tr></table></div>
      <p>XmlDisplayListener must save a separate image to disk every time the report renders an image.  Because these images may be different for every record in your report, it uses a generated filename convention to name the files.  You can adjust these filenames by adding a base filename, to which XmlDisplayListener adds its generated portion as a suffix.  This distinguishes your image files from other files from different report runs.</p>
      <p>By default, the base class ReportListener does not send full image information to its derived classes.  You must request the appropriate information, using the <b>ReportListener.SendGDIPlusImage</b> property.</p>
      <p>At the start of a report run, XmlDisplayListener checks to see if there are any General fields in your report design.  If it finds references to General fields, it sets .SendGDIPlusImage temporarily, if necessary, and restores the value later. </p>
      <p>In Visual FoxPro 9, report designs can include expressions that reference Image controls, as well as general fields and image files on disk.  If the Report Engine finds an expression representing an Image control object associated with an Image layout control while it processes your report, it uses the image information in the Image control's PictureVal property.  For more information, see <span class="linkTerms"><a href="/html/2c035350-434d-495a-9434-7dce6b279a04.htm">PictureVal Property</a></span>.</p>
      <p>XmlDisplayListener cannot know that your report layout expressions may represent Image controls (rather than indirect references to image files on disk) when it evaluates your FRX. For this reason, if you use expressions representing Image controls, unless there are also General fields in your report, you must set its XmlDisplayListener.SendGDIPlusImage explicitly. This explicit instruction will cause the ReportListener to provide the necessary image information as it renders your report.  With this property set, XmlDisplayListener detects the GDPlusImage handle the first time it receives one and, if it has not done so earlier, it will set the other, associated attributes required to save the files to disk.</p>
    </div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1)" tabindex="0"><img id="sectionToggle1" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>XmlDisplayListener and File-based images</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="display: none;">
      <p>By default, XmlDisplayListener simply references any file-based images on disk using the original filename and providing full path information to the source file.  However, you can instruct XmlDisplayListener to publish a copy of your image files to its .externalFileLocation on disk, so you can move the image files with your main XML output file later.  To tell XmlDisplayListener you wish to copy the image files, use its .copyImageFilesToExternalFileLocation property.</p>
    </div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>XmlDisplayListener adds the following public properties to its parent class, XmlListener.  XmlDisplayListener adds no public methods.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Properties and methods</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>externalFileLocation Property</p>
          </td>
          <td>
            <p>Optionally assigns a UNC or file system path, either relative or absolute, the XML result will assign to any external files, such as images, referenced in the main XML output file. </p>
            <p>
              <b>Default </b>
              <code>""</code>
            </p>
          </td>
        </tr><tr>
          <td>
            <p>copyImageFilesToExternalFileLocation Property</p>
          </td>
          <td>
            <p>Indicates whether file-based images should be copied to a common location from their original locations on your disk, for reference as image sources in the XML output.</p>
            <p>
              <b>Default </b>
              <code>.F.</code>
            </p>
          </td>
        </tr><tr>
          <td>
            <p>imageSrcAttr Property</p>
          </td>
          <td>
            <p>Supplies the name of the XML attribute used to show filename copied, or generated for non-file based images, at run time.</p>
            <p>
              <b>Default </b>
              <code>"img"</code>
            </p>
          </td>
        </tr><tr>
          <td>
            <p>formattingChanges Property</p>
          </td>
          <td>
            <p>Reference in which classes can store information about actions taken to apply changes to object formatting attributes dynamically during a report run.</p>
            <p>
              <b>Default </b>
              <code>.NULL.</code>
            </p>
          </td>
        </tr></table></div>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/bc9c384e-280d-4c04-abe0-7f7c7c5fea4f.htm">Visual FoxPro Foundation Classes A-Z</a></span><br /><span class="linkTerms"><a href="/html/9631e586-cecd-44de-8ef9-be5805625c59.htm">ReportListener XML Foundation Class</a></span><br /><span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/005682e4-5892-4e65-bcc3-2b64213e3fcc.htm">Guidelines for Using Visual FoxPro Foundation Classes</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="ReportListener XML Display-Style Foundation Class">
</OBJECT>
