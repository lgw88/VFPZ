<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>DECLARE - DLL Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">DECLARE - DLL Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Registers a function in an external shared library. Libraries are 32-bit dynamic link library (.DLL) files.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
DECLARE [<span class="parameter">cFunctionType</span>] <span class="parameter">FunctionName</span> IN <span class="parameter">LibraryName</span> [AS <span class="parameter">AliasName</span>]
   [<span class="parameter">cParamType1</span> [@] <span class="parameter">ParamName1</span>, <span class="parameter">cParamType2</span> [@] <span class="parameter">ParamName2</span>, ...]</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">cFunctionType</span>
        </span></dt><dd>
          <p>Indicates the data type of the return value from the shared library, if any. If the function does not return a value, omit <span class="parameter">cFunctionType</span>.</p>
          <p>
            <span class="parameter">cFunctionType</span> can assume the following values:   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">cFunctionType</span>
                  
                </th>
                <th>
                  Description
                </th>
              </tr><tr>
              <td>
                <p>SHORT</p>
              </td>
              <td>
                <p>16-bit integer</p>
              </td>
            </tr><tr>
              <td>
                <p>INTEGER</p>
              </td>
              <td>
                <p>32-bit integer</p>
              </td>
            </tr><tr>
              <td>
                <p>SINGLE</p>
              </td>
              <td>
                <p>32-bit floating point</p>
              </td>
            </tr><tr>
              <td>
                <p>DOUBLE</p>
              </td>
              <td>
                <p>64-bit floating point</p>
              </td>
            </tr><tr>
              <td>
                <p>LONG</p>
              </td>
              <td>
                <p>32-bit long integer</p>
              </td>
            </tr><tr>
              <td>
                <p>STRING</p>
              </td>
              <td>
                <p>Character string</p>
              </td>
            </tr><tr>
              <td>
                <p>OBJECT</p>
              </td>
              <td>
                <p>IDispatch object type</p>
              </td>
            </tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">FunctionName</span>
        </span></dt><dd>
          <p>Specifies the name of the shared library function to register in Visual FoxPro. Function names passed in this parameter are case-sensitive.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>A DLL function name may not be the same as stated in the Win32 API manual. For example, the MessageBox function should be named MessageBoxA (for single-byte character), and MessageBoxW (for UNICODE). If Visual FoxPro cannot locate the DLL function you specify with <span class="parameter">FunctionName</span>, the letter A is appended to the end of the function name and Visual FoxPro searches again for the function with the new name.</p>
          </td></tr></table></div>
          <p>If the shared library function you specify has the same name as a Visual FoxPro function or is not a legal Visual FoxPro name, use the AS clause to assign an alias to the function when you register it, as described later in this topic.   </p>
          <p>You can also use OBJECT as a return value, such as "DECLARE OBJECT <span class="parameter">myfunc</span> IN some DLL ..." although COM conventionally does not have any APIs of this form. For example:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DECLARE INTEGER AccessibleObjectFromWindow IN oleacc.dll ;
integer, integer, string , object @</pre></td></tr></table></span></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">IN <span class="parameter">LibraryName</span></span></dt><dd>
          <p>Specifies the name of the external shared library containing the function specified with <span class="parameter">FunctionName</span>.</p>
          <p>If you specify WIN32API for the <span class="parameter">LibraryName</span>, Visual FoxPro searches for the 32-bit Windows .dll function in Kernel32.dll, Gdi32.dll, User32.dll, Mpr.dll, and Advapi32.dll. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">AS <span class="parameter">AliasName</span></span></dt><dd>
          <p>Specifies an alias name for a shared library function name that has the same name as a Visual FoxPro function or is not a legal Visual FoxPro name. <span class="parameter">AliasName</span> should not be a Visual FoxPro reserved word or the name of a shared library function already registered with Visual FoxPro.</p>
          <p>If you assign alias to the function, use the alias when calling the shared library function. <span class="parameter">AliasName</span> is not case-sensitive. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">cParameterType1</span>[@] <span class="parameter">ParamName1</span>, <span class="parameter">cParameterType2</span>[@] <span class="parameter">ParamName2</span>, ... </span></dt><dd>
          <p>Specifies the parameter types passed to the shared library function.</p>
          <p>
            <span class="parameter">cParameterType</span> is required and specifies the data type of any parameters that the shared library function expects to have passed to it. <span class="parameter">cParameterType</span> may be one of the following:   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">cParameterType</span>
                  
                </th>
                <th>
                  Description
                </th>
              </tr><tr>
              <td>
                <p>INTEGER</p>
              </td>
              <td>
                <p>32-bit integer</p>
              </td>
            </tr><tr>
              <td>
                <p>SINGLE</p>
              </td>
              <td>
                <p>32-bit floating point</p>
              </td>
            </tr><tr>
              <td>
                <p>DOUBLE</p>
              </td>
              <td>
                <p>64-bit floating point</p>
              </td>
            </tr><tr>
              <td>
                <p>LONG</p>
              </td>
              <td>
                <p>32-bit long integer</p>
              </td>
            </tr><tr>
              <td>
                <p>STRING</p>
              </td>
              <td>
                <p>Character string</p>
              </td>
            </tr></table></div>
          <p>Visual FoxPro generates an error if the parameters are not of the type the shared library function expects. Null values can be passed as empty character strings.   </p>
          <p>To pass a parameter by reference when you call the function, you must include the at sign (@) after the parameter <span class="parameter">cParameterType</span> in this command, and before the corresponding variable in the calling function. If you do not include @ in DECLARE, in the calling function, or in both, the parameter is passed by value. For information about shared library functions that require @ to pass parameters by reference, see the programmer's guide for your operating system or environment (for example, refer to the Microsoft <span class="parameter">Win32 Programmer's Guide</span> for information on passing parameters to Windows DLLs).   </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>The parameter names <span class="parameter">ParamName1</span>, <span class="parameter">ParamName2,</span> and so on, are optional, and are not used by Visual FoxPro or the shared library function. You can include them as a reminder of the names and types of parameters the function receives.</p>
          </td></tr></table></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Before you can call a shared library function from within Visual FoxPro, you must issue DECLARE with the name of the function, the name of the shared library containing the function, and the parameter types the function expects to receive.</p>
      <p>For backward compatibility, Visual FoxPro allows calls to external API libraries using the SET LIBRARY command. (Using SET LIBRARY, you can access functions in Foxtools.fll.) However, using DECLARE is the preferred method to register shared library functions.</p>
      <p>Though Visual FoxPro adds the OBJECT <span class="parameter">cFunctionType </span>to this command primarily to support some ActiveX Accessibility API routines, you can use it generically with other Windows API routines.</p>
      <p>For further information about calling shared library functions, see the programmer's guide for your operating system or environment (for example, refer to the Microsoft <span class="parameter">Win32 Programmer's Guide</span> for information on calling DLLs).</p>
      <p>Issue DISPLAY STATUS or LIST STATUS to display the names of registered functions. Issue CLEAR ALL or CLEAR DLLS to remove registered functions from memory.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">This example for Windows returns the window handle for Visual FoxPro or zero if you switch to another Windows application. When the WAIT window is displayed, you have 5 seconds to press <code>ALT+TAB</code> to switch to a different Windows application, or you can leave Visual FoxPro as the active application.</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CLEAR
DECLARE INTEGER GetActiveWindow IN win32api
WAIT WINDOW "You can switch to another application now" TIMEOUT 5
? GetActiveWindow( )</pre></td></tr></table></span></div>
  </div>
  <h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1>
  <div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;">
  <h4 class="subHeading">Reference</h4>
  <span class="linkTerms"><a href="/html/ee58b3ef-853c-4f7b-bd49-777aa8e37746.htm">ADLLS( ) Function</a><img class="vfpxmark" src="../local/vfpXmark.gif"/></span><br />
  <span class="linkTerms"><a href="/html/8466ae8a-18dd-400a-b611-28655d3ac3a7.htm">CALL Command</a></span><br />
  <span class="linkTerms"><a href="/html/b89737d7-7dac-455e-9088-fa0ec6c93b98.htm">CLEAR Commands</a></span><br />
  <span class="linkTerms"><a href="/html/ee221bb2-9d69-40d5-b9e2-01ee8d34614f.htm">DISPLAY DLLS Command</a></span><br />
  <span class="linkTerms"><a href="/html/4ee3835d-e700-4f57-aa04-701010bcc866.htm">DISPLAY STATUS Command</a></span><br />
  <span class="linkTerms"><a href="/html/b1be779a-ddb4-41d2-8b7f-b7bc64a8ccca.htm">LIST DLLS Command</a></span><br />
  <span class="linkTerms"><a href="/html/3eb752a0-b24e-4320-8d81-9ca10124f285.htm">LOAD Command</a></span><br />
  <span class="linkTerms"><a href="/html/868ea430-813a-4911-bb06-8c0d3361b909.htm">SET LIBRARY Command</a></span><br />
  
  <h4 class="subHeading">Other Resources</h4>
  <span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br />
  <span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br />
  <br />
  </div>
  </div>
  
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="DECLARE - DLL Command">
<param name="ALink Name" value="DECLARE - DLL">
</OBJECT>
