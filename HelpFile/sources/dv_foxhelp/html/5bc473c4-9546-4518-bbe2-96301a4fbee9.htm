<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>Modifying International Applications</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Modifying International Applications</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>You can prevent localization problems with code by observing the following guidelines.</p>
  <h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0)" tabindex="0"><img id="sectionToggle0" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Testing for International Versions</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="display: none;">
      <p>If it's important for your application to be able to determine what language Visual FoxPro is running in, you can call <a href="/html/d62a75fe-b095-4f95-bdc9-025fed115423.htm">VERSION( )</a>. Knowing the language environment can help you determine what text to display, how to format data, and so on. For example, the following code determines what language environment Visual FoxPro is running in and then runs a language-specific form:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>IF VERSION(3) = 34 THEN
   * Running in Spanish--display Spanish form
   DO FORM CST_SPN.SCX
ELSE
   * Display English form
   DO FORM CST_ENU.SCX
ENDIF</pre></td></tr></table></span></div>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>Support for double-byte characters strings has been available in Visual FoxPro only since version 3.0b. If your application is relying on the availability of double-byte character set (DBCS) functions, you should also call the <a href="/html/d62a75fe-b095-4f95-bdc9-025fed115423.htm">VERSION(1)</a> function to test the Visual FoxPro version number.</p>
      </td></tr></table></div>
    </div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1)" tabindex="0"><img id="sectionToggle1" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Using Strings</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="display: none;">
      <p>Avoid including strings directly in code because they make localization difficult. For instance, don't include dates and currencies as strings in code. If possible, write your code so that it retrieves strings from files or tables separate from the program.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>The performance of your program might suffer if you remove all strings from it. For example, performance might suffer if the program searches for strings while inside a loop.</p>
      </td></tr></table></div>
      <p>One way to work with strings in an application that will be translated is to use string constants throughout the application. You can then define the text for these constants in a separate text file that is referenced from your programs using the <a href="/html/664378a1-697a-4d4a-9a2d-96fa0c2234bb.htm">#INCLUDE</a> preprocessor directive. For example, instead of embedding the error message "file not found," you can use the constant ERR_FILE_NOT_FOUND. The text for this constant could be in a file called ERR_TEXT.H. A program that uses this technique might look like this:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>#INCLUDE ERR_TEXT.H
* processing here
IF ERR THEN
   MESSAGEBOX( ERR_FILE_NOT_FOUND )
ENDIF</pre></td></tr></table></span></div>
      <p>When your application is localized, the translator can create a locale-specific version of the error text file and then recompile the application.</p>
    <sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <h3 class="subHeading" xmlns="">Working With Strings in DBCS Environments</h3><div class="subSection" xmlns="">
          <p>Visual FoxPro includes functions for manipulating character expressions containing any combination of single-byte or double-byte characters. By using DBCS string functions you can develop applications without having to write extra code that tests for double-byte characters when counting, locating, inserting, or removing characters in a string.</p>
          <p>Most DBCS functions are equivalent to their single-byte counterparts except that they're named with a C suffix to distinguish them. You can use these functions with both single-byte and double-byte data; the DBCS functions return exactly the same value as their single-byte counterparts when single-byte data is passed to them. A few other functions help you work with strings specifically in double-byte environments.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  DBCS string functions
                </th>
                <th>
                  Description
                </th>
              </tr><tr>
              <td>
                <p>
                  <a href="/html/92eec2d2-5016-436d-81bd-a2105a79f45d.htm">AT_C( )</a>
                </p>
              </td>
              <td>
                <p>Returns the position of one string within another (case-sensitive), starting at the left.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/8bb06cb7-6946-4b03-9fcd-c3da8621e44e.htm">ATCC( )</a>
                </p>
              </td>
              <td>
                <p>Returns the position of one string within another (case-insensitive).</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/d747784c-8582-4dc0-945f-450a6da89c23.htm">CHRTRANC( )</a>
                </p>
              </td>
              <td>
                <p>Replaces characters in a string.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/b192a408-fddc-4e66-b448-49dfbe60ad86.htm">IMESTATUS( )</a>
                </p>
              </td>
              <td>
                <p>Toggles double-byte editing in the Browse window.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/3593ed53-01b0-4b3d-9422-8099c66bac1f.htm">ISLEADBYTE( )</a>
                </p>
              </td>
              <td>
                <p>Tests whether a character is a DBCS character.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/d463aaef-63d0-42f9-b80e-0cf4cd1fa4bc.htm">LEFTC( )</a>
                </p>
              </td>
              <td>
                <p>Returns leftmost characters from a string.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/338fd86a-dc0d-4034-a2d3-1a50e3b90700.htm">LENC( )</a>
                </p>
              </td>
              <td>
                <p>Returns the number of characters in a string.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/80b182be-527c-4162-9f0f-8d9acb8bbfe3.htm">LIKEC( )</a>
                </p>
              </td>
              <td>
                <p>Determines whether two strings match.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/a5d7c29d-0ef0-44c9-a231-5e91556f9c67.htm">RATC( )</a>
                </p>
              </td>
              <td>
                <p>Returns the position of one string within another (case-sensitive), starting at the right.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/ef21f6ea-2c50-436a-8f97-79076ed259dd.htm">RIGHTC( )</a>
                </p>
              </td>
              <td>
                <p>Returns rightmost characters from a string.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/e2b743ac-dec7-43ae-82db-ba6fa1e2cbd9.htm">STRCONV( )</a>
                </p>
              </td>
              <td>
                <p>Converts characters between single-byte and double-byte representations.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/b5604621-372a-4ba3-87af-f61b74f900b6.htm">STUFFC( )</a>
                </p>
              </td>
              <td>
                <p>Replaces characters in a string with another string.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <a href="/html/9f7d9f70-46d6-46e6-a05d-12bd75293a54.htm">SUBSTRC( )</a>
                </p>
              </td>
              <td>
                <p>Returns a substring.</p>
              </td>
            </tr></table></div>
          <p>When working with double-byte string functions, remember that the maximum-length limit for variables, names, and so on is effectively cut in half. For more information, see <a href="/html/6e27027b-806b-4f96-b7e5-5f24af2901e0.htm">System Capacities</a>.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>The Visual FoxPro DBCS functions are not supported in earlier versions of Visual FoxPro, and calling them might cause unpredictable results. If you use any DBCS functions in your application, use <a href="/html/d62a75fe-b095-4f95-bdc9-025fed115423.htm">VERSION(1)</a> to verify that the Visual FoxPro version is later than version 3.0.</p>
          </td></tr></table></div>
        </div>
    </sections></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle2)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle2)" tabindex="0"><img id="sectionToggle2" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Working with Date, Time, and Currency Formats</span></h1><div id="sectionSection2" class="section" name="collapseableSection" style="display: none;">
      <p>To help you format dates, times, and currency to match what your users are accustomed to, you can use a variety of formatting techniques. You can:
</p>
      <ul><li>
          <p>Allow Visual FoxPro to use the settings established in the Control Panel.</p>
        </li><li>
          <p>Specify a language or a specific format in the Visual FoxPro Options dialog box that you want to use.</p>
        </li></ul>
      <p>Format dates, times, and currency information in code using the <a href="/html/45018e26-0fce-4f5e-9502-adbc53487a6b.htm">SET SYSFORMATS</a> and <a href="/html/96aefa03-0504-48c8-9fc0-013b3e1c43aa.htm">SET DATE</a> commands. As a rule, you would issue this command during the initialization of your application (for example, in the configuration file). The default for SET SYSFORMATS is OFF, so you must explicitly set it to ON when starting your application.</p>
      <p>You can establish data validation in individual text boxes by setting the <a href="/html/e1c96289-3368-4546-84ce-8b1bd6163e43.htm">Format</a> property of the text box. However, because text box formatting takes precedence over system-wide formatting, this can make it more difficult to localize your application to an environment that uses a different format for dates, currency, and so on.</p>
      <p>For more information about setting local formats, see <a href="/html/5242ab91-3162-4806-810e-e112c5023c81.htm">How to: Set Date, Time, and Currency Formats</a>.</p>
    </div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle3)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle3)" tabindex="0"><img id="sectionToggle3" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Using Preprocessor Directives</span></h1><div id="sectionSection3" class="section" name="collapseableSection" style="display: none;">
      <p>You can create application variants for different locales by using preprocessor directives. These control compilation of code in the application and include the <a href="/html/664378a1-697a-4d4a-9a2d-96fa0c2234bb.htm">#INCLUDE</a>, <a href="/html/dcbe95cc-843b-4ad1-ab4b-85ee2710e065.htm">#DEFINE</a>, <a href="/html/dcbe95cc-843b-4ad1-ab4b-85ee2710e065.htm">#UNDEF</a>, and <a href="/html/e3a7651d-b2c2-4337-a094-0e77395ae782.htm">#IF...#ENDIF</a> constructs.</p>
      <p>Using preprocessor directives can produce variants quickly; however, such directives have the following drawbacks:
</p>
      <ul><li>
          <p>To use preprocessor directives, you bracket code, and extensive bracketing can increase the code's complexity.</p>
        </li><li>
          <p>Compile-time constants are available only in the program that creates them.</p>
        </li></ul>
    </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/f3aa559f-3803-42c2-a4ae-093de0ae8633.htm">Managing Files in an International Application</a></span><br /><span class="linkTerms"><a href="/html/d62a75fe-b095-4f95-bdc9-025fed115423.htm">VERSION( ) Function</a></span><br /><span class="linkTerms"><a href="/html/664378a1-697a-4d4a-9a2d-96fa0c2234bb.htm">#INCLUDE Preprocessor Directive</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/667aa0c1-497c-4aa4-98f9-5e0186fc73f8.htm">Application Creation with Double-Byte Character Sets</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/e3423e23-033c-40b4-971c-75640ab17ec7.htm">Developing International Applications</a></span><br /><span class="linkTerms"><a href="/html/c106718b-a4c4-4e71-a044-8c4cad5666c3.htm">Creating International Applications</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="Modifying International Applications">
</OBJECT>
