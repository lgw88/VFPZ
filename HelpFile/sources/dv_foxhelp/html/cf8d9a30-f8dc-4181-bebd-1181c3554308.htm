<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>AERROR( ) Function</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">AERROR( ) Function</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Creates a variable array containing information about the most recent Visual FoxPro, OLE, or ODBC error.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
AERROR(<span class="parameter">ArrayName</span>)</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">ArrayName</span>
        </span></dt><dd>
          <p>Specifies the name of the array for <b>AERROR( )</b> to create.</p>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(returnValueToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(returnValueToggle)" tabindex="0"><img id="returnValueToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Return Value</span></h1><div id="returnValueSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Numeric. <b>AERROR( )</b> returns the number of rows in the array. </p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>
        <b>AERROR( )</b> creates an array with seven columns containing information about the error. The type of error that occurred determines the number of rows in the array.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>If no error occurred, <b>AERROR( )</b> does not create the array.</p>
      </td></tr></table></div>
      <p>When a Visual FoxPro error occurs, the array contains one row. The following table describes the contents of each element. </p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Element number
            </th>
            <th>
              Description
            </th>
          </tr><tr>
          <td>
            <p>1</p>
          </td>
          <td>
            <p>Numeric. The number of the error. Identical to the value returned by ERROR( ).</p>
          </td>
        </tr><tr>
          <td>
            <p>2</p>
          </td>
          <td>
            <p>Character. The text of the error message. Identical to the value returned by MESSAGE( ).</p>
          </td>
        </tr><tr>
          <td>
            <p>3</p>
          </td>
          <td>
            <p>The null value. However, if the error has an additional error parameter, contains the text of the error parameter. Almost identical to the value returned by SYS(2018), the difference being that AERROR( ) returns mixed case but SYS(2018) returns all uppercase.</p>
          </td>
        </tr><tr>
          <td>
            <p>4</p>
          </td>
          <td>
            <p>The null value. However, as appropriate, contains the number of the work area in which the error occurred.</p>
          </td>
        </tr><tr>
          <td>
            <p>5</p>
          </td>
          <td>
            <p>The null value. However, if a trigger failed (error 1539), contains one of the following numeric values:1 – Insert trigger failed.2 – Update trigger failed.3 – Delete trigger failed.</p>
          </td>
        </tr><tr>
          <td>
            <p>6</p>
          </td>
          <td>
            <p>The null value.</p>
          </td>
        </tr><tr>
          <td>
            <p>7</p>
          </td>
          <td>
            <p>The null value.</p>
          </td>
        </tr></table></div>
      <p>When OLE errors numbered 1427 or 1429 occur, the array contains one row. The following table describes the contents of each element. </p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Element number
            </th>
            <th>
              Description
            </th>
          </tr><tr>
          <td>
            <p>1</p>
          </td>
          <td>
            <p>Numeric. Contains 1427 or 1429.</p>
          </td>
        </tr><tr>
          <td>
            <p>2</p>
          </td>
          <td>
            <p>Character. The text of the Visual FoxPro error message.</p>
          </td>
        </tr><tr>
          <td>
            <p>3</p>
          </td>
          <td>
            <p>Character. The text of the OLE error message.</p>
          </td>
        </tr><tr>
          <td>
            <p>4</p>
          </td>
          <td>
            <p>Character. The application name (for example, Microsoft Excel).</p>
          </td>
        </tr><tr>
          <td>
            <p>5</p>
          </td>
          <td>
            <p>The null value or Character. Contains the name of the application's Help file where more information about the error can be found if the information is available from the application; otherwise contains the null value.</p>
          </td>
        </tr><tr>
          <td>
            <p>6</p>
          </td>
          <td>
            <p>The null value or Character. Contains the Help context ID for the appropriate Help topic if the information is available from the application; otherwise contains the null value.</p>
          </td>
        </tr><tr>
          <td>
            <p>7</p>
          </td>
          <td>
            <p>Numeric. An OLE 2.0 exception number.</p>
          </td>
        </tr></table></div>
      <p>When an ODBC error numbered 1526 occurs, the array contains one or more rows, one row for each ODBC error. The following table describes the contents of each element. </p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Element number
            </th>
            <th>
              Description
            </th>
          </tr><tr>
          <td>
            <p>1</p>
          </td>
          <td>
            <p>Numeric. Contains 1526.</p>
          </td>
        </tr><tr>
          <td>
            <p>2</p>
          </td>
          <td>
            <p>Character. The text of the error message.</p>
          </td>
        </tr><tr>
          <td>
            <p>3</p>
          </td>
          <td>
            <p>Character. The text of the ODBC error message.</p>
          </td>
        </tr><tr>
          <td>
            <p>4</p>
          </td>
          <td>
            <p>Character. The current ODBC SQL state.</p>
          </td>
        </tr><tr>
          <td>
            <p>5</p>
          </td>
          <td>
            <p>Numeric. The error number from the ODBC data source.</p>
          </td>
        </tr><tr>
          <td>
            <p>6</p>
          </td>
          <td>
            <p>Numeric. The ODBC connection handle.</p>
          </td>
        </tr><tr>
          <td>
            <p>7</p>
          </td>
          <td>
            <p>The null value.</p>
          </td>
        </tr></table></div>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">The following example uses ON ERROR to specify an error handling routine named <code>errhand</code>. An error is generated by issuing a misspelled command (BRWS). The <code>errhand</code> error handling routine uses <b>AERROR( )</b> to create an array containing error information, and this information is then displayed.</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>ON ERROR DO errhand     &amp;&amp; errhand is the error handler procedure
BRWS  &amp;&amp; Causes a syntax error
ON ERROR  &amp;&amp; Restore system error handler
PROCEDURE errhand
   = AERROR(aErrorArray)  &amp;&amp; Data from most recent error
   CLEAR
   ? 'The error provided the following information'  &amp;&amp; Display message
   FOR n = 1 TO 7  &amp;&amp; Display all elements of the array
      ? aErrorArray(n)
   ENDFOR</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/92f175d6-95d9-4333-8dd4-4d00969d56a6.htm">COMRETURNERROR( ) Function</a></span><br /><span class="linkTerms"><a href="/html/049df271-42ff-47e3-93e2-d6ea50227c4b.htm">CREATE TRIGGER Command</a></span><br /><span class="linkTerms"><a href="/html/98aaee42-bc60-4d81-81b1-abd8e48f9dc3.htm">ERROR Command</a></span><br /><span class="linkTerms"><a href="/html/58436e37-9eca-4abf-a640-203da985b963.htm">ERROR( ) Function</a></span><br /><span class="linkTerms"><a href="/html/d7508b67-4d24-4ddd-ad92-6a1e17d19a98.htm">MESSAGE( ) Function</a></span><br /><span class="linkTerms"><a href="/html/833fefcd-01e7-423b-998e-611a14e7c163.htm">ON ERROR Command</a></span><br /><span class="linkTerms"><a href="/html/082a9c16-94d6-4ff3-ad0c-82fcf2f5d351.htm">SYS(2018) - Error Message Parameter</a></span><br /><span class="linkTerms"><a href="/html/96de025f-cfcf-4c31-bc14-87d4067b5d52.htm">Error Messages Listed Alphabetically</a></span><br /><span class="linkTerms"><a href="/html/30a2ab2a-d0f7-4840-aecb-fd6ca455aaf3.htm">Error Messages Listed Numerically</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/da6b864f-f7c6-43a3-8218-20d56c7a4764.htm">Functions</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="AERROR( ) Function">
<param name="ALink Name" value="AERROR">
</OBJECT>
