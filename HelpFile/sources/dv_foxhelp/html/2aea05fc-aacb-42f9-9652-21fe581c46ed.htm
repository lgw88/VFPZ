<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Set the Data Environment</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Set the Data Environment</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Each form or set of forms includes a data environment. The data environment is an object that includes the tables or views that the form interacts with and the relationships between tables that the form expects. You can use the data environment to automate opening and closing tables and views when the form is run. In addition, you can use the data environment to set the <a href="/html/76c0d810-a6e4-4076-aa91-0763a6dfe03b.htm">ControlSource</a> property for controls by populating the <b>ControlSource</b> property in the <a href="/html/9e1a457b-616b-4cfb-b1ab-ce8208cc0793.htm">Properties window</a> with all the fields in your data environment.</p>
  <h1 class="heading">Adding Tables to the Data Environment</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>You can visually design the data environment and save it with the form. When you add tables or views to the Data Environment designer, you can see the fields and indexes that belong to the table or view.</p>
      <h3 class="procedureSubHeading">To add tables to the data environment</h3><div class="subSection"><ol><li>
            
              <p>Open the form in the <b>Form Designer</b>.</p>
            
          </li><li>
            
              <p>On the <b>View</b> menu, click <b>Data Environment</b>.</p>
              <p>The Data Environment designer opens for the form's data environment.</p>
            
          </li><li>
            
              <p>On the <b>DataEnvironment</b> menu, click <b>Add</b>.</p>
            
          </li><li>
            
              <p>In the <b>Add Table or View</b> dialog box, click the database you want in the <b>Database</b> list. </p>
            
          </li><li>
            
              <p>In the <b>Select</b> area, click <b>Tables</b> or <b>Views</b>. </p>
            
          </li><li>
            
              <p>In the <b>Tables in database</b> list, click the table or view you want to add to the data environment.</p>
            
          </li><li>
            
              <p>Click <b>Add</b>.</p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
                <p>If no database or project is open, click <b>Other</b> to browse for and select a table.</p>
              </td></tr></table></div>
            
          </li></ol>
          
            <p>You can also drag a table or view from an open project or the <a href="/html/316676c8-1232-4756-b385-fa7af6528835.htm">Database Designer</a> to the Data Environment designer.</p>
          
        </div>
      <p>The following list includes commonly set data environment properties:</p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/f9177a4d-e35c-487a-a458-700e537fe4c7.htm">AutoCloseTables Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/2d8c85b7-9aac-4c20-9ca0-7a1eec2efede.htm">AutoOpenTables Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/de605dd4-524b-4937-9400-65ec6dcb088a.htm">InitialSelectedAlias Property</a></span>
          </p>
        </li></ul>
    </div><h1 class="heading">Setting Indexes for the Data Environment</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>You can set the order your records appear in your report by setting an index for the data environment.</p>
      <h3 class="procedureSubHeading">To set an index for the Data Environment Designer</h3><div class="subSection"><ol><li>
            
              <p>From the <b>View</b> menu, choose <b>Data Environment</b>.</p>
            
          </li><li>
            
              <p>From the shortcut menu, choose <b>Properties</b>.</p>
            
          </li><li>
            
              <p>In the <b>Properties </b>Window, choose <b>Cursor1</b> in the <b>Object</b> box.</p>
            
          </li><li>
            
              <p>Choose the <b>Data</b> tab and select the <b>Order</b> property.</p>
            
          </li><li>
            
              <p>Enter an index name. </p>
              <p>- OR -  </p>
              <p>Select an index from the list of available indexes. </p>
            
          </li></ol></div>
      <p>When the Data Environment Designer is active, the <a href="/html/9e1a457b-616b-4cfb-b1ab-ce8208cc0793.htm">Properties window</a> displays objects and properties associated with the data environment. Each table or view in the data environment, each relationship between tables, and the data environment itself is a separate object in the Object box of the Properties window.</p>
    </div><h1 class="heading">Removing Tables from the Data Environment Designer</h1><div id="sectionSection2" class="seeAlsoNoToggleSection">
      <p>When you remove a table from the data environment, any relationships that the table is involved in are also removed.</p>
      <h3 class="procedureSubHeading">To remove a table or view from the Data Environment Designer</h3><div class="subSection"><ol><li>
            
              <p>In the <a href="/html/35e6ce25-9da0-4754-90e2-f5c70aaa6d79.htm">Data Environment Designer</a>, select the table or view.</p>
            
          </li><li>
            
              <p>From the <b>DataEnvironment</b> menu, choose <b>Remove</b>.</p>
            
          </li></ol></div>
    </div><h1 class="heading">Setting Relationships in the Data Environment</h1><div id="sectionSection3" class="seeAlsoNoToggleSection">
      <p>If you add tables to the Data Environment Designer that have persistent relationships set in a database, the relationships are automatically added in the data environment. If the tables don't have persistent relationships, you can still relate them in the Data Environment Designer.</p>
      <h3 class="procedureSubHeading">To set relationships in the Data Environment Designer</h3><div class="subSection"><ul><li>
            
              <p>Drag a field from the primary table onto the matching index tag in the related table.</p>
            
          </li></ul></div>
      <p>You can also drag a field from the primary table to a field in the related table. If there is no index tag in the related table corresponding to the field in the primary table, you're prompted to create the index tag.</p>
    </div><h1 class="heading">Editing Relationships in the Data Environment</h1><div id="sectionSection4" class="seeAlsoNoToggleSection">
      <p>When you set a relation in the Data Environment Designer, a line between the tables indicates the relationship.</p>
      <h3 class="procedureSubHeading">To edit the properties of the relationship</h3><div class="subSection"><ul><li>
            
              <p>In the <a href="/html/9e1a457b-616b-4cfb-b1ab-ce8208cc0793.htm">Properties</a> window, select the relationship from the <b>Object</b> box.</p>
            
          </li></ul></div>
      <p>The properties of the relationship correspond to clauses and keywords in the <a href="/html/dd0c045b-9749-405d-9d60-0169bede1b3d.htm">SET RELATION</a> and <a href="/html/7a6d0321-1bc1-4a4b-abb0-a9b346da80c6.htm">SET SKIP</a> commands. </p>
      <p>The <a href="/html/06020180-caaa-486e-a586-9ebedf3723ed.htm">RelationalExpr</a> property is set by default to the name of the primary key field in the primary table. If the related table is indexed on an expression, you need to set the RelationalExpr property to this expression. For example, if the related table is indexed on <code>UPPER(cust_id)</code>, you need to set RelationalExpr to <code>UPPER(cust_id)</code>.</p>
      <p>If the relation is not a one-to-many relationship, set the <a href="/html/ee0cd52a-1e92-4de0-8a49-8d9106900590.htm">OneToMany</a> property to false (.F.). This corresponds to using the <a href="/html/dd0c045b-9749-405d-9d60-0169bede1b3d.htm">SET RELATION</a> command without issuing <a href="/html/7a6d0321-1bc1-4a4b-abb0-a9b346da80c6.htm">SET SKIP</a>.</p>
      <p>Setting the OneToMany property of a relation to true (.T.) corresponds to issuing the SET SKIP command. When you skip through the parent table, the record pointer remains on the same parent record until the record pointer moves through all related records in the child table.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>If you want a one-to-many relationship in the form, set the OneToMany property to true (.T.), even if a persistent one-to-many relationship has been established in a database.</p>
      </td></tr></table></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/dd2425b3-544f-4dc0-b67d-c19adce6f035.htm">How to: Create a New Form</a></span><br /><span class="linkTerms"><a href="/html/7d26f971-3df3-418b-8118-236247d1634e.htm">How to: Specify a Form Type</a></span><br /><span class="linkTerms"><a href="/html/725d76dc-5a66-476b-9bff-bea80307ea49.htm">How to: Display a Child Form Inside a Top-Level Form</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/657bcba3-41c6-471a-b40c-48bb28fad84c.htm">Add Table or View Dialog Box</a></span><br /><span class="linkTerms"><a href="/html/9e1a457b-616b-4cfb-b1ab-ce8208cc0793.htm">Properties Window (Visual FoxPro)</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/38622956-e4d5-48ea-ab8e-e78b82407034.htm">Creation of Single- and Multiple-Document Interfaces</a></span><br /><span class="linkTerms"><a href="/html/09e172ed-d3de-446b-9d6f-23b9521fdd1f.htm">Designing Forms</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/158bfe62-3d7b-49b4-a28a-51b3a08f64da.htm">Manipulating Objects</a></span><br /><span class="linkTerms"><a href="/html/adb21354-5dde-4f55-b92a-df0c53810385.htm">Creating Forms</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Set the Data Environment">
</OBJECT>
