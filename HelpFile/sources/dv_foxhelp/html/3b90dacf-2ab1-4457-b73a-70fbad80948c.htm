<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>ON KEY LABEL Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">ON KEY LABEL Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Specifies a command that executes when you press a specific key or key combination or click the mouse button.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
ON KEY [LABEL <span class="parameter">KeyLabelName</span>] [<span class="parameter">Command</span>]</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">LABEL <span class="parameter">KeyLabelName</span></span></dt><dd>
          <p>Specifies the key label name assigned to the key. The <span class="parameter">KeyLabelName</span> is the letter or digit on the key or a special name assigned to the key. The following table lists the special key label names.</p>
          <p>
            <b>Visual FoxPro key label assignments</b>
          </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  For this key
                </th>
                <th>
                  Specify this <span class="parameter">KeyLabelName</span> value
                </th>
              </tr><tr>
              <td>
                <img src="../local/Local_1399125401_arrowl.gif" alt="ArrowLeft screenshot"></img>
              </td>
              <td>
                <p>LEFTARROW</p>
              </td>
            </tr><tr>
              <td>
                <img src="../local/Local_1399125383_arrowr.gif" alt="ArrowRight screenshot"></img>
              </td>
              <td>
                <p>RIGHTARROW</p>
              </td>
            </tr><tr>
              <td>
                <img src="../local/Local_1399125376_arrowu.gif" alt="ArrowUp screenshot"></img>
              </td>
              <td>
                <p>UPARROW</p>
              </td>
            </tr><tr>
              <td>
                <img src="../local/Local_1399125393_arrowd.gif" alt="ArrowDown screenshot"></img>
              </td>
              <td>
                <p>DNARROW</p>
              </td>
            </tr><tr>
              <td>
                <p>HOME</p>
              </td>
              <td>
                <p>HOME</p>
              </td>
            </tr><tr>
              <td>
                <p>END</p>
              </td>
              <td>
                <p>END</p>
              </td>
            </tr><tr>
              <td>
                <p>PAGE UP</p>
              </td>
              <td>
                <p>PGUP</p>
              </td>
            </tr><tr>
              <td>
                <p>PAGE DOWN</p>
              </td>
              <td>
                <p>PGDN</p>
              </td>
            </tr><tr>
              <td>
                <p>DEL</p>
              </td>
              <td>
                <p>DEL</p>
              </td>
            </tr><tr>
              <td>
                <p>BACKSPACE</p>
              </td>
              <td>
                <p>BACKSPACE</p>
              </td>
            </tr><tr>
              <td>
                <p>SPACEBAR</p>
              </td>
              <td>
                <p>SPACEBAR</p>
              </td>
            </tr><tr>
              <td>
                <p>INS</p>
              </td>
              <td>
                <p>INS</p>
              </td>
            </tr><tr>
              <td>
                <p>TAB</p>
              </td>
              <td>
                <p>TAB</p>
              </td>
            </tr><tr>
              <td>
                <p>SHIFT+TAB</p>
              </td>
              <td>
                <p>BACKTAB</p>
              </td>
            </tr><tr>
              <td>
                <p>Left Brace</p>
              </td>
              <td>
                <p>LBRACE</p>
              </td>
            </tr><tr>
              <td>
                <p>Right Brace</p>
              </td>
              <td>
                <p>RBRACE</p>
              </td>
            </tr><tr>
              <td>
                <p>ENTER</p>
              </td>
              <td>
                <p>ENTER</p>
              </td>
            </tr><tr>
              <td>
                <p>F1 to F12</p>
              </td>
              <td>
                <p>F1, F2, F3 ... </p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+F1 to CTRL+F12</p>
              </td>
              <td>
                <p>CTRL+F1, CTRL+F2 ... </p>
              </td>
            </tr><tr>
              <td>
                <p>SHIFT+F1 to SHIFT+F12</p>
              </td>
              <td>
                <p>SHIFT+F1, SHIFT+F2 ... </p>
              </td>
            </tr><tr>
              <td>
                <p>ALT+F1 to ALT+F12</p>
              </td>
              <td>
                <p>ALT+F1, ALT+F2, ALT+F3 ... </p>
              </td>
            </tr><tr>
              <td>
                <p>ALT+0 to ALT+9</p>
              </td>
              <td>
                <p>ALT+0, ALT+1, ALT+2 ... </p>
              </td>
            </tr><tr>
              <td>
                <p>ALT+A to ALT+Z</p>
              </td>
              <td>
                <p>ALT+A, ALT+B, ALT+C ... </p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+LEFT ARROW</p>
              </td>
              <td>
                <p>CTRL+LEFTARROW</p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+RIGHT ARROW</p>
              </td>
              <td>
                <p>CTRL+RIGHTARROW</p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+HOME</p>
              </td>
              <td>
                <p>CTRL+HOME</p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+END</p>
              </td>
              <td>
                <p>CTRL+END</p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+PAGE UP</p>
              </td>
              <td>
                <p>CTRL+PGUP</p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+PAGE DOWN</p>
              </td>
              <td>
                <p>CTRL+PGDN</p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+A TO CTRL+Z</p>
              </td>
              <td>
                <p>CTRL+A, CTRL+B, CTRL+C ... </p>
              </td>
            </tr><tr>
              <td>
                <p>CTRL+0</p>
              </td>
              <td>
                <p>CTRL+0</p>
              </td>
            </tr><tr>
              <td>
                <p>RIGHT MOUSE BUTTON</p>
              </td>
              <td>
                <p>RIGHTMOUSE</p>
              </td>
            </tr><tr>
              <td>
                <p>LEFT MOUSE BUTTON</p>
              </td>
              <td>
                <p>LEFTMOUSE</p>
              </td>
            </tr><tr>
              <td>
                <p>MOUSE BUTTON</p>
              </td>
              <td>
                <p>MOUSE</p>
              </td>
            </tr><tr>
              <td>
                <p>ESC</p>
              </td>
              <td>
                <p>ESC</p>
              </td>
            </tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">Command</span>
        </span></dt><dd>
          <p>Specifies the command that executes when you press the specified key or key combination or click the mouse button.</p>
          <p>You can include parameter or parameter expressions with the command that you assign to the key, as in the following example:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>ON KEY LABEL ALT+V WAIT WINDOW "Version: " + VERSION()</pre></td></tr></table></span></div>
          <p>You can include variables in the assignment, but they must be public. For example:   </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>PUBLIC message
message = "Default drive: " + SYS(5)
ON KEY LABEL ALT+D WAIT WINDOW message</pre></td></tr></table></span></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>ON KEY LABEL typically uses DO to execute a procedure.</p>
      <p>ON KEY LABEL executes the command immediately during the execution of READ, BROWSE, EDIT, CHANGE, and user-defined menus. If a program is executing when you press the key or click the mouse button, Visual FoxPro executes the current program line and then executes the ON KEY LABEL command. Any ON KEY LABEL key assignments created in a program remain in effect after the program is run. You can also create key assignments in the Command window.</p>
      <p>To restore the behavior of a specific key to normal, issue ON KEY LABEL <span class="parameter">KeyLabelName</span>. To restore all keys to their default behavior, issue ON KEY.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>To prevent recursive calls during the execution of an ON KEY LABEL procedure, include PUSH KEY CLEAR early in the procedure to disable all active ON KEY LABEL commands. Issue POP KEY at the end of the procedure to enable the ON KEY LABEL commands.</p>
      </td></tr></table></div>
      <p>The ON KEY LABEL key assignments aren't in effect in the Visual FoxPro system menu bar, system menus, dialog boxes, alerts, and so on. The key assignments are effective in the Visual FoxPro system windows — the Visual FoxPro text editor, the Command window, the Trace window, and so on.</p>
      <p>Unlike ON KEY, there can be multiple active ON KEY LABEL commands. For example, you can assign a command to each of the arrow keys and a mouse button.</p>
      <p>Executing an ON KEY LABEL resets PARAMETERS( ) to 0. For more information, see <span class="linkTerms"><a href="/html/8eff764b-a635-4129-8481-cb12433582ad.htm">PARAMETERS( ) Function</a></span>.</p>
      <p>In Visual FoxPro, certain events cannot be trapped because they are under the control of Windows. In particular, ON KEY LABEL MOUSE, ON KEY LABEL LEFTMOUSE, and ON KEY LABEL RIGHTMOUSE are not executed when you click a Windows control such as a Control menu, scroll bar, or the like. Also, CTRL+0 is supported in ON KEY LABEL in Visual FoxPro, allowing you to redefine the key combination used to enter a null value into a field.</p>
      <p>Note that ON KEY LABEL operates outside of the scope of a form; the KeyPress event can be used within forms to execute code when a key is pressed.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">The following example displays a message when an arrow key is pressed.</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CLEAR
PUBLIC msg
msg = CHR(13) + CHR(13) + "Press F9 to " + ;
   "restore default key definition."
ON KEY LABEL RIGHTARROW Wait Window "Right Arrow " + msg NOWAIT
ON KEY LABEL LEFTARROW Wait Window "Left Arrow " + msg NOWAIT
ON KEY LABEL UPARROW Wait Window "Up Arrow " + msg NOWAIT
ON KEY LABEL DNARROW Wait Window "Down Arrow " + msg NOWAIT
* Press F9 to clear the ON KEY LABEL assignments
ON KEY LABEL F9 ON KEY</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/6ec18e2b-8a69-4dfb-afc5-6375703a47b0.htm">INKEY( ) Function</a></span><br /><span class="linkTerms"><a href="/html/8afda750-86c0-4d0b-9303-fc8dbbc44af0.htm">KeyPress Event</a></span><br /><span class="linkTerms"><a href="/html/421c6247-80e9-478a-a7a3-2f2bd4d816c0.htm">ON( ) Function</a></span><br /><span class="linkTerms"><a href="/html/85aa73a0-541d-4351-8d78-1e2eca1fed3f.htm">POP KEY Command</a></span><br /><span class="linkTerms"><a href="/html/b02789ec-3263-4e16-b00c-f02b5ca4031d.htm">PUSH KEY Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="ON KEY LABEL Command">
<param name="ALink Name" value="ON KEY LABEL">
</OBJECT>
