<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Build Referential Integrity Between Tables</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Build Referential Integrity Between Tables</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>You can create a set of rules to preserve the relationships defined between database tables when adding, updating, or deleting records. The process of creating these rules is called building referential integrity. </p>
  <h3 class="procedureSubHeading">To build referential integrity between tables</h3><div class="subSection"><ol><li>
        
          <p>Open the database in the <b>Database Designer</b>.</p>
        
      </li><li>
        
          <p>In the <b>Database Designer</b>, create a new persistent relationship between two tables or choose an existing relationship by clicking the relationship line.</p>
        
      </li><li>
        
          <p>On the <b>Database</b> menu, click <b>Edit Referential Integrity</b>.</p>
        
      </li><li>
        
          <p>In the <b>Referential Integrity Builder</b>, select the rules you want to enforce for updating, deleting, or inserting records.</p>
        
      </li><li>
        
          <p>To save your changes, generate RI code, and exit the builder, click <b>OK</b>, and then <b>Yes</b>.</p>
        
      </li></ol>
      
        <p>For more information, see <span class="linkTerms"><a href="/html/50c4141c-d439-482e-835d-df3dbcb0a0cd.htm">Referential Integrity Builder</a></span>.</p>
        <p>When you use the RI Builder, Visual FoxPro generates code for enforcing referential integrity rules and saves it as triggers that reference stored procedures. A trigger is an expression that is bound to a table and is invoked when table records are modified by specified data manipulating commands. You can view this code by opening the stored procedure text editor for your database. For more information, see <span class="linkTerms"><a href="/html/068a2421-21b1-4651-a8ab-fa8207c0357e.htm">Trigger Usage</a></span> and <span class="linkTerms"><a href="/html/3f7655ec-253a-4989-82c9-141c309a5141.htm">How to: Create and Manage Stored Procedures</a></span>.</p>
        <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Caution note" src="../local/Caution.gif"></img>Caution </th></tr><tr><td>
          <p>Run the RI Builder again when you make changes to a database such as modifying database tables or altering indexes used in a persistent relationship before you use the database. Rerunning the RI Builder updates stored procedure code and table triggers used to enforce referential integrity. If you do not rerun the RI Builder, you might receive unexpected results because the stored procedures and triggers were not updated.</p>
        </td></tr></table></div>
      
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/8ff74d7d-30c5-412b-a23a-f3d62261dca3.htm">How to: Open Databases</a></span><br /><span class="linkTerms"><a href="/html/79e46b49-14cd-4fb1-8a9b-b2d24ca86d32.htm">How to: Create Persistent Relationships Between Tables</a></span><br /><span class="linkTerms"><a href="/html/3f7655ec-253a-4989-82c9-141c309a5141.htm">How to: Create and Manage Stored Procedures</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/ea7bf414-5b08-4f08-855c-9ba67d09398f.htm">Databases in Visual FoxPro</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/f69c91ac-86af-4f78-9f04-5b7464635a8c.htm">Creating Databases</a></span><br /><span class="linkTerms"><a href="/html/62869817-db20-4de6-b483-c12e179594e3.htm">Working with Items in Databases</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Build Referential Integrity Between Tables">
</OBJECT>
