<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>SELECT - SQL Command - WITH Clause</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">SELECT - SQL Command - WITH Clause</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>The <b>WITH</b> clause allows you to apply a single command to existing SELECT statements without modifying those statements.</p>
    <p>For the complete syntax, see <a href="/html/815f7265-4dfd-40b9-8f19-0673b5a48847.htm">SELECT - SQL Command</a>. </p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
[WITH (BUFFERING = <span class="parameter">lExpr</span>) ]</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">lExpr</span>
        </span></dt><dd>
          <p>Logical data type. The following table lists the values for <span class="parameter">lExpr</span>.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">lExpr</span>
                  
                </th>
                <th>
                  Setting
                </th>
              </tr><tr>
              <td>
                <p>True (.T.)</p>
              </td>
              <td>
                <p>Data in the SQL-SELECT statement is based on buffered data, if available.</p>
              </td>
            </tr><tr>
              <td>
                <p>False (.F.)</p>
              </td>
              <td>
                <p>(Default) Data in the SQL-SELECT statement is based on data written to disk only. </p>
              </td>
            </tr></table></div>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>The following code shows a summary of the main clauses of the <a href="/html/815f7265-4dfd-40b9-8f19-0673b5a48847.htm">SELECT - SQL Command</a>:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT Select_List
   FROM Table_List
...[WITH (BUFFERING = lExpr)]
   [WHERE Conditions]
   [GROUP BY Column_List]
   [UNION Clause]
   [HAVING Conditions]
   [ORDER BY Column_List]
   [INTO Clause | TO Clause ] 
   [Additional_Display_Options]</pre></td></tr></table></span></div>
      <p>For more information about a particular clause of the SQL <b>SELECT</b> command, see the following topics:  </p>
      <ul><li>
          <p>
            <a href="/html/8a629568-55b2-43df-b0e9-8e9f8f527c2f.htm">SELECT Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/4c5507da-5215-4dbe-94d0-3a8e67e17a54.htm">FROM Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/23db93e0-c5ca-4be9-9cf5-05db3876f027.htm">WHERE Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/8697bcbd-4606-4f43-91c3-892358d85e9d.htm">GROUP BY Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/3282aa2c-9b64-4344-9d0d-ce996881c719.htm">HAVING Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/73aa552d-84f7-4c01-a58a-1ca40880e6b3.htm">UNION Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/54357719-862f-4072-ba9a-f93eabd96873.htm">ORDER BY Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/c3875b75-5dc5-4eff-b33f-25b8686301ad.htm">INTO or TO Clause</a>
          </p>
        </li><li>
          <p>
            <a href="/html/acd4f7e8-8dd3-44c1-b9d0-08e143f8ea74.htm">Additional Display Options</a>
          </p>
        </li></ul>
      <p>If you set <b>BUFFERING</b> to True (.T.), you can query data from a local buffered cursor, which may include records that have been updated but not committed. Otherwise, your results include only records committed to disk.</p>
      <p>If the cursor uses row buffering, then current record is committed before the statement is executed. </p>
      <p>If the cursor uses table buffering, then the modified current record is saved into the buffer.</p>
      <p>The <b>WITH</b> clause to specify <b>BUFFERING</b> is supported on local Visual FoxPro data only and not on data from back-end databases.</p>
      <p>If you set <b>BUFFERING</b> to False (.F.), then your <b>SELECT</b> statement pulls data from cursor on disk (which may be different to what is in buffer). If you do not include the <b>BUFFERING</b> statement, then your results are based on the setting for <span class="linkTerms"><a href="/html/bdecd636-5e6f-4ffa-b4b7-a2dd571e4c69.htm">SET SQLBUFFERING Command</a></span>. By default, your queries pull data from disk. A <b>SELECT</b> statement <b>WITH BUFFERING</b> set to True (.T.) overrides the <b>SET SQLBUFFERING</b> setting.</p>
      <p>The <b>WITH BUFFERING</b> option is effective in the following cases:</p>
      <ul><li>
          <p>The work area does not have an alias specified to support the cursor referenced in the statement.</p>
        </li><li>
          <p>The cursor is not buffered.</p>
        </li><li>
          <p>The cursor acts as the target for update or delete operations.</p>
        </li></ul>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0)" tabindex="0"><img id="sectionToggle0" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example 1</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="display: none;">
    <sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <div class="subSection" xmlns="">
          <p>The following example shows a simple statement referencing a single table. You need to have a work area that has the alias "Customers" in order for the <b>WITH</b> clause to be effective.</p>
        </div>
      <div class="subSection" xmlns="">
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT * FROM customers WITH (BUFFERING=.T.)</pre></td></tr></table></span></div>
        </div>
    </sections></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1)" tabindex="0"><img id="sectionToggle1" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example 2</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="display: none;">
    <sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <div class="subSection" xmlns="">
          <p>The following example shows that each table referenced in the <b>FROM</b> clause needs a <b>WITH BUFFERING</b> clause. </p>
        </div>
      <div class="subSection" xmlns="">
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SET MULTILOCKS ON
CREATE TABLE Table1 (Field1 N(10), Field2 N(10))
CREATE TABLE Table2 (Field3 N(10), Field4 N(10))
CURSORSETPROP("Buffering", 5, "Table1")
CURSORSETPROP("Buffering", 5, "Table2")
INSERT INTO Table1 VALUES (1, 1)
INSERT INTO Table2 VALUES (0, 100)
SELECT Table1.*, Table2.* ;
   FROM FORCE Table1 ;
      JOIN Table2 ;
      ON Field1&gt;=Field3 AND Field2&gt;0 AND Field4&lt;100
REPLACE Field4 WITH 99 IN Table2
SELECT Table1.*, Table2.* ;
   FROM FORCE Table1 ;
      JOIN Table2 ;
      ON Field1&gt;=Field3 AND Field2&gt;0 AND Field4&lt;100
SELECT Table1.*, Table2.* ;
   FROM FORCE Table1 WITH (BUFFERING=.T.) ;
      JOIN Table2 WITH (BUFFERING=.T.) ;
      ON Field1&gt;=Field3 AND Field2&gt;0 AND Field4&lt;100</pre></td></tr></table></span></div>
        </div>
    </sections></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/af6dbad4-9e4b-4343-abc7-fab66044f6e6.htm">CREATE QUERY Command</a></span><br /><span class="linkTerms"><a href="/html/e50de98c-0375-492c-a432-e667a1711b11.htm">MODIFY QUERY Command</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/c94d4b30-e6aa-408c-a29d-6b27eb93674d.htm">Buffering Data</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/ccb3a0ad-7fe4-4267-ba42-aa9918ed1f21.htm">Working with Queries</a></span><br /><span class="linkTerms"><a href="/html/d5335001-400d-4bd8-8e01-172b75f8f979.htm">Working with Views (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/d9f7a435-663d-4523-9511-c847be4311ca.htm">Query and View Designers</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="SELECT - SQL Command - WITH Clause">
</OBJECT>
