<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>ReportListener FXListener Foundation Class</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">ReportListener FXListener Foundation Class</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>
      <b>FXListener</b> enables you to change the display characteristics of report controls during a report run. You can use two member collections: FXs (adjust content and format instructions) and GFXs (adjust or replace GDIPlus-graphics rendering) to affect report rendering.</p>
    <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
          <th>
            
              <b>Category</b>
            
          </th>
          <th>
            
              <b>Reporting</b>
            
          </th>
        </tr><tr>
        <td>
          <p>Default Catalog</p>
        </td>
        <td>
          <p>Visual FoxPro Catalog\Foundation Classes\Output\Report Listeners</p>
        </td>
      </tr><tr>
        <td>
          <p>Class</p>
        </td>
        <td>
          <p>FXListener</p>
        </td>
      </tr><tr>
        <td>
          <p>Base Class</p>
        </td>
        <td>
          <p>ReportListener</p>
        </td>
      </tr><tr>
        <td>
          <p>Class Library</p>
        </td>
        <td>
          <p>_REPORTLISTENER.vcx</p>
        </td>
      </tr><tr>
        <td>
          <p>Parent Class</p>
        </td>
        <td>
          <p>_ReportListener (<span class="linkTerms"><a href="/html/ad251059-3de1-4928-992c-ddb8be50fce8.htm">ReportListener Base Foundation Class</a></span>)</p>
        </td>
      </tr></table></div>
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>You will probably not instantiate this class directly. You will instantiate one of the classes that derive from it, such as HtmlListener.</p>
      <p>To take advantage of FXListener's ability to effect report output, you need to create FX or GFX objects. </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>The fxAbstract class in the _REPORTLISTENER.vcx class library supplies an abstract instance of the required interface for an FX or GFX object.</p>
      </td></tr></table></div>
      <p>Each FX or GFX object must provide the following interface:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>PROCEDURE ApplyFX(toListener, tcMethodToken,tP1, tP2, tP3, tP4, tP5, tP6, tP7, tP8, tP9, tP10, tP11, tP12).</pre></td></tr></table></span></div>
      <dl><dt><span class="nonLinkTerms">toListener</span></dt><dd>
          <p>A reference to the listener object.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">tcMethodToken</span></dt><dd>
          <p>The report listener event currently executing: AdjustObjectSize, AfterBand, AfterReport, BeforeBand, BeforeReport, Destroy, Error, EvaluateContents, Init, LoadReport, or UnloadReport</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">tP1 through tP12</span></dt><dd>
          <p>The parameters of the report listener event currently executing. For example, the BeforeBand event has two parameters, nBandObjCode and nFRXRecNo. When tcMethodToken is "BeforeBand," tP1 is nBandObjCode and tP2 is nFRXRecNo.</p>
        </dd></dl>
      <p>You can use FXListener's <b>AddCollectionMember</b> method to add FX or GFX objects to your report listener. For example, the following code in the <b>Init</b> event of an htmllistener adds an FX object to the collection.</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>THIS.AddCollectionMember("myFX", "myClassLibrary.vcx")
DODEFAULT( )</pre></td></tr></table></span></div>
      <p>For each report listener event, FXListener invokes its sendFX( ) method to call the ApplyFX( ) method in every FX or GFX object in the collections. You can use<b> IF...ENDIF</b> blocks or <b>CASE</b> statements to check for the report listener event and then take appropriate action. For example, the following section of code in the <b>ApplyFX</b> method of an FX object makes the text of a control on a report upper case.</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>LPARAMETERS toListener, tcMethodToken,tP1, tP2, tP3, tP4, tP5, tP6, tP7, tP8, tP9, tP10, tP11, tP12
IF tcMethodToken == "RENDER"
  IF tP1 == 11 
  * nFRXRecno is Render's 1st param (tP1) and 11 refers to 
  * the record in the FRX of a particular control on the report
  tP7 = UPPER(tP7)
  * cContentsToBeRendered is Render's 7th param
  ENDIF
ENDIF</pre></td></tr></table></span></div>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>The subclasses of fxAbstract (fxmemberdatascript, fxresetpagetotal, gfxexample, gfxnorender, and gfxrotate) provide examples of FX and GFX classes you can use with FXListener.</p>
      </td></tr></table></div>
      <p>The following table lists public properties and methods added by this class to its parent class, _ReportListener. </p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Properties and methods</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>AddCollectionMember Method</p>
          </td>
          <td>
            <p>Adds an instance of a specified class in a specified class library to the FX or GFX collection. This method expects the following parameters: tcClass, tcClassLib, tcModule, tlSingleton, tlInGFX, tlRequired.</p>
          </td>
        </tr><tr>
          <td>
            <p>CancelRequested Property</p>
          </td>
          <td>
            <p>Notification flag for FX objects used to request a report cancellation.</p>
          </td>
        </tr><tr>
          <td>
            <p>CheckCollectionForSpecifiedMember Method</p>
          </td>
          <td>
            <p>Checks the FX or GFX collection for an instance of a class by class name and (if specified) by class library name. Returns the logical (.F. if not found) or object reference.</p>
          </td>
        </tr><tr>
          <td>
            <p>ClassPath Property</p>
          </td>
          <td>
            <p>Optional location that specifies the path for loading objects from external libraries.</p>
          </td>
        </tr><tr>
          <td>
            <p>FFCGraphics Property</p>
          </td>
          <td>
            <p>Reference to an FFCGraphic object created during the run. It is provided to members of the GFXs collection. It is validated as an instance of GpGraphics from the FoxPro Foundation Class (FFC) _GDIPLUS.VCX or a class derived from GpGraphics.</p>
          </td>
        </tr><tr>
          <td>
            <p>FRXCursor Property</p>
          </td>
          <td>
            <p>Holds a reference to an FRXCursor helper object. It is used to facilitate run-time calculations related to FRX metadata, structure, and memberdata.</p>
          </td>
        </tr><tr>
          <td>
            <p>FXFeedBackClass Property</p>
          </td>
          <td>
            <p>Class to instantiate in the FX collection for user feedback (defaults to fxTherm).</p>
          </td>
        </tr><tr>
          <td>
            <p>FXFeedbackClassLib Property</p>
          </td>
          <td>
            <p>Class library from which to instantiate the FX collection object that provides user feedback.</p>
          </td>
        </tr><tr>
          <td>
            <p>FXFeedbackModule Property</p>
          </td>
          <td>
            <p>Application module (APP or EXE) from which to instantiate the FX collection object that provides user feedback.</p>
          </td>
        </tr><tr>
          <td>
            <p>FXMemberDataScriptClass Property</p>
          </td>
          <td>
            <p>Class to instantiate in FX collection for memberdata-based script handling (defaults to fxMemberDataScript).</p>
          </td>
        </tr><tr>
          <td>
            <p>FXMemberDataScriptClassLib Property</p>
          </td>
          <td>
            <p>Class library from which to instantiate the FX collection object that provides memberdata-based script-handling.</p>
          </td>
        </tr><tr>
          <td>
            <p>FXMemberDataScriptModule Property</p>
          </td>
          <td>
            <p>Application module (APP or EXE) from which to instantiate the FX collection object that provides memberdata-based script-handling.</p>
          </td>
        </tr><tr>
          <td>
            <p>FXs Property</p>
          </td>
          <td>
            <p>Collection of FX objects. Each object must have the following interface:</p>
            <p>
              <code>PROCEDURE ApplyFX(toListener, tcMethodToken,tP1, tP2, tP3, tP4, tP5, tP6, tP7, tP8, tP9, tP10, tP11, tP12).</code>
            </p>
            <p>The return value from this procedure is ignored.</p>
          </td>
        </tr><tr>
          <td>
            <p>getFRXRecno Method</p>
          </td>
          <td>
            <p>Determines the current FRX cursor row number from the parameters that is passed to a ReportListener event.</p>
          </td>
        </tr><tr>
          <td>
            <p>getPathForExternals Method</p>
          </td>
          <td>
            <p>Determines the location at which the current configuration table and any other required external files will be expected.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXNoRenderClass Property</p>
          </td>
          <td>
            <p>Class to instantiate in the GFX collection for conditionally eliminating baseclass rendering of the various layout controls. It defaults to gfxNoRender if the empty conditional rendering is turned off.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXNoRenderClassLib Property</p>
          </td>
          <td>
            <p>Class library from which to instantiate the GFX collection object that provides conditional baseclass rendering.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXNoRenderModule Property</p>
          </td>
          <td>
            <p>Application module (APP or EXE) from which to instantiate the GFX collection object that provides conditional baseclass rendering.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXRotateClass Property</p>
          </td>
          <td>
            <p>Class to instantiate in the GFX collection for rotating layout controls. It defaults to gfxRotate.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXRotateClassLib Property</p>
          </td>
          <td>
            <p>Class library from which to instantiate the GFX collection object that provides rotation.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXRotateModule Property</p>
          </td>
          <td>
            <p>Application module (APP or EXE) from which to instantiate the GFX collection object that provides rotation.</p>
          </td>
        </tr><tr>
          <td>
            <p>GFXs Property</p>
          </td>
          <td>
            <p>A collection of GFX objects. Each object must have the following interface:</p>
            <p>
              <code>PROCEDURE ApplyFX(toListener, tcMethodToken,P1, tP2, tP3, tP4, tP5, tP6, tP7, tP8, tP9, tP10, tP11, tP12) </code>
            </p>
            <p>The <b>Render</b> method relies on the return value of the procedure.</p>
          </td>
        </tr><tr>
          <td>
            <p>loadFrxCursor Property</p>
          </td>
          <td>
            <p>Determines whether this class should dynamically load an instance of the helper class FRXCursor when you try to access a reference to it.</p>
          </td>
        </tr><tr>
          <td>
            <p>MemberDataAlias Property</p>
          </td>
          <td>
            <p>Alias of the cursor that holds memberdata in the FRXDataSession. It is read from the FRX table's Style field for easy access by other objects.</p>
          </td>
        </tr><tr>
          <td>
            <p>removeCollectionMember Method</p>
          </td>
          <td>
            <p>Provides a way to remove an FX or a GFX object from the FXListener's collections by using an object instance name or a class name.</p>
          </td>
        </tr><tr>
          <td>
            <p>reportStartRunDatetime Property</p>
          </td>
          <td>
            <p>A datetime value that indicates when the last report-generation run began. This property contains meaningful data if the feedback member object has been instantiated. It provides a property with a matching name. This property is read-only.</p>
          </td>
        </tr><tr>
          <td>
            <p>reportStopRunDatetime Property</p>
          </td>
          <td>
            <p>A datetime value for when the last report-generation run ended. This property contains meaningful data if the feedback member object has been instantiated. It provides a property with a matching name. This property is read-only.</p>
          </td>
        </tr><tr>
          <td>
            <p>RunCollectorResetLevel Property</p>
          </td>
          <td>
            <p>Indicates how often the runCollector member should be automatically reset by the report listener (0=never, 1=after each report, 2=after a chained report run).</p>
          </td>
        </tr></table></div>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/ad251059-3de1-4928-992c-ddb8be50fce8.htm">ReportListener Base Foundation Class</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/e11b3ffe-ee6b-4af3-94f8-7a5ed30ea83d.htm">Using GDI+ in Reports</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="ReportListener FXListener Foundation Class">
</OBJECT>
