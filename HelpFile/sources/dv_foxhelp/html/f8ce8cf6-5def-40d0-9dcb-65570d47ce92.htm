<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>Data and XML Feature Enhancements</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Data and XML Feature Enhancements</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Visual FoxPro contains the following additions and improvements to its data features:  </p>
  <a name="fogrfdatafeaturesenhancementsanchor2"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0)" tabindex="0"><img id="sectionToggle0" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Extended SQL Capabilities</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro contains many enhancements for SQL capabilities. For more information, see <span class="linkTerms"><a href="/html/6c75fbec-8d4a-4809-a521-c54802e59ea5.htm">SQL Language Improvements</a></span>. </p>
    </div><a name="fogrfdatafeaturesenhancementsanchor1"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1)" tabindex="0"><img id="sectionToggle1" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>New Data Types</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro includes the following new field and data types:   </p>
      <ul><li>
          <p>
            <b>Varchar </b>
          </p>
          <p>To store alphanumeric text without including padding by additional spaces at the end of the field or truncating trailing spaces, use the new <b>Varchar</b> field type.  </p>
          <p>If you do not want <b>Varchar</b> fields translated across code pages, use the <b>Varchar (Binary)</b> field type. For more information, see <span class="linkTerms"><a href="/html/ecece0aa-2f1b-4135-8429-8a173c9e835e.htm">Varchar Field Type</a></span>.  </p>
          <p>You can specify Varchar type mapping between ODBC, ADO, and XML data source types and <b>CursorAdapter</b> and <b>XMLAdapter</b> objects using the <span class="linkTerms"><a href="/html/40d72380-f51b-4218-b384-b9509ab903ae.htm">MapVarchar Property</a></span>. You can also specify <b>Varchar</b> mapping for SQL pass-through technology and remote views using the MapVarchar setting in the <b>CURSORSETPROP( )</b> function. For more information, see <span class="linkTerms"><a href="/html/423cad42-42a8-4bb1-8d58-226cece91d4e.htm">CURSORSETPROP( ) Function</a></span> and <span class="linkTerms"><a href="/html/4b2168d1-6e9f-4dc4-aaec-ab25b49383ce.htm">CURSORGETPROP( ) Function</a></span>. </p>
        </li><li>
          <p>
            <b>Varbinary </b>
          </p>
          <p>To store binary values and literals of fixed length in fields and variables without padding the field with additional zero (0) bytes or truncating any trailing zero bytes that are entered by the user, use the <b>Varbinary</b> data type. Internally, Visual FoxPro binary literals contain a prefix, 0h, followed by a string of hexadecimal numbers and are not enclosed with quotation marks (""), unlike character strings. For more information, see <span class="linkTerms"><a href="/html/8617af84-55a5-4480-9b44-f349f066dac0.htm">Varbinary Data Type</a></span>.  </p>
          <p>You can specify binary type mapping between ODBC, ADO, and XML data source types and <b>CursorAdapter</b> and <b>XMLAdapter</b> objects using the <span class="linkTerms"><a href="/html/7154a4a9-7cf9-4175-b5da-215947882fa5.htm">MapBinary Property</a></span>. You can also specify binary mapping for SQL pass-through technology and remote views using the <b>MapBinary</b> setting in the <b>CURSORSETPROP( )</b> function. For more information, see <span class="linkTerms"><a href="/html/423cad42-42a8-4bb1-8d58-226cece91d4e.htm">CURSORSETPROP( ) Function</a></span> and <span class="linkTerms"><a href="/html/4b2168d1-6e9f-4dc4-aaec-ab25b49383ce.htm">CURSORGETPROP( ) Function</a></span>. </p>
        </li><li>
          <p>
            <b>Blob</b>
          </p>
          <p>To store binary data with indeterminate length, use the <b>Blob</b> data type. For more information, see <span class="linkTerms"><a href="/html/8159234d-9dfb-44a9-a220-036eb36b1d72.htm">Blob Data Type</a></span>. </p>
        </li></ul>
      <p>Many of the Visual FoxPro language elements affected by these new data types are listed in the topics for the new data types.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor4"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle2)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle2)" tabindex="0"><img id="sectionToggle2" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Binary Index Tag Based on Logical Expressions</span></h1><div id="sectionSection2" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro includes a new binary, or bitmap, index for creating indexes based on logical expressions, for example, indexes based on deleted records. A binary index can be significantly smaller than a non-binary index and can improve the speed of maintaining indexes. You can create binary indexes using the Table Designer or <b>INDEX</b> command. Visual FoxPro also includes Rushmore optimization enhancements in the SQL engine for deleted records.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/fe911859-3235-4349-82c7-fa16a16d5527.htm">Visual FoxPro Index Types</a></span>, <span class="linkTerms"><a href="/html/242d1feb-d43e-4831-9e4b-d0bb0b5fe4ae.htm">INDEX Command</a></span>, <span class="linkTerms"><a href="/html/3c5a454a-67ec-48a8-8290-18dd0e8a97ea.htm">ALTER TABLE - SQL Command</a></span>, and <span class="linkTerms"><a href="/html/7ecc3532-d06f-42b4-b1d0-9bed677cec90.htm">Indexes Based on Deleted Records</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor5"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle3)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle3)" tabindex="0"><img id="sectionToggle3" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Converting Data Types with the CAST( ) Function</span></h1><div id="sectionSection3" class="section" name="collapseableSection" style="display: none;">
      <p>You can convert expressions from one data type to another by using the new <b>CAST( )</b> function. Using <b>CAST( )</b> makes it possible for you to create SQL statements more compatible with SQL Server. </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/55c599e9-18d1-4ac6-b311-e6677dc3b0b7.htm">CAST( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor49"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle4)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle4)" tabindex="0"><img id="sectionToggle4" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Get Cursor and Count Records Affected by SQL Pass-Thru Execution</span></h1><div id="sectionSection4" class="section" name="collapseableSection" style="display: none;">
      <p>By using the <span class="parameter">aCountInfo</span> parameter of the <b>SQLEXEC( )</b> and <b>SQLMORERESULTS( )</b> functions, you can get the name of the cursor created and a count of the records affected by the execution of a SQL pass-through statement.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/8dd6491b-da44-401f-b972-0d51f12f1a07.htm">SQLEXEC( ) Function</a></span>) and <span class="linkTerms"><a href="/html/b21a0d31-b1db-44f5-b5e1-266356406903.htm">SQLMORERESULTS( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor37"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle5)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle5)" tabindex="0"><img id="sectionToggle5" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Roll-Back Functionality Supported when a SQL Pass-Through Connection Disconnects</span></h1><div id="sectionSection5" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro now supports the <b>DisconnectRollback</b> property for use with the <b>SQLSETPROP( )</b>, <b>SQLGETPROP( )</b>, <b>DBSETPROP( )</b>, and <b>DBGETPROP( )</b> functions. <b>DisconnectRollback</b> is a connection-level property that causes a transaction to be either rolled back or committed when the <b>SQLDISCONNECT( )</b> function is called for the last connection handle associated with the connection.</p>
      <p>The <b>DisconnectRollback</b> property accepts a logical value.  </p>
      <ul><li>
          <p>False (.F.) - (Default) The transaction will be committed when the <b>SQLDISCONNECT( )</b> function is called for the last statement handle associated with the connection.</p>
        </li><li>
          <p>True (.T.) - The transaction is rolled back when the <b>SQLDISCONNECT( )</b> function is called for the last statement handle associated with the connection.</p>
        </li></ul>
      <p>The following example shows the <b>DisconnectRollback</b> property set in the <b>DBSETPROP( )</b> and <b>SQLSETPROP( )</b> functions.</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DBSETPROP("testConnection","CONNECTION","DisconnectRollback",.T.)
SQLSETPROP(con,"DisconnectRollback",.T.)</pre></td></tr></table></span></div>
      <p>For more information, see <b>DisconnectRollback</b> property in <span class="linkTerms"><a href="/html/2b537f41-5c04-41a7-9e8c-eb3513e2c626.htm">SQLSETPROP( ) Function</a></span>. </p>
    </div><a name="foorilanguageenhancementsanchor38"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle6)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle6)" tabindex="0"><img id="sectionToggle6" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SQLIDLEDISCONNECT( ) Temporarily Disconnects SQL Pass-Through Connections</span></h1><div id="sectionSection6" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the new <b>SQLIDLEDISCONNECT( )</b> function to allow a SQL Pass-Through connection to be temporarily disconnected. Use the following syntax.</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SQLIDLEDISCONNECT( nStatementHandle )</pre></td></tr></table></span></div>
      <p>The <span class="parameter">nStatementHandle</span> parameter is set to the statement handle to be disconnected or 0 if all statement handles should be disconnected.</p>
      <p>The <b>SQLIDLEDISCONNECT( )</b> function returns the value 1 if it is successful; otherwise, it returns -1.</p>
      <p>The function fails if the specified statement handle is busy or the connection is in manual commit mode. The <b>AERROR( )</b> function can be used to obtain error information. </p>
      <p>The disconnected connection handle is automatically restored if it is needed for an operation. The original connection data source name is used.</p>
      <p>If a statement handle is temporarily released, the <b>OBDChstmt</b> property returns 0; the <b>OBDChdbc</b> returns 0 if the connection is temporarily disconnected. A shared connection is temporarily disconnected as soon as all of its statement handles are temporarily released.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/b1e092b6-5dab-48d1-a648-1925dba9a013.htm">SQLIDLEDISCONNECT( ) Function</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor7"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle7)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle7)" tabindex="0"><img id="sectionToggle7" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Retrieving Active SQL Connection Statement Handles</span></h1><div id="sectionSection7" class="section" name="collapseableSection" style="display: none;">
      <p>You can retrieve information for all active SQL connection statement handles using the new <b>ASQLHANDLES( )</b> function. <b>ASQLHANDLES( )</b> creates and uses the specified array to store numeric statement handle references that you can use in other Visual FoxPro SQL functions, such as <b>SQLEXEC( )</b> and <b>SQLDISCONNECT( )</b>. <b>ASQLHANDLES( )</b> returns the number of active statement handles in use or zero (0) if none are available. For more information, see <span class="linkTerms"><a href="/html/be41dc1e-ebcc-4871-bd3b-3c92b435f637.htm">ASQLHANDLES( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor32"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle8)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle8)" tabindex="0"><img id="sectionToggle8" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Obtain the ADO Bookmark for the Current Record in an ADO-Based Cursor</span></h1><div id="sectionSection8" class="section" name="collapseableSection" style="display: none;">
      <p>The <span class="parameter">ADOBookmark</span> property is now supported by the <b>CURSORGETPROP( )</b> function. Use this property to obtain the ActiveX® Data Objects (ADO) bookmark for the current record in an ADO-based cursor.</p>
      <p>For more information, see ADOBookmark Property in <span class="linkTerms"><a href="/html/4b2168d1-6e9f-4dc4-aaec-ab25b49383ce.htm">CURSORGETPROP( ) Function</a></span>.</p>
      <p>If a table is not selected and an alias is not specified, Error 52, "No table is open in the current work area," is generated. If the cursor selected is not valid, Error 1467, "Property is invalid for local cursors," is generated.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor11"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle9)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle9)" tabindex="0"><img id="sectionToggle9" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Obtain the Number of Fetched Records</span></h1><div id="sectionSection9" class="section" name="collapseableSection" style="display: none;">
      <p>You can obtain the number of fetched records during SQL Pass-Through execution by using the new <b>RecordsFetched</b> cursor property with the <b>CURSORGETPROP( )</b> function.</p>
      <p>Specifying the <b>RecordsFetched</b> cursor property will return the number of fetched records from an OBDC/ADO-based cursor.</p>
      <p>If records have been deleted or appended locally, the <b>RecordsFetched</b> cursor property may not return the current number of records in the OBDC/ADO-based cursor. In addition, filter conditions are ignored.</p>
      <p>For more information, see RecordsFetched Property in <span class="linkTerms"><a href="/html/4b2168d1-6e9f-4dc4-aaec-ab25b49383ce.htm">CURSORGETPROP( ) Function</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor12"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle10)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle10)" tabindex="0"><img id="sectionToggle10" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Determine if a Fetch is Complete</span></h1><div id="sectionSection10" class="section" name="collapseableSection" style="display: none;">
      <p>You can determine if a fetch process is complete for an OBDC/ADO-based cursor by using the new <b>FetchIsComplete</b> cursor property with the <b>CURSORGETPROP( )</b> function. Read-only at design time and run time.</p>
      <p>This property is not supported on environment level (work area 0) cursors, tables, and local views.</p>
      <p>The <b>FetchIsComplete</b> cursor property returns a logical expression True (.T.) if the fetch process is complete; otherwise False (.F.) is returned.</p>
      <p>For more information, see <b>FetchIsComplete</b> Property in <span class="linkTerms"><a href="/html/4b2168d1-6e9f-4dc4-aaec-ab25b49383ce.htm">CURSORGETPROP( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor58"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle11)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle11)" tabindex="0"><img id="sectionToggle11" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>ISMEMOFETCHED( ) Determines Whether a Memo is Fetched</span></h1><div id="sectionSection11" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the <b>ISMEMOFETCHED( )</b> function to determine whether a <b>Memo</b> field or <b>General</b> field is fetched when you are using delayed memo fetching. For more information about delayed memo fetching, see <span class="linkTerms"><a href="/html/0bfcf4ac-c66d-4085-9740-0fbfe1c74718.htm">Speeding Up Data Retrieval</a></span>.</p>
      <p>The syntax for this function is:</p>
      <p>
        <code>ISMEMOFETCHED(cFieldName | nFieldNumber [, nWorkArea | cTableAlias ])</code>
      </p>
      <p>The <b>ISMEMOFETCHED( )</b> function returns True (.T.) when the Memo field is fetched or if local data is used. <b>ISMEMOFETCHED()</b> returns NULL if the record pointer is positioned at the beginning of the cursor or past the last record. </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/ced130cd-4cf4-4787-b337-18a2214b7ac7.htm">ISMEMOFETCHED( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor42"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle12)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle12)" tabindex="0"><img id="sectionToggle12" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Cancel ADO Fetch</span></h1><div id="sectionSection12" class="section" name="collapseableSection" style="display: none;">
      <p>In Visual FoxPro, you can now cancel a lengthy ADO fetch by pressing the ESC key. </p>
    </div><a name="foorilanguageenhancementsanchor43"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle13)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle13)" tabindex="0"><img id="sectionToggle13" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Long Type Name Support</span></h1><div id="sectionSection13" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro supports using long type names with the following functions, commands, and properties.  </p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/55c599e9-18d1-4ac6-b311-e6677dc3b0b7.htm">CAST( ) Function</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/3c5a454a-67ec-48a8-8290-18dd0e8a97ea.htm">ALTER TABLE - SQL Command</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/203ecbbd-12ae-4caa-94b6-d3077eb685ba.htm">CREATE CURSOR - SQL Command</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/b14e5d95-5b1c-4cfa-a5ac-4093ea6211e0.htm">CREATE TABLE - SQL Command</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/1225275c-e888-49f8-aa8c-ce66673fe761.htm">CREATE FROM Command</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/42160b03-2714-4ca5-abdf-581bd3fc7abe.htm">CursorSchema Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/ededf873-d538-48fa-92bc-4942d740b434.htm">DataType Property</a></span>
          </p>
        </li></ul>
      <p>The following table lists the data types along with their long type names and short type names.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Data Type</b>
              
            </th>
            <th>
              
                <b>Long Type Name</b>
              
            </th>
            <th>
              
                <b>Short Type Name</b>
              
            </th>
          </tr><tr>
          <td>
            <p>Character</p>
          </td>
          <td>
            <p>Char, Character</p>
          </td>
          <td>
            <p>C</p>
          </td>
        </tr><tr>
          <td>
            <p>Date</p>
          </td>
          <td>
            <p>Date</p>
          </td>
          <td>
            <p>D</p>
          </td>
        </tr><tr>
          <td>
            <p>DateTime</p>
          </td>
          <td>
            <p>Datetime</p>
          </td>
          <td>
            <p>T</p>
          </td>
        </tr><tr>
          <td>
            <p>Numeric</p>
          </td>
          <td>
            <p>Num, Numeric</p>
          </td>
          <td>
            <p>N</p>
          </td>
        </tr><tr>
          <td>
            <p>Floating</p>
          </td>
          <td>
            <p>Float</p>
          </td>
          <td>
            <p>F</p>
          </td>
        </tr><tr>
          <td>
            <p>Integer</p>
          </td>
          <td>
            <p>Int, Integer</p>
          </td>
          <td>
            <p>I</p>
          </td>
        </tr><tr>
          <td>
            <p>Double</p>
          </td>
          <td>
            <p>Double</p>
          </td>
          <td>
            <p>B</p>
          </td>
        </tr><tr>
          <td>
            <p>Currency</p>
          </td>
          <td>
            <p>Currency</p>
          </td>
          <td>
            <p>Y</p>
          </td>
        </tr><tr>
          <td>
            <p>Logical</p>
          </td>
          <td>
            <p>Logical</p>
          </td>
          <td>
            <p>L</p>
          </td>
        </tr><tr>
          <td>
            <p>Memo</p>
          </td>
          <td>
            <p>Memo</p>
          </td>
          <td>
            <p>M</p>
          </td>
        </tr><tr>
          <td>
            <p>General</p>
          </td>
          <td>
            <p>General</p>
          </td>
          <td>
            <p>G</p>
          </td>
        </tr><tr>
          <td>
            <p>Picture</p>
          </td>
          <td>
            <p>Picture</p>
          </td>
          <td>
            <p>P</p>
          </td>
        </tr><tr>
          <td>
            <p>Varchar</p>
          </td>
          <td>
            <p>Varchar</p>
          </td>
          <td>
            <p>V</p>
          </td>
        </tr><tr>
          <td>
            <p>Varbinary</p>
          </td>
          <td>
            <p>Varbinary</p>
          </td>
          <td>
            <p>Q</p>
          </td>
        </tr><tr>
          <td>
            <p>Blob</p>
          </td>
          <td>
            <p>Blob</p>
          </td>
          <td>
            <p>W</p>
          </td>
        </tr></table></div>
      <p>Visual FoxPro allows ambiguous long type names to be used with the <b>ALTER TABLE</b>, <b>CREATE CURSOR</b>, <b>CREATE TABLE</b>, and <b>CREATE FROM</b> commands. If the specified long type name is not a recognized long type name, Visual FoxPro will truncate the specified name to the first character. </p>
    </div><a name="fogrfdatafeaturesenhancementsanchor20"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle14)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle14)" tabindex="0"><img id="sectionToggle14" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Transaction Support for Free Tables and Cursors</span></h1><div id="sectionSection14" class="section" name="collapseableSection" style="display: none;">
      <p>In prior versions of Visual FoxPro, transactions using the <span class="linkTerms"><a href="/html/fcc6b075-43b2-45f0-9031-532710b4e8be.htm">BEGIN TRANSACTION Command</a></span> were only supported for local and remote data from databases. Transactions involving free tables and cursors are now supported through use of the MAKETRANSACTABLE( ) and ISTRANSACTABLE( ) functions. For more information, see <span class="linkTerms"><a href="/html/b3b5b00e-5251-4240-b638-49135210915e.htm">MAKETRANSACTABLE( ) Function</a></span> and <span class="linkTerms"><a href="/html/0aa9474f-8376-4ec2-8d0f-46fcdd0b8802.htm">ISTRANSACTABLE( ) Function</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor10"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle15)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle15)" tabindex="0"><img id="sectionToggle15" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Specify a Code Page When Using the CREATE TABLE or CREATE CURSOR Commands</span></h1><div id="sectionSection15" class="section" name="collapseableSection" style="display: none;">
      <p>You can specify a code page by including the <b>CODEPAGE</b> clause with the <b>CREATE CURSOR</b> or <b>CREATE TABLE</b> commands.</p>
      <p>When the <b>CODEPAGE</b> clause is specified, the new table or cursor has a code page specified by <span class="parameter">nCodePage</span>. An error, 1914, "Code page number is invalid", is generated if an invalid code page is specified.</p>
      <p>The following example creates a table and displays its code page:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CREATE TABLE Sales CODEPAGE=1251 (OrderID I, CustID I, OrderAmt Y(4))</pre></td></tr></table></span></div>
      <p>
        <code>? CPDBF( )</code>
      </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/203ecbbd-12ae-4caa-94b6-d3077eb685ba.htm">CREATE CURSOR - SQL Command</a></span>, <span class="linkTerms"><a href="/html/b14e5d95-5b1c-4cfa-a5ac-4093ea6211e0.htm">CREATE TABLE - SQL Command</a></span> and <span class="linkTerms"><a href="/html/a3d7b0e0-8320-44b1-8983-17c30a78c6c4.htm">Code Pages Supported by Visual FoxPro</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor9"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle16)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle16)" tabindex="0"><img id="sectionToggle16" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Convert Character and Memo Data Types Using the ALTER TABLE Command</span></h1><div id="sectionSection16" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro now supports automatic conversion from character data type to memo data type without loss of data when using the <b>ALTER TABLE</b> command along with the <b>ALTER COLUMN</b> clause. This conversion is also supported when making structural changes using the Table Designer. For more information, see <span class="linkTerms"><a href="/html/3c5a454a-67ec-48a8-8290-18dd0e8a97ea.htm">ALTER TABLE - SQL Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor18"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle17)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle17)" tabindex="0"><img id="sectionToggle17" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>BLANK Command Can Initialize Records to Default Value</span></h1><div id="sectionSection17" class="section" name="collapseableSection" style="display: none;">
      <p>You can initialize fields in the current record to their default values as stored in the table's database container (DBC) by using the <b>DEFAULT [AUTOINC]</b> option when clearing the record with the <b>BLANK</b> command. For more information, see <span class="linkTerms"><a href="/html/8b44de23-12a4-4c9c-a95d-202b6bc06352.htm">BLANK Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor20"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle18)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle18)" tabindex="0"><img id="sectionToggle18" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>FLUSH Command Writes Data Explicitly to Disk</span></h1><div id="sectionSection18" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro now includes options and parameters for the <b>FLUSH</b> command and <b>FFLUSH</b> function so you can explicitly save all changes you make to all open tables and indexes. You can also save changes to a specific table by specifying a work area, table alias, or a path and file name. For more information, see <span class="linkTerms"><a href="/html/33f3f0d7-eb55-4dba-b5d7-01bc5f80a9f0.htm">FLUSH Command</a></span> and <span class="linkTerms"><a href="/html/62fd3d5f-884c-42f8-a496-89173e46d2d4.htm">FFLUSH( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor30"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle19)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle19)" tabindex="0"><img id="sectionToggle19" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Populate an Array with Aliases Used by a Specified Table</span></h1><div id="sectionSection19" class="section" name="collapseableSection" style="display: none;">
      <p>The new <span class="parameter">cTableName</span> parameter for the <b>AUSED( )</b> function makes it possible to filter the created array to contain only the aliases being used for a specified table. </p>
      <p>
        <code>AUSED(ArrayName [, nDataSessionNumber [, cTableName ]])</code>
      </p>
      <p>The <span class="parameter">cTableName</span> parameter accepts the following formats to specify a table, from highest to lowest in priority.</p>
      <ul><li>
          <p>DatabaseName!TableName or DatabaseName!ViewName</p>
        </li><li>
          <p>Path\DatabaseName!TableName or Path\DatabaseName!ViewName</p>
        </li><li>
          <p>DBC-defined table name or view in the current DBC in the current data session</p>
        </li><li>
          <p>Simple or full file name </p>
        </li></ul>
      <p>For more information, see <span class="linkTerms"><a href="/html/c767119d-d65a-4e94-a842-c5e8db912095.htm">AUSED( ) Function</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor21"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle20)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle20)" tabindex="0"><img id="sectionToggle20" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Obtain Last Auto-Increment Value with GETAUTOINCVALUE( )</span></h1><div id="sectionSection20" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the new GETAUTOINCVALUE( ) function to return the last value generated for an autoincremented field within a data session. For more information, see <span class="linkTerms"><a href="/html/b36c3298-c7a3-46a0-9b47-85dca36b98a8.htm">GETAUTOINCVALUE( ) Function</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor22"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle21)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle21)" tabindex="0"><img id="sectionToggle21" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET TABLEPROMPT Controls Prompt to Select Table</span></h1><div id="sectionSection21" class="section" name="collapseableSection" style="display: none;">
      <p>The new SET TABLEPROMPT command controls whether Visual FoxPro prompts the user with the <span class="linkTerms"><a href="/html/a4095b85-c7a7-485a-a9d9-6fec4840e637.htm">Open Dialog Box (Visual FoxPro)</a></span> to select a table when one specified cannot be found, such as in <span class="linkTerms"><a href="/html/815f7265-4dfd-40b9-8f19-0673b5a48847.htm">SELECT - SQL Command</a></span>. For more information, see <span class="linkTerms"><a href="/html/5e0472d9-46d2-471a-9740-7ee5702ee82a.htm">SET TABLEPROMPT Command</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor23"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle22)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle22)" tabindex="0"><img id="sectionToggle22" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Use SET VARCHARMAPPING to Control Query Result Set Mappings</span></h1><div id="sectionSection22" class="section" name="collapseableSection" style="display: none;">
      <p>For queries such as <span class="linkTerms"><a href="/html/815f7265-4dfd-40b9-8f19-0673b5a48847.htm">SELECT - SQL Command</a></span>, character data is often manipulated using Visual FoxPro functions and expressions. Since the length of the resulting field value may be important for certain application uses, it is valuable to have this <b>Character</b> data mapped to <b>Varchar</b> data in the result set. The SET VARCHARMAPPING command controls whether Character data is mapped to a Character or Varchar data type. For more information, see <span class="linkTerms"><a href="/html/5c5cda35-c999-4084-aee6-6576b10e0bb2.htm">SET VARCHARMAPPING Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor15"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle23)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle23)" tabindex="0"><img id="sectionToggle23" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET TABLEVALIDATE Expanded</span></h1><div id="sectionSection23" class="section" name="collapseableSection" style="display: none;">
      <p>When a table header is locked during validation, attempts to open the table, for example, with the <b>USE</b> command, generate the message "File is in use (Error 3)." If the table header cannot be locked for a table open operation, you can suppress this message by setting the third bit for the <b>SET TABLEVALIDATE</b> command. You must also set the first bit to validate the record count when the table opens. Therefore, you need to set the <b>SET TABLEVALIDATE</b> command to a value of 5. Also, a fourth bit option (value of 8) is available for Insert operations which checks the table header before the appended record is saved to disk and the table header is modified.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/6fe92268-f8ce-4603-9e7a-6f4ca4cfdfc9.htm">SET TABLEVALIDATE Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor19"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle24)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle24)" tabindex="0"><img id="sectionToggle24" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET REFRESH Can Specify Faster Refresh Rates</span></h1><div id="sectionSection24" class="section" name="collapseableSection" style="display: none;">
      <p>You can specify fractions of a second for the <span class="parameter">nSeconds2</span> parameter to a minimum of 0.001 seconds. You can also specify the following values for the optional second parameter:</p>
      <ul><li>
          <p>-1 - Always read data from a disk.</p>
        </li><li>
          <p>0 - Always use data in memory buffer but do not refresh buffer.</p>
        </li></ul>
      <p>The <b>Table refresh interval</b> check box on the <b>Data</b> tab of the <b>Options</b> dialog box now also accepts fractional values.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/f90c43b8-a72d-40ed-8832-85eb7e07dd9b.htm">SET REFRESH Command</a></span> and <span class="linkTerms"><a href="/html/a3a5e840-ab92-4925-8425-c6df294d2794.htm">Data Tab, Options Dialog Box</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor33"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle25)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle25)" tabindex="0"><img id="sectionToggle25" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET REFRESH Can Differentiate Values for Each Cursor</span></h1><div id="sectionSection25" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the new <b>Refresh</b> property with the <b>CURSORGETPROP( )</b> function to differentiate the <b>SET REFRESH</b> values for individual cursors. The default setting is -2, which is a global value. This value is not available with the <b>SET REFRESH</b> command.</p>
      <p>The <b>Refresh</b> property is available at the Data Session and Cursor level. The default setting for a Data Session level is -2 and the default value for a Cursor level is the current session's level setting. If the global level setting is set to 0, the Cursor level setting is ignored.</p>
      <p>If a table is not currently selected and an alias is not specified, Error 52, "No table is open in the current work area," is generated.</p>
      <p>For more information, see Refresh Property in <span class="linkTerms"><a href="/html/4b2168d1-6e9f-4dc4-aaec-ab25b49383ce.htm">CURSORGETPROP( ) Function</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor44"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle26)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle26)" tabindex="0"><img id="sectionToggle26" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>SET( ) Determines SET REPROCESS Command Settings</span></h1><div id="sectionSection26" class="section" name="collapseableSection" style="display: none;">
      <p>You can now use the following syntax with the <b>SET( )</b> function to determine how the <b>SET REPROCESS</b> command was declared.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>SET Command</b>
              
            </th>
            <th>
              
                <b>Value Returned</b>
              
            </th>
          </tr><tr>
          <td>
            <p>REPROCESS, 2</p>
          </td>
          <td>
            <p>Current session setting type (0 - attempts, 1 - seconds)</p>
          </td>
        </tr><tr>
          <td>
            <p>REPROCESS, 3</p>
          </td>
          <td>
            <p>System session setting type (0 - attempts, 1 - seconds)</p>
          </td>
        </tr></table></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/50426562-080d-465c-94a9-e524ec4ee777.htm">SET( ) Function</a></span> and <span class="linkTerms"><a href="/html/cc56eb65-6621-4d12-8192-ca38042d16a5.htm">SET REPROCESS Command</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor39"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle27)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle27)" tabindex="0"><img id="sectionToggle27" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Log Output from SYS(3054) Using SYS(3092)</span></h1><div id="sectionSection27" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the new <b>SYS(3092)</b> function in conjunction with <b>SYS(3054)</b> to record the resulting output to a file.</p>
      <p>
        <code>SYS( 3092 [, cFileName [, lAdditive ]])</code>
      </p>
      <p>The <span class="parameter">cFileName</span> parameter specifies the file to echo the <b>SYS(3054)</b> output to. Sending an empty string to <span class="parameter">cFileName</span> will deactivate output recording to the file.</p>
      <p>The default value for <span class="parameter">lAdditive</span> is False (.F.). This specifies that new output will overwrite the previous contents of the specified file. To append new output to the specified file, set <span class="parameter">lAdditive</span> to True (.T.).</p>
      <p>
        <b>SYS(3092)</b> returns the name of the current echo file if it is active; otherwise, it returns an empty string.</p>
      <p>
        <b>SYS(3054)</b> and <b>SYS(3092)</b> are global settings — in a multithreaded runtime they are scoped to a thread. Each function can be changed independently from each other. </p>
      <p>These functions are not available in the Visual FoxPro OLE DB Provider.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/400a0198-cac5-4abd-8e2d-79564a75742d.htm">SYS(3054) - Rushmore Query Optimization Level</a></span> and <span class="linkTerms"><a href="/html/0e272bbc-0d4d-4315-98a1-f9d01733baab.htm">SYS(3092) - Output Rushmore Query Optimization Level</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor24"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle28)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle28)" tabindex="0"><img id="sectionToggle28" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Purge Cached Memory for Specific Work Area Using SYS(1104)</span></h1><div id="sectionSection28" class="section" name="collapseableSection" style="display: none;">
      <p>You can optionally specify the alias or work area of a specified table or cursor for which cached memory is purged. For more information, see <span class="linkTerms"><a href="/html/2f0d4804-793f-4544-9d31-f8ecd6c9b5aa.htm">SYS(1104) - Purge Memory Cache</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor25"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle29)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle29)" tabindex="0"><img id="sectionToggle29" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>New Table Types for SYS(2029)</span></h1><div id="sectionSection29" class="section" name="collapseableSection" style="display: none;">
      <p>The SYS(2029) function returns new values for tables that contain <b>Autoinc</b>, <b>Varchar</b>, <b>Varbinary</b> or <b>Blob</b> fields. For more information, see <span class="linkTerms"><a href="/html/b9d6cff8-7cd0-45e9-b564-6a53701d27b4.htm">SYS(2029) - Table Type</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor26"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle30)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle30)" tabindex="0"><img id="sectionToggle30" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Map Remote Unicode Data to ANSI Using SYS(987)</span></h1><div id="sectionSection30" class="section" name="collapseableSection" style="display: none;">
      <p>Use SYS(987) to map remote Unicode data retrieved through SQL pass-through or remote views to ANSI. This function can be used to retrieve remote <b>Varchar</b> data as ANSI for use with <b>Memo</b> fields. This setting is a global setting across all data sessions so should be used with care. For more information, see <span class="linkTerms"><a href="/html/d62bbae2-acb6-4d2c-a5ec-abf1a545db6e.htm">SYS(987) - Map Remote Data to ANSI</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor40"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle31)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle31)" tabindex="0"><img id="sectionToggle31" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Memo and Field tips in a BROWSE or Grid</span></h1><div id="sectionSection31" class="section" name="collapseableSection" style="display: none;">
      <p>When the mouse pointer is positioned over a <b>Memo</b> field cell in a <b>Browse</b> window or <b>Grid</b> control, a Memo Tip window displays the contents of the Memo field.</p>
      <p>For other field types, positioning the mouse pointer over the field displays the field contents in a <b>Field Tip</b> window when the field is sized smaller than its contents.</p>
      <p>Memo Tip windows display no more than 4 kilobytes of text, and are not displayed for binary data. A Memo Tip window is displayed until the mouse pointer is moved from the <b>Memo</b> field. The <span class="linkTerms"><a href="/html/59928880-1ee3-45d6-8d01-34dda1f01ae9.htm">_TOOLTIPTIMEOUT System Variable</a></span> determines how long a Field Tip window is displayed.</p>
      <p>You can disable Memo Tips by setting the _SCREEN <span class="linkTerms"><a href="/html/7607750c-5cb0-4b9b-96b8-ffbf8887a253.htm">ShowTips Property</a></span> to False (.F.).</p>
      <p>Memo and Field Tips will also be displayed for Grid controls if both _SCREEN and the form's <b>ShowTips</b> property are set to True (.T.). Additionally, the <span class="linkTerms"><a href="/html/9d437667-66ed-40ef-b324-eb5852ffb086.htm">ToolTipText Property</a></span> for the field's grid column <b>Textbox</b> control must contain an empty string.</p>
    </div><a name="foorilanguageenhancementsanchor51"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle32)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle32)" tabindex="0"><img id="sectionToggle32" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Specify Code Pages</span></h1><div id="sectionSection32" class="section" name="collapseableSection" style="display: none;">
      <p>You can specify the code page used to decode data when XML is being parsed and to encode data when UTF-8 encoded XML is generated. The following language changes are available:</p>
      <ul><li>
          <p>
            <span class="parameter">nCodePage</span> Parameter</p>
          <p>To specify code pages, you can use the <span class="parameter">nCodePage</span> parameter for the following <b>XMLToTable</b> methods:</p>
          <ul><li>
              <p>
                <span class="linkTerms"><a href="/html/d933f759-0e84-4dc8-a015-f3218b4eb097.htm">ToCursor Method</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/ab11d879-cca7-4d4e-bb73-ab5dc3b1d6dd.htm">ChangesToCursor Method</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/aa802a1e-03f3-42ff-bc97-8e2e8cd61ce2.htm">ApplyDiffgram Method</a></span>
              </p>
            </li></ul>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>XMLTable.ToCursor ( [ lAppend [, cAlias [, nCodePage ]]] )
XMLTable.ChangesToCursor( [ cAlias [, lIncludeUnchangedData [, nCodePage ]]] )
XMLTable.ApplyDiffgram( [ cAlias [, oCursorAdapter [, lPreserveChanges [, nCodePage ]]]] )</pre></td></tr></table></span></div>
        </li><li>
          <p>
            <b>CodePage</b> and <b>UseCodePage</b> Properties</p>
          <p>Use the <span class="linkTerms"><a href="/html/e4041fb5-2cf7-4296-9d1b-df513a833461.htm">CodePage Property</a></span> and <span class="linkTerms"><a href="/html/007c38c8-7a1d-4487-99b8-c024276e3c27.htm">UseCodePage Property</a></span> to specify code pages when you use the following classes:</p>
          <ul><li>
              <p>
                <span class="linkTerms"><a href="/html/0e51628a-7e55-4025-8e92-cc1b6edee2fc.htm">XMLAdapter Class</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/1270863b-32b1-4bbc-a9c2-175a07db9c3b.htm">XMLTable Class</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/62180c49-1670-4df3-8cb6-62847cbc1813.htm">XMLField Class</a></span>
              </p>
            </li></ul>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>XMLAdapter.CodePage = nValue
XMLTable.CodePage = nValue
XMLField.CodePage = nValue</pre></td></tr></table></span></div>
        </li><li>
          <p>Flag 32768</p>
          <p>The flag 32768 is available for the following functions and class:</p>
          <ul><li>
              <p>
                <span class="linkTerms"><a href="/html/3cd87ac7-582c-43b9-b1f7-006a9a5c7508.htm">CursorAdapter Class</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/887e0f56-7ff2-4877-89ff-9bbccde7f2d6.htm">XMLTOCURSOR( ) Function</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/b53b14fa-c1b0-4c29-82b1-3149adf53073.htm">CURSORTOXML( ) Function</a></span>
              </p>
            </li><li>
              <p>
                <span class="linkTerms"><a href="/html/646e7dbb-d5e9-4017-b8a2-cb3625a818cb.htm">XMLUPDATEGRAM( ) Function</a></span>
              </p>
            </li></ul>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CursorAdaptor.Flags = nCodePage
XMLTOCURSOR( eExpression | cXMLFile [, cCursorName [, nFlags ]])
CURSORTOXML(nWorkArea | cTableAlias, cOutput [, nOutputFormat [, nFlags [, nRecords [, cSchemaName [, cSchemaLocation [, cNameSpace ]]]]]])
XMLUPDATEGRAM( [ cAliasList [, nFlags [, cSchemaLocation]]])</pre></td></tr></table></span></div>
          <p>The <span class="parameter">nCodePage</span> parameter must match a recognized Visual FoxPro code page. </p>
        </li></ul>
      <p>For more information, see <span class="linkTerms"><a href="/html/a3d7b0e0-8320-44b1-8983-17c30a78c6c4.htm">Code Pages Supported by Visual FoxPro</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor52"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle33)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle33)" tabindex="0"><img id="sectionToggle33" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>MapVarchar Property Maps to Varchar, Varbinary, and Blob Data Types</span></h1><div id="sectionSection33" class="section" name="collapseableSection" style="display: none;">
      <p>For <b>CursorAdapter</b> and <b>XMLAdapter</b> classes, you can use the <b>MapVarchar</b> property to map to <b>Varchar</b> data types. To map to <b>Varbinary</b> and <b>Blob</b> data types, you can use the <b>MapBinary</b> property.</p>
      <p>The <span class="linkTerms"><a href="/html/887e0f56-7ff2-4877-89ff-9bbccde7f2d6.htm">XMLTOCURSOR( ) Function</a></span> contains several new flags to support mapping of Char and base64Binary XML field types to new Fox data types.</p>
      <p>For more information, see the <span class="linkTerms"><a href="/html/40d72380-f51b-4218-b384-b9509ab903ae.htm">MapVarchar Property</a></span> and <span class="linkTerms"><a href="/html/7154a4a9-7cf9-4175-b5da-215947882fa5.htm">MapBinary Property</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor6"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle34)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle34)" tabindex="0"><img id="sectionToggle34" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Handling Conflict Checks with Properties for CursorAdapter Class</span></h1><div id="sectionSection34" class="section" name="collapseableSection" style="display: none;">
      <p>You can better handle conflicts when performing update and delete operations using the commands specified by the <b>UpdateCmd</b> and <b>DeleteCmd</b> properties for <b>CursorAdapter</b> objects by using the new <b>ConflictCheckType</b> and <b>ConflictCheckCmd</b> properties for <b>CursorAdapter</b> objects.</p>
      <p>You can use <b>ConflictCheckType</b> to specify how to handle a conflict check during an update or delete operation. When <b>ConflictCheckType</b> is set to 4, you can use <b>ConflictCheckCmd</b> to specify a custom command to append to the end of the commands in the <b>UpdateCmd</b> and <b>DeleteCmd</b> properties.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>Visual FoxPro 8.0 Service Pack 1 includes the <b>ConflictCheckType</b> and <b>ConflictCheckCmd</b> properties.</p>
      </td></tr></table></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/5ed33f2e-0853-4e59-9474-52d8f22709dc.htm">ConflictCheckType Property</a></span> and <span class="linkTerms"><a href="/html/3a6932ec-91ad-4911-8536-abcf43abe616.htm">ConflictCheckCmd Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor60"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle35)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle35)" tabindex="0"><img id="sectionToggle35" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Improved DataEnvironment Handling with UseCursorSchema and NoData Properties</span></h1><div id="sectionSection35" class="section" name="collapseableSection" style="display: none;">
      <p>You can specify default settings for <span class="linkTerms"><a href="/html/705fae89-41a2-4c08-bdae-1e761c710414.htm">CursorFill Method</a></span> calls made without the first two parameters by setting these properties. For more information, see <span class="linkTerms"><a href="/html/e04ec561-c96e-4850-9cf5-bf0d82ec85ea.htm">UseCursorSchema Property</a></span> and <span class="linkTerms"><a href="/html/bc7e26d5-f796-4e5f-aa75-734318474439.htm">NoData Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor61"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle36)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle36)" tabindex="0"><img id="sectionToggle36" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Timestamp Field Support</span></h1><div id="sectionSection36" class="section" name="collapseableSection" style="display: none;">
      <p>The new <b>TimestampFieldList</b> property lets you specify a list of timestamp fields for the cursor created by the <b>CursorAdapter</b>. For more information see <span class="linkTerms"><a href="/html/e11237f3-a7d8-4136-beda-002127ae330a.htm">TimestampFieldList Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor62"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle37)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle37)" tabindex="0"><img id="sectionToggle37" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Auto-Refresh Support</span></h1><div id="sectionSection37" class="section" name="collapseableSection" style="display: none;">
      <p>There are a number of scenarios where you might want to have cursor data refreshed from a remote data source after an Insert/Update operation has occurred. These include following scenarios:</p>
      <ul><li>
          <p>A table has an auto-increment field that also acts as a primary key.</p>
        </li><li>
          <p>A table has a timestamp field, and that field must be refreshed from the database after each Insert/Update in order to allow successful subsequent updates to the record when WhereType=4 (key and timestamp).</p>
        </li><li>
          <p>A table contains some fields which have DEFAULT values or triggers defined that will cause changes to occur.</p>
        </li></ul>
      <p>The following new properties have been added to the <b>CursorAdapter</b> class for Auto-Refresh support:</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Property</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>InsertCmdRefreshFieldList</p>
          </td>
          <td>
            <p>List of fields to refresh after Insert command executes.</p>
          </td>
        </tr><tr>
          <td>
            <p>InsertCmdRefreshCmd</p>
          </td>
          <td>
            <p>Specifies the command to refresh the record after Insert command executes.</p>
          </td>
        </tr><tr>
          <td>
            <p>InsertCmdRefreshKeyFieldList</p>
          </td>
          <td>
            <p>List of key fields to refresh in record after Insert command executes.</p>
          </td>
        </tr><tr>
          <td>
            <p>UpdateCmdRefreshFieldList</p>
          </td>
          <td>
            <p>List of fields to refresh after Update command executes.</p>
          </td>
        </tr><tr>
          <td>
            <p>UpdateCmdRefreshCmd</p>
          </td>
          <td>
            <p>Specifies the command to refresh the record after Update command executes.</p>
          </td>
        </tr><tr>
          <td>
            <p>UpdateCmdRefreshKeyFieldList</p>
          </td>
          <td>
            <p>List of key fields to refresh the record after Update command executes.</p>
          </td>
        </tr><tr>
          <td>
            <p>RefreshTimestamp</p>
          </td>
          <td>
            <p>Enables automatic refresh for fields in TimestampFieldList during Insert/Update.</p>
          </td>
        </tr></table></div>
      <p>For more information about how Visual FoxPro updates remote data using a CursorAdapter, see <span class="linkTerms"><a href="/html/5bf4efc5-39e7-4fc9-b785-876d4315486f.htm">Data Access Management Using CursorAdapters</a></span>. Also, see <span class="linkTerms"><a href="/html/2897638b-b280-4066-a51c-50fce7ae87e5.htm">InsertCmdRefreshCmd Property</a></span>, <span class="linkTerms"><a href="/html/390f2973-fe6d-4e22-9608-b58d7c1e9223.htm">InsertCmdRefreshFieldList Property</a></span>, <span class="linkTerms"><a href="/html/74827ff2-0c4a-4daa-a3ba-e39a1b6ea022.htm">InsertCmdRefreshKeyFieldList Property</a></span>, <span class="linkTerms"><a href="/html/8e29196c-b1c2-44e5-ace7-87dde37d1c29.htm">UpdateCmdRefreshCmd Property</a></span>, <span class="linkTerms"><a href="/html/42a3740b-e8b8-4246-913f-3b20075ff464.htm">UpdateCmdRefreshFieldList Property</a></span>, <span class="linkTerms"><a href="/html/f81d6ad8-6cfd-456b-82e8-a3a3d53ff599.htm">UpdateCmdRefreshKeyFieldList Property</a></span> and <span class="linkTerms"><a href="/html/39b3d61e-3ac8-41fb-926f-88aa82d9cd59.htm">RefreshTimeStamp Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor63"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle38)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle38)" tabindex="0"><img id="sectionToggle38" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>On Demand Record Refresh</span></h1><div id="sectionSection38" class="section" name="collapseableSection" style="display: none;">
      <p>In Visual FoxPro 8.0, the <span class="linkTerms"><a href="/html/9b41a875-0c45-4931-bbb2-3856b72efe93.htm">REFRESH( ) Function</a></span> provides on demand record refresh functionality for local and remote views, however, it does not support this for the <b>CursorAdapter</b>. Visual FoxPro 9.0 extends REFRESH( ) support to the <b>CursorAdapter</b> and provides some additional capabilities:</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Member</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>RecordRefresh method</p>
          </td>
          <td>
            <p>Refreshes the current field values for the target records. Use the CURVAL( ) Function to determine current field values.</p>
          </td>
        </tr><tr>
          <td>
            <p>BeforeRecordRefresh event</p>
          </td>
          <td>
            <p>Occurs immediately before the RecordRefresh method is executed.</p>
          </td>
        </tr><tr>
          <td>
            <p>AfterRecordRefresh event</p>
          </td>
          <td>
            <p>Occurs after the RecordRefresh method is executed.</p>
          </td>
        </tr><tr>
          <td>
            <p>RefreshCmdDataSourceType property</p>
          </td>
          <td>
            <p>Specifies the data source type to be used for the RecordRefresh method.</p>
          </td>
        </tr><tr>
          <td>
            <p>RefreshCmdDataSource property</p>
          </td>
          <td>
            <p>Specifies the data source to be used for the RecordRefresh method.</p>
          </td>
        </tr><tr>
          <td>
            <p>RefreshIgnoreFieldList property</p>
          </td>
          <td>
            <p>List of fields to ignore during RecordRefresh operation</p>
          </td>
        </tr><tr>
          <td>
            <p>RefreshCmd property</p>
          </td>
          <td>
            <p>Specifies the command to refresh rows when RecordRefresh is executed.</p>
          </td>
        </tr><tr>
          <td>
            <p>RefreshAlias property</p>
          </td>
          <td>
            <p>Specifies the alias of read-only cursor used as a target for the refresh operation.</p>
          </td>
        </tr></table></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/1d946b40-6476-447d-907e-ccd15fb51e88.htm">RecordRefresh Method</a></span>, <span class="linkTerms"><a href="/html/4ba816cd-a999-4942-afcb-e11d0489aebf.htm">BeforeRecordRefresh Event</a></span>, <span class="linkTerms"><a href="/html/66365154-de27-46a9-9ee7-4855426fe1f6.htm">AfterRecordRefresh Event</a></span>, <span class="linkTerms"><a href="/html/41fed631-5232-4629-a82f-2f8b9114f7a8.htm">RefreshCmdDataSourceType Property</a></span>, <span class="linkTerms"><a href="/html/701b6388-522a-4e85-bd6a-1c2eabc96aed.htm">RefreshCmdDataSource Property</a></span>, <span class="linkTerms"><a href="/html/be9ae9b9-c703-47d2-94eb-3a2c0ecf3691.htm">RefreshIgnoreFieldList Property</a></span>, <span class="linkTerms"><a href="/html/2c27a9f8-7719-48b1-a1e9-e4126dd2df31.htm">RefreshCmd Property</a></span> and <span class="linkTerms"><a href="/html/67a2b3a2-53b2-44dc-adc4-528ee5dbcb34.htm">RefreshAlias Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor64"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle39)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle39)" tabindex="0"><img id="sectionToggle39" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Delayed Memo Fetch</span></h1><div id="sectionSection39" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>CursorAdapter</b> class has a <span class="linkTerms"><a href="/html/9261def0-7448-4db2-9ed7-fec6b7d70755.htm">FetchMemo Property</a></span>, which when set to False (.F.) in Visual FoxPro 9.0 places the cursor in Delayed Memo Fetch mode similar to Remote Views. Delayed Memo Fetch Mode prevents the contents of Memo fields from being fetched using <span class="linkTerms"><a href="/html/705fae89-41a2-4c08-bdae-1e761c710414.htm">CursorFill Method</a></span> or <span class="linkTerms"><a href="/html/dc4239f5-88f5-42c7-bdca-b1d12217da78.htm">CursorRefresh Method</a></span>. An attempt to fetch content for a <b>Memo</b> field is done when the application attempts to access the value. The following <b>CursorAdapter</b> enhancements provide support for Delayed Memo Fetch:</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Member</b>
              
            </th>
            <th>
              
                <b>Description</b>
              
            </th>
          </tr><tr>
          <td>
            <p>DelayedMemoFetch method</p>
          </td>
          <td>
            <p>Performs a delayed Memo field fetch for a target record in a cursor in a CursorAdapter object.</p>
          </td>
        </tr><tr>
          <td>
            <p>FetchMemoDataSourceType property</p>
          </td>
          <td>
            <p>Specifies the data source type used for the DelayedMemoFetch method.</p>
          </td>
        </tr><tr>
          <td>
            <p>FetchMemoDataSource property</p>
          </td>
          <td>
            <p>Specifies the data source used for the DelayedMemoFetch method.</p>
          </td>
        </tr><tr>
          <td>
            <p>FetchMemoCmdList property</p>
          </td>
          <td>
            <p>Specifies a list of Memo field names and their associated fetch commands.</p>
          </td>
        </tr></table></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/3835283a-3f5e-4255-b174-4889828c1884.htm">DelayedMemoFetch Method</a></span>, <span class="linkTerms"><a href="/html/8c60bad4-8801-4292-a485-5b062ec44fe2.htm">FetchMemoDataSourceType Property</a></span>, <span class="linkTerms"><a href="/html/b4c7f6f8-833d-4818-99d9-ac258e722942.htm">FetchMemoDataSource Property</a></span> and <span class="linkTerms"><a href="/html/97dbf24f-4af0-4a18-a6a4-c5b8db7f729e.htm">FetchMemoCmdList Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor65"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle40)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle40)" tabindex="0"><img id="sectionToggle40" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>UseTransactions Property</span></h1><div id="sectionSection40" class="section" name="collapseableSection" style="display: none;">
      <p>The new <b>UseTransactions</b> property specifies whether the <b>CursorAdapter</b> should use transactions when sending Insert, Update or Delete commands through ADO or ODBC. For more information, see <span class="linkTerms"><a href="/html/17f92659-05d5-4877-ab43-b6151a0e35c1.htm">UseTransactions Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor67"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle41)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle41)" tabindex="0"><img id="sectionToggle41" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>DEFAULT and CHECK Constraints Respected</span></h1><div id="sectionSection41" class="section" name="collapseableSection" style="display: none;">
      <p>In Visual FoxPro 9.0, DEFAULT values and table and field level CHECK constraints are supported for XML, Native, ADO and ODBC data sources. In Visual FoxPro 8.0, DEFAULT values and table and field level CHECK constraints are only supported for an XML data source. For the DEFAULT values and CHECK constraints to be applied to a cursor, call the <span class="linkTerms"><a href="/html/705fae89-41a2-4c08-bdae-1e761c710414.htm">CursorFill Method</a></span> with the <span class="parameter">lUseSchema</span> parameter set to True (.T.). For more information, see <span class="linkTerms"><a href="/html/42160b03-2714-4ca5-abdf-581bd3fc7abe.htm">CursorSchema Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor66"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle42)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle42)" tabindex="0"><img id="sectionToggle42" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remote Data Type Conversion for Logical Data</span></h1><div id="sectionSection42" class="section" name="collapseableSection" style="display: none;">
      <p>When you move data between a remote server and Visual FoxPro, Visual FoxPro uses ODBC or ADO data types to map remote data types to local Visual FoxPro data types. In Visual FoxPro 9.0, certain ODBC and ADO data types can now be mapped to a logical data type in remote views and the <b>CursorAdapter</b> object. For more information, see <span class="linkTerms"><a href="/html/c101845f-d0a1-4f86-b1ba-225929032da6.htm">Data Type Conversion Control</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor68"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle43)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle43)" tabindex="0"><img id="sectionToggle43" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>ADOCodePage Property</span></h1><div id="sectionSection43" class="section" name="collapseableSection" style="display: none;">
      <p>When working with an ADO data source for your <b>CursorAdapter</b>, you may want to specify a code page to use for character data translation. The new <b>ADOCodePage</b> property allows you to specify this code page. For more information, see <span class="linkTerms"><a href="/html/ab30de57-8184-4b73-84e1-7095c779855d.htm">ADOCodePage Property</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor50"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle44)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle44)" tabindex="0"><img id="sectionToggle44" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Read and Write Nested XML Documents</span></h1><div id="sectionSection44" class="section" name="collapseableSection" style="display: none;">
      <p>You can read to and write from your relational database into XML documents using nesting to handle the relationships between tables. You accomplish this using the <span class="linkTerms"><a href="/html/54a6718a-37b5-4099-89a8-8f7cde48167b.htm">RespectNesting Property</a></span> of the <b>XMLAdapter</b> class. The <b>XMLTable</b> class has the <span class="linkTerms"><a href="/html/3f87fa56-16c6-476e-a8fe-949186eddcb2.htm">Nest Method</a></span>, <span class="linkTerms"><a href="/html/f2c27a20-dfc1-4473-b9ac-a37e684e1b24.htm">Unnest Method</a></span> and the following properties to handle nesting.</p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/3c2b9594-fb87-4758-9932-827099198cff.htm">FirstNestedTable Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/5a122c9d-ccb0-408e-9c58-b32c59346318.htm">NestedInto Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/bc74d83f-6644-4805-982a-b04d827bcb83.htm">NextSiblingTable Property</a></span>
          </p>
        </li></ul>
      <p>For more information, see the <span class="linkTerms"><a href="/html/0e51628a-7e55-4025-8e92-cc1b6edee2fc.htm">XMLAdapter Class</a></span> and the <span class="linkTerms"><a href="/html/1270863b-32b1-4bbc-a9c2-175a07db9c3b.htm">XMLTable Class</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor53"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle45)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle45)" tabindex="0"><img id="sectionToggle45" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>LoadXML Method Can Accept Any XML Document</span></h1><div id="sectionSection45" class="section" name="collapseableSection" style="display: none;">
      <p>The <b>LoadXML</b> method accepts any XML document with a valid schema. Previously, the method required that the schema follow the format of a Visual Studio generated dataset. When you use the LoadXML method to read an XML document with a schema different from a Visual Studio generated dataset, the properties for the <b>XMLAdapter</b>, <b>XMLName</b>, and <b>XMLPrefix</b> properties are set to empty (""). The <b>XMLAdapter</b> <b>XMLNamespace</b> property becomes equal to the target <b>Namespace</b> attribute value for the schema node and each XML element becomes a complexType and is mapped to an <b>XMLTable</b> object. The <b>XMLNamespace</b> property is set to <b>namespaceURI</b> for the element.</p>
      <p>If you set the <b>XMLAdapter</b> <b>RespectNesting</b> property to True (.T.), the top level element declaration is ignored if it is referenced from some other complex element. For that case, the <b>XMLTable</b> object for the referenced element is nested into the <b>XMLTable</b> for the element that references it.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/951acf37-9025-495e-8390-b97a07378937.htm">LoadXML Method</a></span>.</p>
    </div><a name="foorilanguageenhancementsanchor54"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle46)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle46)" tabindex="0"><img id="sectionToggle46" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>XPath Expressions Can Access Complex XML Documents</span></h1><div id="sectionSection46" class="section" name="collapseableSection" style="display: none;">
      <p>You can use <b>XPath</b> expressions to access complex XML documents and the new properties for reading the nodes within the document. For example, you might want to filter record nodes, restore relationships based on foreign key fields, use an element's text as data for a field, or access XML that uses multiple XML namespaces. The following properties provide you with the ability to read the XML at the <b>XMLAdapter</b> level, <b>XMLTable</b> level, or the <b>XMLField</b> level.</p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/1614c2e4-cf40-45b5-a781-9960d9ba758f.htm">DeclareXMLPrefix Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/7d57fc1c-a0ff-4c25-bf27-663decf34191.htm">SelectionNamespaces Property</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/d58c661c-022c-4532-b09c-2d8c7135cbfb.htm">XMLNameIsXPath Property</a></span>
          </p>
        </li></ul>
      <p>You can use the following table to determine the node within the XML document that you want to start reading.</p>
      <p>For example, if you use an <b>XPath</b> expression in the <b>XMLName</b> property for an <b>XMLAdapter</b>, reading begins at the first node</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>To read</b>
              
            </th>
            <th>
              
                <b>Class</b>
              
            </th>
            <th>
              
                <b>Context node</b>
              
            </th>
          </tr><tr>
          <td>
            <p>From the first found XML node:</p>
          </td>
          <td>
            <p>
              <b>XMLAdapter</b>
            </p>
          </td>
          <td>
            <p>
              <b>IXMLDOMElement</b> property</p>
          </td>
        </tr><tr>
          <td>
            <p>All found XML nodes and use each node as a single record:</p>
          </td>
          <td>
            <p>
              <b>XMLTable</b>
            </p>
          </td>
          <td>
            <p>
              <b>XMLAdapter</b> object</p>
          </td>
        </tr><tr>
          <td>
            <p>The first found XML node and use its text as a field value:</p>
          </td>
          <td>
            <p>
              <b>XMLField</b>
            </p>
          </td>
          <td>
            <p>
              <b>XMLTable</b> object</p>
          </td>
        </tr></table></div>
      <p>The following methods do not support the use of XPath expressions in the <b>XMLName</b> property:</p>
      <ul><li>
          <p>The <b>ApplyDiffgram</b> and <b>ChangesToCursor</b> methods do not support XPath expressions for <b>XMLAdapter</b> and <b>XMLTable</b> objects.</p>
        </li><li>
          <p>The <b>ToCursor</b> method does not support an XPath expression for <b>XMLAdapter</b> when the <b>IsDiffgram</b> property is set to True (.T.).</p>
        </li><li>
          <p>The <b>ToXML</b> method does not support XPath expressions for <b>XMLAdapter</b> and <b>XMLTable</b> objects and ignores <b>XMLField</b> objects that use <b>XPath</b> expressions.</p>
        </li></ul>
      <p>For more information about <b>XPath</b> expressions, see the XPath Reference in the Microsoft Core XML Services (MSXML) 4.0 SDK in the MSDN library at <span class="linkTerms"><b>http://msdn.microsoft.com/library</b></span>. </p>
    </div><a name="fogrfdatafeaturesenhancementsanchor14"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle47)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle47)" tabindex="0"><img id="sectionToggle47" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Cursor to XML Functions</span></h1><div id="sectionSection47" class="section" name="collapseableSection" style="display: none;">
      <p>Support for the following functions has been added to the OLE DB Provider for Visual FoxPro:</p>
      <ul><li>
          <p>
            <span class="linkTerms"><a href="/html/b53b14fa-c1b0-4c29-82b1-3149adf53073.htm">CURSORTOXML( ) Function</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/887e0f56-7ff2-4877-89ff-9bbccde7f2d6.htm">XMLTOCURSOR( ) Function</a></span>
          </p>
        </li><li>
          <p>
            <span class="linkTerms"><a href="/html/646e7dbb-d5e9-4017-b8a2-cb3625a818cb.htm">XMLUPDATEGRAM( ) Function</a></span>
          </p>
        </li></ul>
      <p>When used in the OLE DB Provider for Visual FoxPro, the <b>_VFP VFPXMLProg</b> property is not supported for the <b>CURSORTOXML( )</b>, <b>XMLTOCURSOR( )</b> and <b>XMLUPDATEGRAM( )</b> functions because the <b>_VFP</b> system variable is not supported in the OLE DB Provider.  </p>
    </div><a name="fogrfdatafeaturesenhancementsanchor31"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle48)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle48)" tabindex="0"><img id="sectionToggle48" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>EXECSCRIPT Supported in the Visual FoxPro OLE DB Provider</span></h1><div id="sectionSection48" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the <b>EXECSCRIPT( )</b> function with the Visual FoxPro OLE DB Provider. For more information, see <span class="linkTerms"><a href="/html/e838fdae-d56c-437b-9e2c-80b6a6b10579.htm">EXECSCRIPT( ) Function</a></span>.</p>
    </div><a name="fogrfdatafeaturesenhancementsanchor32"></a><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle49)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle49)" tabindex="0"><img id="sectionToggle49" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Returning a Rowset from a Cursor in the Visual FoxPro OLE DB Provider</span></h1><div id="sectionSection49" class="section" name="collapseableSection" style="display: none;">
      <p>You can use the new <b>SETRESULTSET( )</b>, <b>GETRESULTSET( )</b>, and <b>CLEARRESULTSET( )</b> functions to mark a cursor or table that has been opened by the Visual FoxPro OLE DB Provider, retrieve the work area of the marked cursor, and clear the marker flag from a marked cursor. By marking a cursor or table, you can retrieve a rowset that is created from the marked cursor or table from a database container (DBC) stored procedure when the OLE DB Provider completes command execution.</p>
      <p>For more information, see <span class="linkTerms"><a href="/html/97e8de55-a13f-4862-81c6-f3acad263b29.htm">SETRESULTSET( ) Function</a></span>, <span class="linkTerms"><a href="/html/d1c388d5-b969-44e4-ad38-c30b870eff7b.htm">GETRESULTSET( ) Function</a></span>, and <span class="linkTerms"><a href="/html/e7863fa3-7493-4f78-95d3-12e789103dad.htm">CLEARRESULTSET( ) Function</a></span>.</p>
    </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/46e99caf-fe50-4d55-aa78-e37cffeca2d1.htm">Guide to Reporting Improvements</a></span><br /><span class="linkTerms"><a href="/html/6c75fbec-8d4a-4809-a521-c54802e59ea5.htm">SQL Language Improvements</a></span><br /><span class="linkTerms"><a href="/html/ec67c781-ea65-402c-9b5f-91697f2a0746.htm">Class Enhancements</a></span><br /><span class="linkTerms"><a href="/html/f988d7c6-f382-40dd-a51a-b5ab73eb08c7.htm">Language Enhancements</a></span><br /><span class="linkTerms"><a href="/html/eca7fa6d-ec9c-411a-b3ea-6f5d71991a70.htm">Interactive Development Environment (IDE) Enhancements</a></span><br /><span class="linkTerms"><a href="/html/3d8b88b7-28b8-4d71-a4a1-4da3f1a6dd70.htm">Enhancements to Visual FoxPro Designers</a></span><br /><span class="linkTerms"><a href="/html/ebf2f62e-2ae6-4e78-aeee-e4b322dfc9b9.htm">Miscellaneous Enhancements</a></span><br /><span class="linkTerms"><a href="/html/1845aee0-11f6-4d09-bfbd-b1847476a3d1.htm">Changes in Functionality for the Current Release</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/d18b257b-4e8c-4bd7-bc46-682526474e68.htm">What's New in Visual FoxPro</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="Data and XML Feature Enhancements">
</OBJECT>
