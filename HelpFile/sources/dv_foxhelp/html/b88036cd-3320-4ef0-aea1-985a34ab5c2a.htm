<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Customize Queries</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Customize Queries</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>You can customize your queries further in the Query Designer. You can use filters to expand or narrow the results of your query. You can also add expressions to perform calculations or functions on the data in your fields. </p>
  <h1 class="heading">Filtering Records in Queries</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>You can use filter expressions to narrow or expand the range of records that your query retrieves. For example, suppose you want to retrieve records that meet more than one criterion, for example, you want to retrieve customers from a given state who have outstanding balances greater than $1,000. In this scenario, you want to narrow the range of records your query retrieves. In contrast, suppose you want to retrieve records that meet any criterion, for example, customers from Washington or from California. In this scenario, you want to narrow the range of records your query retrieves. </p>
      <p>When you want to create filter expressions that include more than one criterion, use the logical <b>AND</b> operator. When you want to create filter expressions that use any criterion you specify, use the logical <b>OR</b> operator.</p>
      <p>You can also combine AND and OR conditions to select specific sets of records. For example, you might want to retrieve records for customers from Washington or California who have maximum order amounts larger than $5,000.</p>
      <h3 class="procedureSubHeading">To specify AND or OR conditions for filter expressions</h3><div class="subSection"><ol><li>
            
              <p>Open the query in the <b>Query Designer</b>.</p>
            
          </li><li>
            
              <p>Click the <b>Filter</b> tab, and select the filter expression you want.</p>
            
          </li><li>
            
              <p>In the <b>Logical</b> column, click <b>AND</b> or <b>OR</b>.</p>
            
          </li></ol></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/0fc4c7c3-ee77-400c-86f7-0bc0c78f6543.htm">Filter Tab, Query and View Designers</a></span>.</p>
    </div><h1 class="heading">Eliminating Duplicate Records in Queries</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>You can remove duplicate records from queries. Duplicate records contain fields where all the values in the fields match each other. </p>
      <h3 class="procedureSubHeading">To remove duplicate records from queries</h3><div class="subSection"><ol><li>
            
              <p>Open the query in the <b>Query Designer</b>.</p>
            
          </li><li>
            
              <p>Click the <b>Miscellaneous</b> tab, and then <b>No duplicates</b>. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>Selecting No duplicates inserts the DISTINCT keyword preceding the fields in the SQL <b>SELECT</b> statement of the query. For more information, see <span class="linkTerms"><a href="/html/815f7265-4dfd-40b9-8f19-0673b5a48847.htm">SELECT - SQL Command</a></span>. </p>
              </td></tr></table></div>
            
          </li></ol></div>
    </div><h1 class="heading">Retrieving the Top Number or Percentage of Records</h1><div id="sectionSection2" class="seeAlsoNoToggleSection">
      <p>You can specify how many or what percentage of records with the highest or lowest values in a particular field you want the query to return. For example, the query can display those records with the 10 highest or lowest values in a specific field or the records with the highest or lowest 10 percent of values in the field.</p>
      <p>Using the Top setting on the Miscellaneous tab, you can either set a number or a percentage of records you want to see. To set whether you are choosing the top or bottom, you set the sort order for your query to either descending to see the top or ascending to see the bottom.</p>
      <h3 class="procedureSubHeading">To retrieve a number or percentage of top records</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Order By</b> tab, select the field you want to retrieve top values for, then choose <b>Descending</b> to display the highest values or <b>Ascending</b> to display the lowest values. If you are sorting on additional fields, place them after the top values field in the order by list.</p>
            
          </li><li>
            
              <p>In the <b>Miscellaneous</b> tab, type the number for the percentage or the number of highest or lowest values you want retrieved in the <b>Number of records</b> box. To display a percentage, choose <b>Percent</b>.</p>
            
          </li><li>
            
              <p>If you do not want duplicate records included in the number or percentage, choose <b>No duplicates</b>.</p>
            
          </li></ol></div>
    </div><h1 class="heading">Adding Expressions to Queries</h1><div id="sectionSection3" class="seeAlsoNoToggleSection">
      <p>You can create more flexible and powerful queries if you incorporate expressions, either in a filter or as result fields. You can include functions and expressions in the output of your query, using the box at the bottom of the Fields tab. If you want to name the field holding the expression, you can add an alias.</p>
      <p>For example, you might want your query results to include the sum of all order amounts with the alias <code>Total</code>:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SUM(orders.order_amt) AS Total</pre></td></tr></table></span></div>
      <p>You can type an expression directly into the box or use the Expression Builder on the Fields tab.</p>
      <h3 class="procedureSubHeading">To add an expression to your query output</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Fields</b> tab, type the expression in the <b>Functions and Expressions</b> box. </p>
              <p>-or-  </p>
              <p>Choose the dialog button to use the <b>Expression Builder</b> and enter an expression in the <b>Functions and expressions</b> box. </p>
            
          </li><li>
            
              <p>Choose the <b>Add</b> button to place the expression in the <b>Selected fields</b> box. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>Null values are ignored in calculations. For more information on null values in expressions, search for "Null Values".</p>
              </td></tr></table></div>
            
          </li></ol></div>
      <p>Instead of searching for records that match one or more fields, you can use an expression to combine two fields, or perform a calculation based on a field and search for records that match the combined or calculated field.</p>
      <p>You can type expressions directly into the <b>Example</b> box. If you want some help, you can use the <b>Expression Builder</b>, which is available from the dialog button next to the <b>Expressions and Functions</b> box in the <b>Fields</b> tab.</p>
      <p>For example, using the Orders table, you might want to check total discounts for a customer by combining order amount and order discount in an expression like the following:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>Orders.order_amt * Orders.order_dsc</pre></td></tr></table></span></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/f5b2d063-c8c2-4ada-bf3a-b599409cb41c.htm">How to: Create Queries (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/caad3264-1f34-430b-93bb-18c1f6c5eeb8.htm">How to: Customize Queries Using SQL SELECT Statements</a></span><br /><span class="linkTerms"><a href="/html/b0a290f6-5c73-4cbc-a4e0-cb1078d1553f.htm">How to: Run Queries (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/93c91a44-e3d4-45b5-8d74-2539538a95a6.htm">How to: Organize Query Results</a></span><br /><span class="linkTerms"><a href="/html/11c1bca1-5871-4d98-812f-2cacc479feee.htm">How to: Query Multiple Tables and Views</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/585ebea6-d673-4bbd-acaf-12f36b60c977.htm">Expression Builder Dialog Box</a></span><br /><span class="linkTerms"><a href="/html/9470fb56-5444-40c1-bc5e-4e9d2adf88b7.htm">Fields Tab, Query and View Designers</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/ccb3a0ad-7fe4-4267-ba42-aa9918ed1f21.htm">Working with Queries</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Customize Queries">
</OBJECT>
