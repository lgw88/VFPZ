<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>OLEDragDrop Event</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">OLEDragDrop Event</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Occurs when data is dropped on a drop target and the drop target's <b>OLEDropMode</b> property is set to 1 – Enabled.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
PROCEDURE <span class="parameter">Object</span>.OLEDragDrop
LPARAMETERS <span class="parameter">oDataObject</span>, <span class="parameter">nEffect</span>, <span class="parameter">nButton</span>,
  <span class="parameter">nShift</span>,   <span class="parameter">nXCoord</span>, <span class="parameter">nYCoord</span></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(returnValueToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(returnValueToggle)" tabindex="0"><img id="returnValueToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Return Value</span></h1><div id="returnValueSection" class="section" name="collapseableSection" style="display: none;">
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">oDataObject</span>
        </span></dt><dd>
          <p>An object reference to OLE drag-and-drop DataObject, used with the <b>GetData</b> and <b>GetFormat</b> methods to return data and data formats in the DataObject.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">nEffect</span>
        </span></dt><dd>
          <p>A value passed to the <b>OLECompleteDrag</b> event, indicating the action performed when data is dropped on the drop target. <span class="parameter">nEffect</span> is initially a value that indicates the OLE drag-and-drop operations supported by the drag source. Within the <b>OLEDragDrop</b> event you can change the value of <span class="parameter">nEffect</span> , which is passed to the <b>OLECompleteDrag</b> event. If you change the value of <span class="parameter">nEffect</span>, be sure to include NODEFAULT in the event code to prevent the default behavior. The following table lists the values for <span class="parameter">nEffect</span> that you can pass to the <b>OLECompleteDrag</b> event with a description of each action.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">nEffect</span>
                  
                </th>
                <th>
                  Foxpro.h constant
                </th>
                <th>
                  Description
                </th>
              </tr><tr>
              <td>
                <p>0</p>
              </td>
              <td>
                <p>DROPEFFECT_NONE</p>
              </td>
              <td>
                <p>Drop target did not accept the data or the drop operation was canceled.</p>
              </td>
            </tr><tr>
              <td>
                <p>1</p>
              </td>
              <td>
                <p>DROPEFFECT_COPY</p>
              </td>
              <td>
                <p>Data was copied from the drag source to the drop target.</p>
              </td>
            </tr><tr>
              <td>
                <p>2</p>
              </td>
              <td>
                <p>DROPEFFECT_MOVE</p>
              </td>
              <td>
                <p>Data was moved from the drag source to the drop target.</p>
              </td>
            </tr><tr>
              <td>
                <p>4</p>
              </td>
              <td>
                <p>DROPEFFECT_LINK</p>
              </td>
              <td>
                <p>Data was linked from the drag source to the drop target.</p>
              </td>
            </tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">nButton</span>
        </span></dt><dd>
          <p>Contains a number that specifies which mouse button was released to drop the data on the target: 1 (left), 2 (right), or 4 (middle).</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">nShift</span>
        </span></dt><dd>
          <p>Contains a number specifying the state of modifier keys when the mouse was released to drop the data on the drop target. The valid modifier keys are the SHIFT, CTRL, and ALT keys. The values returned in <span class="parameter">nShift</span> for individual modifier keys are listed in the following table.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">nShift</span>
                  
                </th>
                <th>
                  Modifier key
                </th>
              </tr><tr>
              <td>
                <p>1</p>
              </td>
              <td>
                <p>SHIFT</p>
              </td>
            </tr><tr>
              <td>
                <p>2</p>
              </td>
              <td>
                <p>CTRL</p>
              </td>
            </tr><tr>
              <td>
                <p>4</p>
              </td>
              <td>
                <p>ALT</p>
              </td>
            </tr></table></div>
          <p>If more than one modifier key is held down when the mouse is pressed, the <span class="parameter">nShift</span> argument contains the sum of the values for the modifier keys. For example, if the user holds CTRL while releasing the mouse button, the <span class="parameter">nShift</span> argument contains 2. But If the user holds CTRL+ALT while releasing the mouse button, the <span class="parameter">nShift</span> argument contains 6. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <span class="parameter">nXCoord</span>, <span class="parameter">nYCoord</span></span></dt><dd>
          <p>Contains the horizontal (<span class="parameter">nXCoord</span>) and vertical (<span class="parameter">nYCoord</span>) position of the mouse pointer within the Form when the mouse button was released to drop the data on the drop target. These coordinates are expressed in terms of the Form's coordinate system in the unit of measurement specified by the <span class="parameter">ScaleMode</span> property of the Form.</p>
        </dd></dl>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Applies To: <a href="/html/519bc0b5-941f-43f3-a870-54d9eb16e5a6.htm">CheckBox</a> | <a href="/html/10b56cf0-55bf-4242-88f2-481e6a013d16.htm">ComboBox</a> | <a href="/html/c12db413-abee-455c-9ad0-366dd2b68236.htm">CommandButton</a> | <a href="/html/cb0db420-f1b3-46c9-9d57-2b1d63d429e8.htm">CommandGroup</a> | <a href="/html/31b59b85-d92f-4a32-bc93-da8d637e2c3f.htm">Container Object</a> | <a href="/html/c4372c70-c8c4-49ac-9daa-4c2f9a5647c3.htm">Control Object</a> | <a href="/html/9d4545f7-74fe-4bd3-ba0f-bf9fba4d2129.htm">EditBox</a> | <a href="/html/a7ff9dc8-6d63-498c-aab6-4ce664c25190.htm">Form</a> | <a href="/html/0212bad2-48a3-49ae-98de-c71ba3af0ede.htm">Grid</a> | <a href="/html/44714f1e-837b-410a-80d0-d34d7654f4e4.htm">Image</a> | <a href="/html/4fb70675-cc61-43f0-958d-bc16277a3432.htm">Label</a> | <a href="/html/a3473b33-0b19-4de7-90d5-56b2a36a4d1b.htm">Line</a> | <a href="/html/821b8b23-3955-4d32-b53c-dcf5a5ef339c.htm">ListBox</a> | <a href="/html/4efaacba-2103-4ce8-990b-d52371259b4b.htm">OptionButton</a> | <a href="/html/11e98c55-43b3-4c8b-a7a0-6427f31c2e68.htm">OptionGroup</a> | <a href="/html/83a4017f-483a-4c8f-b63c-e16a58e011af.htm">Page</a> | <a href="/html/852d4c6e-2b5c-404b-ae44-90cdd79ebea5.htm">PageFrame</a> | <a href="/html/5b749bec-81db-4ed6-a913-ed4529208b7c.htm">ProjectHook Object</a> | <a href="/html/a3626580-d9a5-4d73-a490-9128e812d340.htm">Shape</a> | <a href="/html/f0867563-6b6a-45a9-8fd7-d0199b5d50f5.htm">Spinner</a> | <a href="/html/26bd8887-3888-41e6-a578-30b11a9eb2b4.htm">TextBox</a> | <a href="/html/b6fbb189-1e9a-47ed-b453-706c05a4b018.htm">ToolBar</a></p>
      <p>
        <b>OLEDragDrop</b> is a drop target event that only occurs when the <b>OLEDropMode</b> property for the control or object is set to 1 – Enabled. This event does not occur if the <b>OLEDropMode</b> property is set to 0 – Disabled or 2 – Pass to Container.</p>
      <p>If you perform your own drop processing in the <b>OleDragDrop</b> event, include NODEFAULT to prevent the default drop from occuring. In this case, you must then set the resulting <span class="parameter">nEffect</span> value.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/7752548b-993c-4d2b-bece-561bd479eaf5.htm">OLE Drag-and-Drop</a></span><br /><span class="linkTerms"><a href="/html/9dc58b1a-fcf9-4118-9c4e-cedaa33e8181.htm">OLECompleteDrag Event</a></span><br /><span class="linkTerms"><a href="/html/21e704df-ae10-4173-9720-df82128b241f.htm">OLEDropMode Property</a></span><br /><span class="linkTerms"><a href="/html/906d0b2c-3c60-4c70-87b2-9e2cfc28d322.htm">NODEFAULT Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/45aa16ed-5a77-45e0-a382-dcb7be6f10d7.htm">Events (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="OLEDragDrop Event">
<param name="ALink Name" value="OLEDragDrop">
<param name="Alink Name" value="vfp.50000421">
</OBJECT>
