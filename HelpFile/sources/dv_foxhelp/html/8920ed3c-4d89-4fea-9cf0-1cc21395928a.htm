<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>Including Report Files for Distribution</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Including Report Files for Distribution</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>When you distribute an application, you have a number of decisions to make about how you deploy the reports you have designed to provide application output.  This topic describes options for inclusion of report and label definition tables (.frx and .lbx files) and the distributable Visual FoxPro Report System components.</p>
  <h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0)" tabindex="0"><img id="sectionToggle0" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Distributing Report and Label Files</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="display: none;">
      <p>Reports and labels can be included in your project and built into your application (.exe or .app file), or they can be delivered separately on disk.  </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>You can reference reports and labels in your application project, for easy reference while designing the application, without building the report and label files into the compiled application file.  For more information, see <span class="linkTerms"><a href="/html/ddeacac1-2e1d-4694-8d11-37e6e40f583f.htm">How to: Exclude Files from Builds</a></span>.</p>
      </td></tr></table></div>
      <p>Which strategy you decide to use usually depends on whether you want end-users to have the ability to adjust the reports and labels.  If the reports and labels are on disk as separate files, your application can provide facilities for end-users to customize them, using the <b>MODIFY REPORT </b>and <b>MODIFY LABEL</b> commands.  </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>In Visual FoxPro 9, you can offer end-users a customized and safe design experience, by leveraging custom Report Builder dialogs and such features as Report Protection and Report Designer ToolTips, and Design-time Captions.  For more information, see <span class="linkTerms"><a href="/html/06bd5839-da09-4e34-a0f4-10bc66da8b4e.htm">Setting Protection for Reports</a></span>, <span class="linkTerms"><a href="/html/e222c9d1-fc0e-4b28-9a69-2344d51f2380.htm">How to: Add Tooltips to Report Controls</a></span>, and <span class="linkTerms"><a href="/html/33821b95-1d27-4ca8-8dfd-1b7f145ceb3d.htm">How to: Add Design-time Captions to Field Controls</a></span>.</p>
      </td></tr></table></div>
      <p>You can use a combination approach, building the reports and labels into your application to serve as read-only output templates, but copying them to disk for end-users' modifications.  This approach has the advantage of ensuring that you can revert to a "clean" copy of the original report or label definition file when necessary.  </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>Using a built-in template also allows you to make some last-minute adjustments to the report or label before an end-user design session.  For example, you could adjust protection flags in the editable copy using an application lookup table for user permissions.  You might also replace the ToolTips for report controls you use for development purposes, with developer notes, for another set containing end-user instructions.  Because you can add extension fields to report and label tables, this programmatic run-time adjustment would be as simple as opening the report or label table with the <b>USE</b> command, followed by a command such as <code>REPLACE ALL ORDER WITH &lt;your extension field&gt;</code>.  For more information, see <span class="linkTerms"><a href="/html/e62ce8ab-f156-45d2-a0b9-11562e5dbcef.htm">Understanding and Extending Report Structure</a></span>.</p>
      </td></tr></table></div>
      <p>Under some circumstances, Visual FoxPro permits the commands <b>MODIFY REPORT</b> and <b>MODIFY LABEL</b> to be used with the names of read-only report and label files built into the application.  When the application's end-user saves the report or label from the designer, Visual FoxPro saves the copy to disk. For this strategy to work, the report and label files must either be in the same folder as the project (.pjx) file or in a folder whose name Visual FoxPro can resolve at run time, relative to the application file (.exe or .app).  </p>
      <p>For example, suppose your project is in a folder named <b>d:\app</b> and the report form you wish to include is <b>d:\app\reports\my.frx</b> on your development computer.  At run time, you install the application file (.exe) to <b>c:\programs\myapp</b>.  If you create a reports subfolder, <b>c:\programs\myapp\reports</b>, you can use the command <code>MODIFY REPORT my.frx</code>. When the user chooses to save the report, Visual FoxPro saves the report as <b>c:\programs\myapp\reports\my.frx</b> by default. However, if <b>c:\programs\myapp</b> does not have the subfolder, an error occurs on the <b>MODIFY REPORT</b> command.  </p>
      <p>You can verify the availability of the subfolder at run time, and use the <span class="linkTerms"><a href="/html/66590c41-e2b1-4b79-ab6b-44e6c5e4847f.htm">MD | MKDIR Command</a></span> if necessary.  Alternatively, use the following commands, where <code>lcDir</code> holds the name of a target folder you have previously verified with the user.  </p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT * FROM my.frx INTO TABLE (lcDir + "my.frx")
MODIFY REPORT(lcDir + "my.frx")</pre></td></tr></table></span></div>
      <p>This approach puts the process completely under your control. It allows you to configure the target folder to meet the user's needs rather than the project's design-time structure.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>When distributing reports, whether built-in or as external files, ensure that all additional required files are available to your application at run time.  For example, if your report references an image file, include the image file in your application or distribute the file as a separate file on disk. Ensure that the image file is in the same location in your project's build structure, or in the folder structure of your distributed application on disk, relative to the report file, as it was when you designed the report.  Otherwise, Visual FoxPro cannot find the image file when it generates the report.  If you choose to build reports into your application, other compiled modules, such as ReportOutput.app or ReportBuilder.app, may not be able to locate the files within your compiled module.  You can ensure that the report system components find your files by building in their source files to your application, rather than distributing them as separate applications. The next section discusses your options for distributing these components.</p>
      </td></tr></table></div>
    </div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1)" tabindex="0"><img id="sectionToggle1" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Distributing Report System Components</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="display: none;">
      <p>If you provide end-users with the opportunity to modify reports and labels, you should distribute the Report Builder Application, or your customized version of the Report Builder Application, to ensure that your users have all the advantages of its Report Designer enhancements.</p>
      <p>By default, Visual FoxPro looks for a file with the name ReportBuilder.app in the <b>HOME()</b> or startup location.  For an executable application (.exe), this location is always the folder where Visual FoxPro's run-time support libraries are installed, such as <b>C:\Program Files\Common Files\Microsoft Shared\VFP</b>.  For more information, see <span class="linkTerms"><a href="/html/7266f399-d690-4dbb-82e8-9fa1429b013e.htm">HOME( ) Function</a></span>.  If you include the <b>Microsoft Visual FoxPro 9 Report Applications</b> merge module with your application installation Setup programs, as described in the next section, the default ReportBuilder.app installs to the appropriate location on the user's disk.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Caution note" src="../local/Caution.gif"></img>Caution </th></tr><tr><td>
        <p>Installing any other applications with the names ReportBuilder.app, ReportPreview.app, and ReportOutput.app to the default location of the run-time support libraries is not recommended, since you might install over the default applications required by other Visual FoxPro applications.  If you wish to install customized versions of these applications to the default location, use different application names and designate your preferred reporting components by name, in your application, as described in this section.  </p>
      </td></tr></table></div>
      <p>You can use the <span class="linkTerms"><a href="/html/66161092-cda2-4d9f-868c-26beaffa0841.htm">_REPORTBUILDER System Variable</a></span> in your application, or in the configuration file (CONFIG.FPW) for your application, to specify a different location and a different file name for your distributed Report Builder Application.  For more information, see <span class="linkTerms"><a href="/html/e4da0efc-19ca-4eb4-a1b7-c5f7d60a4d9c.htm">Setting Configuration Options at Startup</a></span>.</p>
      <p>When you deploy applications, you have the option to build Report Builder component files into your executable application (.exe) rather than distributing Report Builder Application as a standalone file.  For more information, see <span class="linkTerms"><a href="/html/de758f3c-c569-48e7-afa2-f8d45efe030d.htm">How to: Specify and Distribute ReportBuilder.App</a></span>.</p>
      <p>To provide Visual FoxPro 9's enhanced output capabilities in your applications, using ReportListener and PreviewContainer objects, you should also distribute the Report Output Application (ReportOutput.app) and Report Preview Application (ReportPreview.app) or suitable replacements.  The techniques for specifying the names and locations of these components are the same for all three report applications.  For more information, see <span class="linkTerms"><a href="/html/3c2c0407-c691-4183-9c2e-b96a00698b73.htm">How to: Specify and Distribute ReportPreview.App</a></span> and <span class="linkTerms"><a href="/html/ba6158fb-968d-4f13-b389-b56241500f30.htm">How to: Specify and Distribute Report Output Application Components</a></span>.  </p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>You can leverage the default ReportListener-derived classes used by the Report Output Application and many of the capabilities of the Report Builder Application separately from the two applications, by using Foundation Class libraries containing identical visual classes.  For more information, see <span class="linkTerms"><a href="/html/46ce7cb2-a620-447d-9314-1ebba6e3e271.htm">ReportListener Foundation Classes</a></span>, <span class="linkTerms"><a href="/html/5bd65ee4-c279-487d-8b31-03f081dd9844.htm">FRX Cursor Foundation Class</a></span>, and <span class="linkTerms"><a href="/html/2d699a43-bb61-4893-bdda-cbf2824990c3.htm">FRX Device Helper Foundation Class</a></span>. </p>
      </td></tr></table></div>
    </div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle2)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle2)" tabindex="0"><img id="sectionToggle2" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Distributing additional files for reports and Visual FoxPro's Report System</span></h1><div id="sectionSection2" class="section" name="collapseableSection" style="display: none;">
      <p>Visual FoxPro supplies merge modules (.msm files) so you can build distributable Setup programs for your applications and include all the necessary support files. For more information, see <span class="linkTerms"><a href="/html/d906c831-cfde-4d4c-8b80-47041cff359b.htm">Walkthrough: Creating a Visual FoxPro Application Setup Program Using InstallShield</a></span>.  The following table lists the modules of special significance to applications using Visual FoxPro's reporting features.  </p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              
                <b>Merge module file name</b>
              
            </th>
            <th>
              
                <b>Merge module title</b>
              
            </th>
            <th>
              
                <b>Remarks</b>
              
            </th>
          </tr><tr>
          <td>
            <p>vfp9rptapps.msm</p>
          </td>
          <td>
            <p>Visual FoxPro 9 Report Applications</p>
          </td>
          <td>
            <p>Installs ReportBuilder.app, ReportOutput.app, and ReportPreview.app to their default locations for executable applications.</p>
          </td>
        </tr><tr>
          <td>
            <p>msxml4sxs32.msm</p>
            <p>msxml4sys32.msm</p>
          </td>
          <td>
            <p>MSXML 4.0</p>
          </td>
          <td>
            <p>These module are required for all Visual FoxPro application installations, and are used extensively by the default Report Applications. </p>
          </td>
        </tr><tr>
          <td>
            <p>GDIPlus.msm</p>
          </td>
          <td>
            <p>Microsoft GDI+</p>
          </td>
          <td>
            <p>This module is required for all Visual FoxPro application installations, and is used extensively by the Report System in object-assisted reporting mode.</p>
          </td>
        </tr></table></div>
    </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/6602c8f4-1081-4209-9b72-75101f6a1fa0.htm">EXTERNAL Command</a></span><br /><span class="linkTerms"><a href="/html/c348d33f-8294-48a9-964b-3cdbd699927b.htm">MODIFY REPORT Command</a></span><br /><span class="linkTerms"><a href="/html/115e76bd-e92b-4f2f-a851-c35d8e88da56.htm">MODIFY LABEL Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/44a57df6-33fa-419a-a650-542f2ad28148.htm">Distributing Applications</a></span><br /><span class="linkTerms"><a href="/html/ed7d4b83-ec91-42fc-8ec5-97b59ea81cb8.htm">Extending Report Functionality in Visual FoxPro</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="Including Report Files for Distribution">
</OBJECT>
