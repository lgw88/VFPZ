<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>ListBox Control</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">ListBox Control</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Creates a list box that displays a list of items that you can select one or more items from. A list box is similar to a combo box; however, a combo box initially displays a single item. For more information about combo boxes, see <span class="linkTerms"><a href="/html/10b56cf0-55bf-4242-88f2-481e6a013d16.htm">ComboBox Control</a></span>.</p>
    <p>For more information about creating <b>ListBox</b> controls, see <span class="linkTerms"><a href="/html/4c6826b0-d49e-4f97-b18c-4670533600c7.htm">Form Designer</a></span> and <span class="linkTerms"><a href="/html/b9032965-6941-41d2-8ff9-87c609673907.htm">Using Controls</a></span>.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
ListBox</pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>The following table lists properties commonly set at design time.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Property
            </th>
            <th>
              Description
            </th>
          </tr><tr>
          <td>
            <p>
              <a href="/html/9b9270cb-27c5-470b-b889-5910309ef707.htm">ColumnCount</a>
            </p>
          </td>
          <td>
            <p>Determines the number of columns in the list.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/76c0d810-a6e4-4076-aa91-0763a6dfe03b.htm">ControlSource</a>
            </p>
          </td>
          <td>
            <p>Specifies where to store the value that the user chooses from the list.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/37e8f94e-ee8f-4b5a-b051-f0d62912f12c.htm">MoverBars</a>
            </p>
          </td>
          <td>
            <p>Specifies whether to display mover bars to the left of the items in the list so that a user can rearrange the item order.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/7c656b55-605e-47f8-948a-944866cf1b08.htm">Multiselect</a>
            </p>
          </td>
          <td>
            <p>Specifies whether the user can select more than one item in the list.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/490d957f-926a-4b4c-a265-e3ad5f679f1b.htm">RowSource</a>
            </p>
          </td>
          <td>
            <p>Specifies the source of the values displayed in the list.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/ffd39712-9ea4-42a5-bd92-9a4073f5a6b4.htm">RowSourceType</a>
            </p>
          </td>
          <td>
            <p>Specifies the type of the source of the values displayed in the list. </p>
          </td>
        </tr></table></div>
      <p>The following table lists methods commonly used.</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Method
            </th>
            <th>
              Description
            </th>
          </tr><tr>
          <td>
            <p>
              <a href="/html/4348ea2d-25ca-4306-a129-28bd0287ec3a.htm">AddItem</a>
            </p>
          </td>
          <td>
            <p>Adds an item to the list when <b>RowSourceType</b> is set to 0.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/995c88c6-f440-450a-a8a0-3cb639aa3414.htm">RemoveItem</a>
            </p>
          </td>
          <td>
            <p>Removes an item from the list when <b>RowSourceType</b> is set to 0.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <a href="/html/8e2c904d-be93-4d49-a535-f10e511e049d.htm">Requery</a>
            </p>
          </td>
          <td>
            <p>Updates the list if the values in the source specified by <b>RowSource</b> have changed.</p>
          </td>
        </tr></table></div>
      <p>The backslash ("\") is treated as a special character when used in the expression for an item. The following rules apply for this character:  </p>
      <ul><li>
          <p>You can disable an item in a list box or combo box by adding a single backslash to the beginning of the expression.</p>
        </li><li>
          <p>Any multiple of two backslashes used in the expression is displayed as a single backslash. For example, one or two backslashes used together will display as one, and three or four backslashes together will display as two. The following example code contains a list box item containing a Universal Naming Convention (UNC) path. The code would display in the list box as <code>\\MyServer\MyMachine\MyFolder</code>. </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>MyForm.List1.AddItem("\\\\MyServer\\MyMachine\\MyFolder")</pre></td></tr></table></span></div>
        </li><li>
          <p>If the expression begins with multiple backslashes, the item is not disabled. If you want to disable an item that begins with multiple backslashes, add a backslash and a close bracket (]) to the beginning of the item. For example, the following would disable the UNC path item in the list box: </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>MyForm.List1.AddItem("\]\\\MyServer\\MyMachine\\MyFolder")</pre></td></tr></table></span></div>
        </li><li>
          <p>To include a separator line, use a backslash followed by a hyphen as the item to add to the list box. For example, the following code adds a separator line to a list box: </p>
          <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>MyForm.List1.AddItem("\-")</pre></td></tr></table></span></div>
        </li></ul>
      <p>You can also use an ActiveX control that adds extra characteristics, such as a <b>CheckBox</b>, to the <b>ListView</b> or <b>TreeView</b> controls.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      
        <p xmlns="">The following example creates a ListBox control. The source of the items that appear in the list box is an array specified with the RowSourceType and RowSource properties.</p>
        <p xmlns="">The MultiSelect property for the list box is set to true (.T.), allowing you to make multiple selections from the list. The item or items you choose are displayed by using the ListCount, Selected, and List properties (which determine the number of items in the list and the items you chose).</p>
      
    </description>
    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CLEAR
DIMENSION gaMyListArray(10)
FOR gnCount = 1 to 10  &amp;&amp; Fill the array with letters
   STORE REPLICATE(CHR(gnCount+64),6) TO gaMyListArray(gnCount)
NEXT   
frmMyForm = CREATEOBJECT('Form')  &amp;&amp; Create a Form
frmMyForm.Closable = .f.  &amp;&amp; Disable the Control menu box
frmMyForm.Move(150,10)  &amp;&amp; Move the form
frmMyForm.AddObject('cmbCommand1','cmdMyCmdBtn')  &amp;&amp; Add "Quit" Command button
frmMyForm.AddObject('lstListBox1','lstMyListBox')  &amp;&amp; Add ListBox control
frmMyForm.lstListBox1.RowSourceType = 5  &amp;&amp; Specifies an array
frmMyForm.lstListBox1.RowSource = 'gaMyListArray' &amp;&amp; Array containing listbox items
frmMyForm.cmbCommand1.Visible =.T.  &amp;&amp; "Quit" Command button visible
frmMyForm.lstListBox1.Visible =.T.  &amp;&amp; "List Box visible
frmMyForm.SHOW  &amp;&amp; Display the form
READ EVENTS  &amp;&amp; Start event processing
DEFINE CLASS cmdMyCmdBtn AS CommandButton  &amp;&amp; Create Command button
   Caption = '\&lt;Quit'  &amp;&amp; Caption on the Command button
   Cancel = .T.  &amp;&amp; Default Cancel Command button (Esc)
   Left = 125  &amp;&amp; Command button column
   Top = 210  &amp;&amp; Command button row
   Height = 25  &amp;&amp; Command button height
   PROCEDURE Click
      CLEAR EVENTS  &amp;&amp; Stop event processing, close Form
      CLEAR  &amp;&amp; Clear main Visual FoxPro window
ENDDEFINE
DEFINE CLASS lstMyListBox AS ListBox  &amp;&amp; Create ListBox control
   Left = 10  &amp;&amp; List Box column
   Top = 10  &amp;&amp; List Box row
   MultiSelect = .T.  &amp;&amp; Allow selecting more than 1 item
PROCEDURE Click
   ACTIVATE SCREEN
   CLEAR
   ? "Selected items:"
   ? "---------------"
   FOR nCnt = 1 TO ThisForm.lstListBox1.ListCount
      IF ThisForm.lstListBox1.Selected(nCnt)  &amp;&amp; Is item selected?
         ? SPACE(5) + ThisForm.lstListBox1.List(nCnt) &amp;&amp; Show item
      ENDIF
   ENDFOR
ENDDEFINE</pre></td></tr></table></span></div>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/5141ac27-2001-4e8f-85d2-bdf04e9f715b.htm">ListBox Control Properties, Methods, and Events</a></span><br /><span class="linkTerms"><a href="/html/bf40024f-fb8b-4ded-b0a2-8298e5d8a223.htm">CREATE CLASS Command</a></span><br /><span class="linkTerms"><a href="/html/fc06db33-d64c-4893-a51e-235b5ad3edfa.htm">CREATE FORM Command</a></span><br /><span class="linkTerms"><a href="/html/42b84eb0-a6fc-4ccd-abc2-1f9ffc853471.htm">DEFINE CLASS Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/42cd01c1-54f0-40ac-b7f4-ef91d4211dfd.htm">Objects, Collections, and Classes</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="ListBox Control">
<param name="ALink Name" value="ListBox">
<param name="Alink Name" value="vfp.50001024">
</OBJECT>
