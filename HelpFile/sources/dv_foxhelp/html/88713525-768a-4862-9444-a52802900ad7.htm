<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Customize a Menu System</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Customize a Menu System</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>After creating a basic menu system, you can customize it. For example, you can create status bar messages, define menu locations, or define default procedures.</p>
  <h1 class="heading">Displaying Status Bar Messages</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>When a menu or menu item is selected, you can display a status bar message describing the choice. Such a message helps the user by adding information about the menu choice.</p>
      <h3 class="procedureSubHeading">To display a message when a menu or menu item is selected</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Prompt</b> column, select the appropriate menu title or menu item.</p>
            
          </li><li>
            
              <p>Choose the button in the <b>Options</b> column to display the <b>Prompt Options</b> dialog box.</p>
            
          </li><li>
            
              <p>Select <b>Message</b>. </p>
              <p>The <b>Expression Builder</b> dialog box appears. </p>
            
          </li><li>
            
              <p>In the <b>Message</b> box, type the appropriate message. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
                <p>Enclose character strings in quotation marks.</p>
              </td></tr></table></div>
            
          </li></ol></div>
    </div><h1 class="heading">Defining the Location of Menu Titles</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>You can customize the location of user-defined menu titles in your applications. You can customize the location relative to the active menu system by choosing options in the <span class="linkTerms"><a href="/html/c6469e24-d0fb-4d32-83f2-be8fd97729df.htm">General Options Dialog Box</a></span>. Additionally, you can specify the location of menu titles when the user edits an object visually.</p>
      <h3 class="procedureSubHeading">To specify a relative location for user — defined menu titles</h3><div class="subSection"><ol><li>
            
              <p>From the <b>View</b> menu, choose <b>General Options</b>.</p>
            
          </li><li>
            
              <p>Choose the appropriate <b>Location</b> option: <b>Replace</b>, <b>Append</b>, <b>Before</b>, or <b>After</b>.</p>
            
          </li></ol></div>
      <p>Visual FoxPro relocates all of the menu titles you've defined. If you want to relocate some but not all of them, drag the mover buttons next to the appropriate menu titles in the <span class="linkTerms"><a href="/html/331479bc-d5c1-4d26-8394-d04673f0dd0c.htm">Menu and Shortcut Designers</a></span>.</p>
      <p>Additionally, you can specify the location of menu titles when the user edits an object in your application. If you include an object and the user activates it, your menu titles will not appear on the resulting menu bar unless you indicate that you want them there.</p>
      <h3 class="procedureSubHeading">To control menu title location during object visual editing</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Prompt</b> column, select the appropriate menu title.</p>
            
          </li><li>
            
              <p>Choose the button in the <b>Options</b> column to display the <b>Prompt Options</b> dialog box.</p>
            
          </li><li>
            
              <p>Set the <b>Negotiate </b>check box.</p>
            
          </li><li>
            
              <p>Choose one of the following option buttons: </p>
              <ul><li>
                  <p>
                    <b>None</b> does not place the menu title on the menu bar. Choosing <b>None</b> is the same as not choosing any option.</p>
                </li><li>
                  <p>
                    <b>Left</b> places the menu title in the left group of menu titles on the menu bar.</p>
                </li><li>
                  <p>
                    <b>Middle</b> places the menu title in the middle group of menu titles on the menu bar.</p>
                </li><li>
                  <p>
                    <b>Right</b> places the menu title in the right group of menu titles on the menu bar.</p>
                </li></ul>
            
          </li></ol></div>
      <p>If you don't choose Left, Middle, or Right, the menu title will not appear on the menu bar when the user edits an object. For more information about editing objects visually, see <span class="linkTerms"><a href="/html/66d47bc7-f93b-483b-b39f-ebcc9e0a1be4.htm">Sharing Information and Adding OLE</a></span>.</p>
    </div><h1 class="heading">Saving and Restoring Menus</h1><div id="sectionSection2" class="seeAlsoNoToggleSection">
      <p>You can save and restore menus on the stack by pushing and popping them, which can be useful when you want to remove a menu temporarily, replace it with another, and then restore the original later on. The number of menus you save in memory is limited only by the amount of available memory.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>Check the available memory with the <a href="/html/2d1b6bdc-9e99-4ce4-b041-ecd7dda8d063.htm">SYS(1016)</a> function. For example, to check how much memory your menu system uses, call SYS(1016), push the menu on the stack, and then call SYS(1016) again.</p>
      </td></tr></table></div>
      <h3 class="procedureSubHeading">To save or restore menus</h3><div class="subSection"><ul><li>
            
              <p>Use the <a href="/html/604070fe-ad52-46e3-9e6a-b53b6775c24c.htm">PUSH MENU</a> or <a href="/html/b2ea0a2e-953a-4520-b11f-f42ebdbe15cc.htm">POP MENU</a> commands. </p>
            
          </li></ul></div>
    </div><a name="dgcreating_a_default_procedure_for_a_menu_system"></a><h1 class="heading">Creating a Default Procedure for a Menu System</h1><div id="sectionSection3" class="seeAlsoNoToggleSection">
      <p>You can create a global procedure that applies to your entire menu system. Such a procedure runs whenever a menu without an assigned procedure is chosen.</p>
      <p>For example, suppose you're developing an application for which some menus do not yet have submenus, procedures, and so on. For these menus, you can create a code stub that executes when the menus are chosen. For instance, you could create a general procedure that includes this function:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>MESSAGEBOX("Feature not available")</pre></td></tr></table></span></div>
      <h3 class="procedureSubHeading">To create a default procedure</h3><div class="subSection"><ol><li>
            
              <p>Open the menu system you're designing.</p>
            
          </li><li>
            
              <p>From the <b>View</b> menu, choose <b>General Options</b>.</p>
            
          </li><li>
            
              <p>Assign the procedure by doing one of the following: </p>
              <ul><li>
                  <p>Write or call a procedure in the <b>Procedure</b> box. </p>
                  <p>-OR- </p>
                </li><li>
                  <p>Select <b>Edit</b> and then <b>OK</b> to open a separate editing window and write or call a procedure.</p>
                </li></ul>
            
          </li></ol></div>
    </div><h1 class="heading">Setting the System Menu</h1><div id="sectionSection4" class="seeAlsoNoToggleSection">
      <p>You can manipulate menus that use the Visual FoxPro menu system. You can disable your menus, add and remove items from your menus, restore the default Visual FoxPro menus, and control access to your menus during program execution.</p>
      <h3 class="procedureSubHeading">To manipulate menus</h3><div class="subSection"><ul><li>
            
              <p>Use the <span class="linkTerms"><a href="/html/737fa94e-e1a7-4f98-a6bb-2a33e15ca729.htm">SET SYSMENU Command</a></span>. </p>
            
          </li></ul></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/5ea47bac-e3a3-4dcb-8d9d-f878cf843679.htm">How to: Test and Debug a Menu System</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/c6469e24-d0fb-4d32-83f2-be8fd97729df.htm">General Options Dialog Box</a></span><br /><span class="linkTerms"><a href="/html/5aeb5f16-deea-495c-8d96-602f3835e038.htm">Customize Toolbar Dialog Box (Visual FoxPro)</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/18f2b40a-6c13-4f57-b28e-ac3e0e21e083.htm">Creating Custom Toolbars</a></span><br /><span class="linkTerms"><a href="/html/21eaee88-6fbe-452b-839d-aa519d16892c.htm">Designing Menus and Toolbars</a></span><br /><span class="linkTerms"><a href="/html/4d5ad8fb-f7a7-416d-9076-cf6f53cbdb89.htm">Customizing the Visual FoxPro Environment</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Customize a Menu System">
</OBJECT>
