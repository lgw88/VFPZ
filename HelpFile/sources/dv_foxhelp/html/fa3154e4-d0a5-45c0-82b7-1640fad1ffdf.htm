<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Specify the Code Page of a .dbf File</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Specify the Code Page of a .dbf File</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>When you create .dbf files, Visual FoxPro automatically gives them code page marks so that you can tell which code pages they use. However, if you use .dbf files from previous versions of FoxPro, they might not have code page marks.</p>
    <p>You can determine whether a .dbf file has a code page mark by using the <a href="/html/4bccff52-cbec-495f-aa32-bfadb6b1b3f6.htm">CPDBF( )</a> function after opening the file or by having Visual FoxPro check when you open the file.</p>
  <h3 class="procedureSubHeading">To check for code page marks automatically</h3><div class="subSection"><ol><li>
        
          <p>From the <b>Tools</b> menu, choose <b>Options</b>.</p>
        
      </li><li>
        
          <p>Select the <a href="/html/a3a5e840-ab92-4925-8425-c6df294d2794.htm">Data</a> tab.</p>
        
      </li><li>
        
          <p>Set the <b>Prompt for code page</b> check box, if it's not already set. </p>
          <p>To save this setting for future sessions of Visual FoxPro, choose <b>Set as Default</b>.  </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
            <p>Instead of setting the Prompt for code page check box, you can use the <a href="/html/f21f8ef4-4ba9-4e4e-879f-8d6a442825bf.htm">SET CPDIALOG</a> command to check for code pages.</p>
          </td></tr></table></div>
        
      </li></ol>
      
        <p>If a file doesn't have a code page mark, you must add a mark, as described in the following section.</p>
      
    </div><h1 class="heading">Adding Code Page Marks</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>If you use a .dbf file from a previous version of FoxPro, the file might not have a code page mark; without such a mark, the file might not display properly. If automatic code page checking is enabled, when you open the file you can tell if it has a code page mark. If it doesn't have one, you can add one.</p>
      <h3 class="procedureSubHeading">To manually add a code page mark to a .dbf file</h3><div class="subSection"><ol><li>
            
              <p>Ensure automatic code page checking is in effect (see the previous procedure).</p>
            
          </li><li>
            
              <p>Open the file. </p>
              <p>If the file doesn't have a code page mark, the <a href="/html/ab40f46a-9c67-4327-9a95-93db10b2b856.htm">Code Page</a> dialog box appears. </p>
            
          </li><li>
            
              <p>Choose the appropriate code page.</p>
            
          </li><li>
            
              <p>View the file to see if you assigned the proper code page. </p>
              <p>If you can't see some of the data, or if you can't recognize some of it, the code page is not correct. </p>
            
          </li><li>
            
              <p>If the code page is incorrect, remove the code page mark by using the <a href="/html/08567085-7941-43c0-af79-3baa6a55e93e.htm">CPZERO</a> program in the Visual FoxPro Tools\Cpzero directory.</p>
            
          </li><li>
            
              <p>Repeat this procedure until the code page is correct. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>Text files such as program (.prg) and query (.qpr) files don't have code page marks. This means that you can't tell which code pages the files use. However, if you include such files in a project, the project can keep a record of the code pages used. For more information, see <a href="/html/24e58cf5-a80b-478e-bb6f-c40601cff626.htm">How to: Specify the Code Page of a Text File</a>.</p>
              </td></tr></table></div>
            
          </li></ol></div>
    </div><h1 class="heading">Removing Code Page Marks</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>If a .dbf file doesn't display properly, it might have the wrong code page mark. You can remove the code page mark with the CPZERO program located in Tools\Cpzero. Running CPZERO sets the code page to 0, meaning none.</p>
      <h3 class="procedureSubHeading">To remove a code page mark</h3><div class="subSection"><ul><li>
            
              <p>Run <a href="/html/08567085-7941-43c0-af79-3baa6a55e93e.htm">CPZERO</a> using the following syntax: </p>
              <p>DO CPZERO WITH "<span class="parameter">filename</span>", 0  </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>When you remove the code page mark of a .dbf file, the data in the file doesn't change. To change the code page of the data, you must mark the file with the proper code page.</p>
              </td></tr></table></div>
            
          </li></ul></div>
    </div><h1 class="heading">Changing Code Page Marks</h1><div id="sectionSection2" class="seeAlsoNoToggleSection">
      <p>You can change the code page of a .dbf file by removing its code page mark and then adding a new one, by copying the file to another file, or by using the CPZERO program.</p>
      <h3 class="procedureSubHeading">To change the code page of a .dbf file by copying the file</h3><div class="subSection"><ul><li>
            
              <p>Use the <a href="/html/e5cc1f14-402f-43b7-8066-af695c60e183.htm">COPY TO</a> command, specifying the target code page with the AS clause. (To set the code page to the current system code page, omit the AS clause.) </p>
              <p>For example, to copy Test.dbf to Test866.dbf, while changing the code page to 866, use the following commands:  </p>
              <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>USE TEST.DBF
COPY TO TEST866.DBF AS 866</pre></td></tr></table></span></div>
            
          </li></ul></div>
      <p>When the COPY TO completes, the data in the resulting file will have the new code page.</p>
      <h3 class="procedureSubHeading">To change a code page mark using CPZERO</h3><div class="subSection"><ul><li>
            
              <p>Run <a href="/html/08567085-7941-43c0-af79-3baa6a55e93e.htm">CPZERO</a> using the following syntax: </p>
              <p>DO CPZERO WITH "<span class="parameter">filename</span>", <span class="parameter">newCodePage</span></p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>Some characters cannot be translated between code pages successfully. In addition, Visual FoxPro doesn't support some code page translations. Always check the results of a code page change to be sure that your data has been translated successfully.</p>
              </td></tr></table></div>
            
          </li></ul></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/24e58cf5-a80b-478e-bb6f-c40601cff626.htm">How to: Specify the Code Page of a Text File</a></span><br /><span class="linkTerms"><a href="/html/33213532-33da-4f4b-b6a3-41b8ad7cf250.htm">How to: Determine the Code Page of a Project File</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/8545e1db-a67e-444c-90b5-7bbf2a9118fa.htm">Specification of Code Pages for Variables</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/a4b83cd7-c41f-4e46-a70c-c7c6799cfb36.htm">Code Pages in Visual FoxPro</a></span><br /><span class="linkTerms"><a href="/html/e3423e23-033c-40b4-971c-75640ab17ec7.htm">Developing International Applications</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Specify the Code Page of a .dbf File">
</OBJECT>
