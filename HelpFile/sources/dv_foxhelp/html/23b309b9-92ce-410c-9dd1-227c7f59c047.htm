<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>SET ENGINEBEHAVIOR Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">SET ENGINEBEHAVIOR Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Enables SQL data engine compatibility with Visual FoxPro 7.0, 8.0, and 9.0.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
SET ENGINEBEHAVIOR 70 | 80 | 90</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">70 </span></dt><dd>
          <p>Specifies that Visual FoxPro treat SQL commands with behavior as in versions before Visual FoxPro 8.0.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">80 </span></dt><dd>
          <p>Specifies that Visual FoxPro treat SQL commands with behavior as in Visual FoxPro 8.0. </p>
          <p>The following table describes behavior for the SQL <b>SELECT</b> statement.   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>SQL SELECT clause</b>
                  
                </th>
                <th>
                  
                    <b>Behavior</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>
                  <b>DISTINCT</b>
                </p>
              </td>
              <td>
                <p>You cannot use the <b>DISTINCT</b> clause with <b>Memo</b> or <b>General</b> fields. Instead, wrap a <b>Memo</b> field inside a function such as <b>PADR(</b> <b>)</b> or <b>ALLTRIM(</b> <b>)</b>. </p>
                <p>For more information, see <span class="linkTerms"><a href="/html/b59c2424-3180-494a-bd87-fe8f80a32399.htm">PADL( ) | PADR( ) | PADC( ) Functions</a></span> and <span class="linkTerms"><a href="/html/767f9fa5-5271-4fe2-baf8-332cf8d15fb5.htm">ALLTRIM( ) Function</a></span>.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>UNION</b>
                </p>
              </td>
              <td>
                <p>The <b>UNION</b> clause does not support <b>Memo</b> fields unless the <b>ALL</b> clause is included in the SQL <b>SELECT</b> statement.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>GROUP BY</b>
                </p>
              </td>
              <td>
                <p>The <b>GROUP BY</b> clause must list every field in the <b>SELECT</b> list except for fields contained in an aggregate function, such as the <b>COUNT(</b> <b>)</b> function. In addition, the <b>GROUP BY</b> clause must also list every field in a <b>HAVING</b> clause except for fields contained in an aggregate function.</p>
                <p>For example, the following code raises an error because the field <code>company</code> is not listed in the <b>GROUP BY</b> clause.</p>
                <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT company, country FROM Customer GROUP BY country</pre></td></tr></table></span></div>
                <p>You can include an aggregate function in the <b>SELECT</b> list without having it in the <b>GROUP BY</b> clause. </p>
                <p>For example, the following code uses the <b>COUNT(</b> <b>)</b> function on the field <code>company</code> without having the field <code>company</code> in the <b>GROUP BY</b> clause.</p>
                <p>
                  <code>SELECT COUNT(company), country FROM Customer GROUP BY country</code>
                </p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>HAVING</b>
                </p>
              </td>
              <td>
                <p>A SQL <b>SELECT</b> statement can contain the <b>HAVING</b> clause without the <b>GROUP BY</b> clause as long as the SQL <b>SELECT</b> statement does not contain any aggregate functions.</p>
                <p>For example, the following code filters query results by specifying the country field must equal "Sweden".</p>
                <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT customerid FROM customers HAVING country="Sweden"</pre></td></tr></table></span></div>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>LIKE</b>
                </p>
              </td>
              <td>
                <p>SQL <b>SELECT</b> statements do not automatically remove trailing spaces from values compared with the <b>LIKE</b> operation. In versions before Visual FoxPro 8.0, both values in the <b>LIKE</b> operation were trimmed from the right before evaluation.</p>
                <p>For example, the following code assumes that you have a table named <code>table1</code>, and the table has three rows that contain values of "1.", "12 ", and "123", respectively. </p>
                <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT * FROM table1 WHERE column1 LIKE "1__"</pre></td></tr></table></span></div>
                <p>Visual FoxPro 7.0 and earlier returns one row with the value of "123". Visual FoxPro 8.0 returns three rows with the values, "1 ", "12 ", and "123".</p>
                <p>If the beginning of the filter condition matches the pattern of the expression in the <b>LIKE</b> operation, and the rest of the filter condition contains trailing spaces, the <b>LIKE</b> operation ignores the trailing spaces and returns True (.T.). Trailing spaces in the pattern are not ignored.</p>
              </td>
            </tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">90 </span></dt><dd>
          <p>Specifies that Visual FoxPro treat SQL commands with standard Visual FoxPro 9.0 behavior. This is the default setting.</p>
          <p>The following table describes behavior for the SQL <b>SELECT</b> statement.  </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>SQL SELECT clause</b>
                  
                </th>
                <th>
                  
                    <b>Behavior</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>
                  <b>TOP nExpr</b>
                </p>
              </td>
              <td>
                <p>When you enable this setting, including the <b>TOP</b> <span class="parameter">nExpr</span> <b>[PERCENT]</b> clause in the SQL <b>SELECT</b> command returns no more than <span class="parameter">nExpr</span> <b>[PERCENT]</b> records. In addition, the SQL engine uses available memory more efficiently and it speeds evaluation for the <b>TOP</b> clause without the <b>PERCENT</b> keyword when you work with large result sets, low memory conditions, or both.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>GROUP BY</b>
                </p>
              </td>
              <td>
                <p>When you use aggregate functions, such as <b>MAX(</b> <b>)</b>, in the SQL <b>SELECT</b> command without a <b>GROUP BY</b> clause, and the system does not find any matching records, Visual FoxPro returns a result set with a single record and it sets <b>_TALLY</b> to 1. In versions before Visual FoxPro 9.0, the system does not return any records and it sets <b>_TALLY</b> to 0.</p>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>ORDER BY</b>
                </p>
              </td>
              <td>
                <p>A <b>SELECT</b> … <b>DISTINCT</b> … <b>ORDER BY</b> command will generate an error if the specified <b>ORDER BY</b> field is not in the <b>SELECT</b> field list.</p>
                <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CREATE CURSOR foo (f1 int, f2 int)
SELECT DISTINCT f1 FROM foo ORDER BY f2 INTO CURSOR res</pre></td></tr></table></span></div>
              </td>
            </tr><tr>
              <td>
                <p>
                  <b>HAVING</b>
                </p>
              </td>
              <td>
                <p>A <b>SELECT</b> … <b>DISTINCT</b> … <b>HAVING</b> command will generate an error if the specified <b>HAVING</b> field is not in the <b>SELECT</b> field list.</p>
                <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CREATE CURSOR foo (f1 int, f2 int)
SELECT DISTINCT f1 from foo HAVING f2&gt;1 INTO CURSOR res</pre></td></tr></table></span></div>
              </td>
            </tr></table></div>
          <p>
          </p>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>The scope of <b>SET ENGINEBEHAVIOR</b> is global.</p>
      <p>Using <b>SET ENGINEBEHAVIOR</b> set to 70 might lead to ambiguous results from SQL <b>SELECT</b> commands. This occurs when you use the following:</p>
      <ul><li>
          <p>
            <b>DISTINCT</b> and <b>UNION</b> clauses with memos and the <b>GROUP BY</b> clause</p>
        </li><li>
          <p>
            <b>HAVING</b> clause without a <b>GROUP BY</b> clause</p>
        </li><li>
          <p>
            <b>LIKE</b> clause</p>
        </li></ul>
      <p>When you set <b>SET ENGINEBEHAVIOR</b> to 70 or 80, results from the <b>TOP</b> clause in the SQL <b>SELECT</b> command might include more than <span class="parameter">nExpr</span> records when there are rows with identical values for columns specified by the <b>ORDER BY</b> clause. For example, suppose you specified 10 rows for <span class="parameter">nExpr</span>. If there are more than 10 rows with identical values in the columns specified in the <b>ORDER BY</b> clause, the query result might contain more than 10 rows.</p>
      <p>When you set <b>SET ENGINEBEHAVIOR</b> to 70 or 80 and the code page of the table (<span class="linkTerms"><b>CPDBF( )</b></span>) differs from the current Visual FoxPro code page setting (<span class="linkTerms"><b>CPCURRENT( )</b></span>), SQL or other Rushmore optimizable commands could return or act upon incorrect records. When you set <b>SET ENGINEBEHAVIOR</b> to 90, Visual FoxPro builds temporary indexes to ensure correct results.  </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/01f8b1a1-72f4-4df7-8f60-e8b9b8c8d08c.htm">Understanding Code Pages in Visual FoxPro</a></span>, <span class="linkTerms"><a href="/html/e7c36f99-0993-40a7-be80-0717cbe85b8c.htm">Using Rushmore Query Optimization to Speed Data Access</a></span>, and <span class="linkTerms"><a href="/html/1845aee0-11f6-4d09-bfbd-b1847476a3d1.htm">Changes in Functionality for the Current Release</a></span>.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/1334aa6b-38e0-4fcd-a174-3c4f5c964155.htm">SET Command Overview</a></span><br /><span class="linkTerms"><a href="/html/815f7265-4dfd-40b9-8f19-0673b5a48847.htm">SELECT - SQL Command</a></span><br /><span class="linkTerms"><a href="/html/2d3d72ca-6dc3-49db-8b45-ffed10eaaa90.htm">SYS(3099) - SQL Data Engine Compatibility Mode</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="SET ENGINEBEHAVIOR Command">
<param name="ALink Name" value="SET ENGINEBEHAVIOR">
</OBJECT>
