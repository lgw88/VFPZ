<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>SYS(1037) - Page Setup Dialog Box</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">SYS(1037) - Page Setup Dialog Box</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Displays the Visual FoxPro default or report <b>Page Setup</b> dialog box, or sets printer settings for the default printer in Visual FoxPro or for the report printer environment.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
SYS(1037 [, <span class="parameter">nValue</span>])</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">nValue</span>
        </span></dt><dd>
          <p>Specifies a value that determines the functionality of <b>SYS(1037)</b>. </p>
          <p>The following table lists the possible values of <span class="parameter">nValue</span>.   </p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <span class="parameter">nValue</span>
                  
                </th>
                <th>
                  
                    <b>Description</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>0 or omitted</p>
              </td>
              <td>
                <p>Opens the default <b>Page Setup</b> dialog box. </p>
              </td>
            </tr><tr>
              <td>
                <p>1</p>
              </td>
              <td>
                <p>Opens the report <b>Page Setup</b> dialog box. </p>
              </td>
            </tr><tr>
              <td>
                <p>2</p>
              </td>
              <td>
                <p>Sets a report's printer environment settings to the default printer settings.  </p>
              </td>
            </tr><tr>
              <td>
                <p>3</p>
              </td>
              <td>
                <p>Sets the default printer settings to a report's printer environment settings.</p>
              </td>
            </tr></table></div>
        </dd></dl>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>When <span class="parameter">nValue</span> is set to a value of 1, 2, or 3, the report table or cursor must be opened exclusively.</p>
      </td></tr></table></div>
    
  <h1 class="heading"><span onclick="ExpandCollapse(returnValueToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(returnValueToggle)" tabindex="0"><img id="returnValueToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Return Value</span></h1><div id="returnValueSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>Character. <b>SYS(1037)</b> returns "1" if Visual FoxPro takes any action affecting aspects of the printer environment or printer settings; otherwise, it returns "0".</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>In some cases, if the user pressed <b>OK</b> in the dialog box without making any explicit selection, it may not be obvious what changes occurred.  However, Visual FoxPro has examined any aspects of the default printer environment or the printer settings in a report file and refreshed anything in these settings that do not match the full list of attributes available from the information provided by the <b>Page Setup</b> dialog box.  Since this action occurs, the function returns "1."</p>
      </td></tr></table></div>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>
        <b>SYS(1037)</b> displays the <b>Page Setup</b> dialog box so you can change printer settings such as the paper size and orientation. The settings available in the <b>Page Setup</b> dialog box depend on the printer installed. <b>SYS(1037)</b> also sets the printer environment settings for the report to the default printer settings or the default printer settings to the report printer environment settings. For more information, see <span class="linkTerms"><a href="/html/66134e5c-4f39-43db-8a16-a7505e08a804.htm">Page Setup Dialog Box (Visual FoxPro)</a></span>.</p>
    
    <sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <h3 class="subHeading" xmlns="">SYS(1037,&lt;N&gt;) and Reports</h3><div class="subSection" xmlns="">
          <p>
            <b>SYS(1037,1)</b>, <b>SYS(1037,2)</b>, and <b>SYS(1037,3)</b> are primarily useful for developers working with Visual FoxPro 9.0 Report System extension features. For more information about these features, see <span class="linkTerms"><a href="/html/ed7d4b83-ec91-42fc-8ec5-97b59ea81cb8.htm">Extending Report Functionality in Visual FoxPro</a></span>.</p>
          <p>All three report-related <b>SYS(1037,</b><span class="parameter">&lt;N&gt;</span><b>)</b> variants require access to a cursor or open table with the same format as a report (.frx) or label (.lbx) definition file.  The report must be selected as a cursor or opened as a table before you call the function, and Visual FoxPro requires the report table to be opened exclusively.  Otherwise, an error occurs when you call the function.  For more information about the structure of report and label tables, see <span class="linkTerms"><a href="/html/b9fde125-b9df-4688-bae7-7ae28ebd99ee.htm">Table Structures of Table Files (.dbc, .frx, .lbx, .mnx, .pjx, .scx, .vcx)</a></span>.</p>
          <p>
            <b>SYS(1037,1)</b> provides a way for developers implementing Report Builder extensions to invoke the native page setup dialog box and persist the user's choices directly to a report or label table.  For more information, see <span class="linkTerms"><a href="/html/dbc4b061-74ad-4780-89bf-0e5d461be849.htm">Extending Reports at Design Time</a></span>.</p>
        <sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <h4 class="subHeading" xmlns="">Saving the current printer environment</h4><div class="subSection" xmlns="">
              <p>
                <b>SYS(1037,2)</b> serves as a way to save current printer settings to a cursor temporarily so you can restore the printer environment later.  As such, this function always stores complete details to the cursor you provide.  If this cursor is a real report, and did not have a printer environment saved to it before you used <b>SYS(1037,2)</b>, it has a complete printer environment saved to it afterwards.  If you do not want printer environment details to remain in this cursor, it is your responsibility to clear out the relevant fields later.  To avoid the need to perform this cleanup task, simply provide a temporary cursor in the correct format with one record in it, rather than using a real report or label with <b>SYS(1037,2)</b>.  For more information, see <span class="linkTerms"><a href="/html/2712d154-f13d-4a24-835a-a76a78fd6566.htm">How to: Save the Printer Environment for Reports</a></span>.</p>
              <p>
                <b>SYS(1037,2)</b> preserves any information already in the report's printer environment settings. It adds settings that are not currently in the report's printer environment, and does not overwrite existing settings.  </p>
              <p>For example, if a report definition includes <code>ORIENTATION=1</code> and <code>COPIES=3</code>, to specify a landscape report and three printed copies, the default printer environment will not overwrite this setting with a portrait orientation.  However, if you remove the line specifying <code>COPIES=3</code> from the report definition before calling the function, the report definition will include a <code>COPIES=&lt;N&gt;</code> line after calling the function.  This line will match the current Visual FoxPro default. </p>
              <p>Because this behavior is additive, if you want to save the full default Visual FoxPro default printer environment, you should use an empty cursor with this function, or make sure the relevant fields are completely empty before calling <b>SYS(1037,2)</b>.</p>
            </div>
          <h4 class="subHeading" xmlns="">Restoring the current printer environment</h4><div class="subSection" xmlns="">
              <p>
                <b>SYS(1037,3)</b> restores printer settings from a report definition to the current Visual FoxPro default. Although it may seem counter-intuitive, using this variant of the function requires complete printer environment information in the report or label, and therefore may write data to the cursor as well as changing the default printer environment.  If your report or label did not have complete information before you used the function, it will have complete information after you use it.</p>
            </div>
          <h4 class="subHeading" xmlns="">Respecting user-override of printer settings</h4><div class="subSection" xmlns="">
              <p>In previous versions of Visual FoxPro, saving printer settings in reports used three fields in the table's first record: the EXPR, TAG, and TAG2 fields.  In Visual FoxPro 9.0, if you choose not to save Printer Environment with a report, much less information is stored in these fields, making it possible for your report to work more appropriately with a wider variety of printers. </p>
              <p>In Visual FoxPro 9.0, when you design reports, you can also override any settings stored in these fields by using a fourth field, PICTURE, in first record.  Your stored settings in PICTURE override any settings for the same printer attributes in the EXPR and TAG fields.  Note that these settings are case-sensitive.</p>
              <p>
                <b>SYS(1037)</b> is aware of user settings in PICTURE and takes them into account when restoring printer environment from a report or label file.  </p>
              <p>When you run reports or labels, users may have yet another level of override of stored printer settings: the <b>PROMPT</b> clause on <b>REPORT FORM</b> and <b>LABEL</b> commands.  If you use this keyword, or if you provide equivalent instructions with a ReportListener object's CommandClauses.Prompt member, any settings provided by the user at runtime take precedence over settings stored in the report as well as default Visual FoxPro printer environment settings.  For more information, see <span class="linkTerms"><a href="/html/fdcc3a57-94e0-40f8-aea1-47931c4b8449.htm">REPORT FORM Command</a></span>, <span class="linkTerms"><a href="/html/3876aeab-209d-42b0-9ebd-033284c74adb.htm">LABEL Command</a></span>, and <span class="linkTerms"><a href="/html/f5f90b33-e6ae-4139-9d13-be1495a87cf6.htm">CommandClauses Property</a></span>.</p>
            </div>
        </sections></div>
    </sections>
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/fac295a8-6391-437b-b8ff-42bc5e3f30cf.htm">GETPRINTER( ) Function</a></span><br /><span class="linkTerms"><a href="/html/fff52c13-b07a-48c8-b5bd-a7f0ca8c9f76.htm">PRINTSTATUS( ) Function</a></span><br /><span class="linkTerms"><a href="/html/fa62353f-661e-4ebd-ae13-bd056e76cb18.htm">SET DEVICE Command</a></span><br /><span class="linkTerms"><a href="/html/c3b802b8-87ab-4e20-ab4f-50d6c6c9f87a.htm">SET PRINTER Command</a></span><br /><span class="linkTerms"><a href="/html/634e3863-7f71-4868-b023-d0633240a541.htm">SYS( ) Functions Overview</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/e62ce8ab-f156-45d2-a0b9-11562e5dbcef.htm">Understanding and Extending Report Structure</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="SYS(1037) - Page Setup Dialog Box">
</OBJECT>
