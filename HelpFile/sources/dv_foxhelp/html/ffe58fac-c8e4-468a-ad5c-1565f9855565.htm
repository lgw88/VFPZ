<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Add User-Defined Objects to a Form</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Add User-Defined Objects to a Form</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>One of the most powerful features of Visual FoxPro is the ability to create classes that can easily be used and reused in various pieces of your applications. Once you've created classes, you can add them to your forms.</p>
  <div id="sectionSection0" class="seeAlsoNoToggleSection">
      <h3 class="procedureSubHeading">To add an object based on a custom class</h3><div class="subSection"><ul><li>
            
              <p>In the <span class="linkTerms"><a href="/html/93e1d13b-c029-47eb-b140-c119ff44f10d.htm">Project Manager Window</a></span>, drag the class onto the container.</p>
            
          </li></ul>
          
            <p>You can also add your classes directly from the Form Controls toolbar when you add them to your toolbar.</p>
          
        </div>
    </div><h1 class="heading">Adding Class Libraries to the Controls Toolbar</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>You need to register your class libraries before they can be displayed in the Form Controls toolbar.</p>
      <h3 class="procedureSubHeading">To register a class library</h3><div class="subSection"><ol><li>
            
              <p>From the <b>Tools</b> menu, choose <b>Options</b>.</p>
            
          </li><li>
            
              <p>In the <b>Options</b> dialog box, choose the <b>Controls</b> tab.</p>
            
          </li><li>
            
              <p>Choose <b>Add</b>.</p>
            
          </li><li>
            
              <p>In the <b>Open</b> dialog box, choose a class library to add to the <b>Selected</b> list and choose <b>Open</b>.</p>
            
          </li><li>
            
              <p>Repeat steps 3 and 4 until you've added all the libraries you want to register.</p>
            
          </li></ol></div>
      <p>Classes in the class libraries in the Selected list can be used in the <span class="linkTerms"><a href="/html/4c6826b0-d49e-4f97-b18c-4670533600c7.htm">Form Designer</a></span> as easily as Visual FoxPro base classes can be used.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
        <p>If you want the class libraries to be available from the Form Controls toolbar every time you run Visual FoxPro, choose Set as Default in the <a href="/html/a8286b0c-6b2c-4b8d-8e16-7db8dbda2a1f.htm">Options</a> dialog box.</p>
      </td></tr></table></div>
      <p>You can also register libraries directly in the <b>Form Designer</b>.</p>
      <h3 class="procedureSubHeading">To register a class library in the Form Designer</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Form Controls</b> toolbar, choose the <b>View Classes</b> button.</p>
            
          </li><li>
            
              <p>From the submenu, choose <b>Add</b>.</p>
            
          </li><li>
            
              <p>In the <b>Open</b> dialog box, choose a class library to add to the <b>Form Controls</b> toolbar and choose <b>Open</b>.</p>
            
          </li></ol></div>
    </div><h1 class="heading">Adding Objects to a Form from a Class Library</h1><div id="sectionSection2" class="seeAlsoNoToggleSection">
      <p>Once you've added class libraries in the Classes tab of the <b>Options</b> dialog box or from the View Classes submenu, you can access them in the <b>Form Designer</b>.</p>
      <h3 class="procedureSubHeading">To add a custom object from the Controls toolbar</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Form Controls</b> toolbar, choose the <b>View Classes</b> button.</p>
            
          </li><li>
            
              <p>From the list of registered class libraries, select the library that contains the control you want to add to the form. </p>
              <p>The toolbar is populated with the controls in the library you selected. </p>
            
          </li><li>
            
              <p>Click the control you want and drag it to size in the form. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>You can remove a visual class library from the View Classes toolbar menu by selecting the library in the Selected list in the Controls tab of the Options dialog box, and choosing Remove.</p>
              </td></tr></table></div>
            
          </li></ol></div>
      <p>When you add objects to a form based on anything other than the Visual FoxPro base classes, a relative path to the class library (.vcx file) is stored in the form's .scx file. If you move either the form or the class library to a different location, Visual FoxPro displays a dialog box when you try to run the form so that you can manually locate the class library.</p>
      <h3 class="procedureSubHeading">To determine how many controls are on a form</h3><div class="subSection"><ul><li>
            
              <p>Use the <span class="linkTerms"><a href="/html/e3f058b2-4f5f-4cf2-8fa5-43d2ea8bd4d6.htm">ControlCount Property</a></span>.</p>
            
          </li></ul></div>
      <p>The <a href="/html/07a8567e-e2d0-4829-9471-856f5c9e5a7f.htm">Controls</a> property of the form allows you to reference each control on the form. The following program prints the <a href="/html/9ada1ca6-61ed-4442-8359-f2984e5ac217.htm">Name</a> property of all the controls on the currently active form.</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>ACTIVATE SCREEN  &amp;&amp; to print to the main Visual FoxPro window
FOR nCnt = 1 TO Application.ActiveForm.ControlCount
   ? Application.ActiveForm.Controls[nCnt].Name
ENDFOR</pre></td></tr></table></span></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/fae15519-7db5-4d62-866b-38e93719a545.htm">How to: Add Properties and Methods to a Form</a></span><br /><span class="linkTerms"><a href="/html/d444bc8e-8a01-427d-94fb-23f7a6a7f221.htm">How to: Add Controls to a Form with the Component Gallery</a></span><br /><span class="linkTerms"><a href="/html/b9533037-6d0d-4731-a046-ca4c2a48099c.htm">How to: Add Controls to a Wizard-Generated Form</a></span><br /><span class="linkTerms"><a href="/html/17202290-738d-4572-965e-08a38f27ebbc.htm">How to: Select, Move, and Resize Form Controls</a></span><br /><span class="linkTerms"><a href="/html/7671a672-ad4e-4175-9607-2ed46af40740.htm">How to: Set Tab Order for Controls</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="#dgtskaddinguser-definedobjectstoform">How to: Add User-Defined Objects to a Form</a></span><br /><span class="linkTerms"><a href="/html/93e1d13b-c029-47eb-b140-c119ff44f10d.htm">Project Manager Window</a></span><br /><span class="linkTerms"><a href="/html/08dd172b-c34e-4fa6-bd40-4035419a3a21.htm">Aligning Controls in Forms</a></span><br /><h4 class="subHeading">Concepts</h4><span class="linkTerms"><a href="/html/8cf9459c-0430-48db-8271-769fa5db76d3.htm">Adding Objects to Forms</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/adb21354-5dde-4f55-b92a-df0c53810385.htm">Creating Forms</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Add User-Defined Objects to a Form">
</OBJECT>
