<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>VFPXMLProgID Property</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">VFPXMLProgID Property</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>References a COM component you can use to override the internal functionality of the <b>CURSORTOXML( )</b>, <b>XMLTOCURSOR( )</b>, and <b>XMLUPDATEGRAM( )</b> functions.</p>
    <p>You can create the COM component in Visual FoxPro, Visual C/C++, Visual Basic or any developer tool that creates COM components with the ability to implement interfaces.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
_VFP.VFPXMLProgID [=<span class="parameter">cValue</span>]</pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(returnValueToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(returnValueToggle)" tabindex="0"><img id="returnValueToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Return Value</span></h1><div id="returnValueSection" class="section" name="collapseableSection" style="display: none;">
    
      <dl><dt><span class="nonLinkTerms">
          <span class="parameter">cValue</span>
        </span></dt><dd>
          <p>Specifies the ProgID of the COM component class whose functions override the functionality of the listed Visual FoxPro XML functions. Setting <span class="parameter">cValue</span> to the default empty string ("") value resets use to the internal implementations of these functions.</p>
        </dd></dl>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>The class you use must implement the IVFPXML interface from the Visual FoxPro type library. To provide methods to overwrite, open the Object Browser from the Tools menu. From the Microsoft Visual FoxPro Type Library, drag the IVFPXML interface to a program (.prg) file.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">
    
      
        <p>The following example creates a classes that replace the <b>CURSORTOXML( )</b>, <b>XMLTOCURSOR( )</b>, and <b>XMLUPDATEGRAM( )</b> functions. Create a project for these classes and add custom XML function handler code to the three methods. <span class="parameter">VesrNum</span> represents the version number of Visual FoxPro.</p>
        <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE CLASS MyXMLClass AS session OLEPUBLIC
   IMPLEMENTS IVFPXMLVerNum IN "VisualFoxPro.Application.VerNum"
   * Replaces CURSORTOXML( ). 
   PROCEDURE IVFPXMLVerNum_CursorToXML(bstrAlias AS STRING, ; 
      nOutputFormat AS Number, nFlags AS Number, ; 
      nRecords AS Number, bstrOutputFile AS STRING, ; 
      bstrSchema AS STRING, bstrSchemaLocation AS STRING, ; 
      bstrNameSpace AS STRING, pVFP AS VARIANT) AS VARIANT ; 
      HELPSTRING "Converts from a Cursor to XML"
      * Add user code here.
   ENDPROC
   * Replaces XMLTOCURSOR( ).
   PROCEDURE IVFPXMLVerNum_XMLToCursor(pvarXMLSource AS VARIANT, ; 
      bstrCursorName AS STRING, nFlags AS Number, pVFP AS VARIANT) ; 
      AS Number HELPSTRING "Converts from XML to a Cursor"
      * Add user code here. 
   ENDPROC
   * Replaces XMLUPDATEGRAM( ).
   PROCEDURE IVFPXMLVerNum_XMLUpdateGramVerNum( nFlags AS Number, ; 
      bstrCursorList AS STRING, pVFP AS VARIANT , ; 
      bstrSchemaLocation AS STRING ) AS VARIANT; 
      HELPSTRING "Generates an XML UpdateGram"
      * Add user code here. 
   ENDPROC
   * Included for backward compatibility with previous 
   * versions of this interface.
   PROCEDURE IVFPXMLVerNum_XMLUpdateGram(nFlags AS Number, ; 
      bstrCursorList AS STRING, pVFP AS VARIANT) AS VARIANT; 
      HELPSTRING "Generates an XML UpdateGram"
      * Add user code here.
   ENDPROC
ENDDEFINE</pre></td></tr></table></span></div>
        <p>When you are finished, build the project into a dynamic-link library (.dll) or executable (.exe) file. Set the <b>VFPXMLProgID</b> property to the correct ProgID for your class. For example, if your project name is MyXMLProj, you would set <b>VFPXMLProgID</b> using the following line of code:</p>
        <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>_VFP.VFPXMLProgID = "MyXMLProj.MyXMLClass"</pre></td></tr></table></span></div>
        <p>With <b>_VFP VFPXMLProgID</b> set to a specific ProgID, calls to <b>CURSORTOXML( )</b>, <b>XMLTOCURSOR( )</b>, or <b>XMLUPDATEGRAM( )</b> are redirected to the corresponding method in the class specified by that ProgID. A reference to <b>_VFP</b> is also passed to the method, providing a way to access and manipulate data cursors and memory variables. For more information, see <a href="/html/1c5a055c-e392-427b-9264-c5f2c3337f78.htm">_VFP System Variable Properties, Methods, and Events</a>.</p>
        <p>Prior to Visual FoxPro 8.0, <b>XMLUPDATEGRAM( )</b> did not have the <span class="parameter">cSchemaLocation</span> parameter; therefore, the interface was different. Visual Foxpro supports both interfaces and looks for the current interface first. If unsuccessful, Visual FoxPro then looks for the earlier interface. </p>
        <p>The following is a sample class definition for the earlier interface without the <span class="parameter">cSchemaLocation</span> parameter:</p>
        <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>DEFINE CLASS MyXMLClass AS session OLEPUBLIC
   IMPLEMENTS IVFPXML IN "VisualFoxPro.Application.8"
   * Replaces CURSORTOXML( ). 
   PROCEDURE IVFPXML_CursorToXML(bstrAlias AS STRING, ; 
      nOutputFormat AS Number, nFlags AS Number, ; 
      nRecords AS Number, bstrOutputFile AS STRING, ; 
      bstrSchema AS STRING, bstrSchemaLocation AS STRING, ; 
      bstrNameSpace AS STRING, pVFP AS VARIANT) AS VARIANT ; 
      HELPSTRING "Converts from a Cursor to XML"
      * Add user code here. 
   ENDPROC
   * Replaces XMLTOCURSOR( ).
   PROCEDURE IVFPXML_XMLToCursor(pvarXMLSource AS VARIANT, ; 
      bstrCursorName AS STRING, nFlags AS Number, pVFP AS VARIANT) ; 
      AS Number HELPSTRING "Converts from XML to a Cursor"
      * Add user code here. 
   ENDPROC
   * Replaces XMLUPDATEGRAM( ).
   PROCEDURE IVFPXML_XMLUpdateGram(nFlags AS Number, ; 
      bstrCursorList AS STRING, pVFP AS VARIANT) AS VARIANT;
      HELPSTRING "Generates an XML UpdateGram"
      * Add user code here.
   ENDPROC
ENDDEFINE</pre></td></tr></table></span></div>
      
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/be797e96-7fe7-4ada-b422-3159dafb4e7b.htm">How to: View Type Library Information</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/76475ac4-b4cd-4ff9-8b7d-42bbb50f85e0.htm">_VFP System Variable</a></span><br /><span class="linkTerms"><a href="/html/eefa2d03-b928-46ae-a87b-676c3f0f6061.htm">XML Functions</a></span><br /><span class="linkTerms"><a href="/html/b53b14fa-c1b0-4c29-82b1-3149adf53073.htm">CURSORTOXML( ) Function</a></span><br /><span class="linkTerms"><a href="/html/887e0f56-7ff2-4877-89ff-9bbccde7f2d6.htm">XMLTOCURSOR( ) Function</a></span><br /><span class="linkTerms"><a href="/html/646e7dbb-d5e9-4017-b8a2-cb3625a818cb.htm">XMLUPDATEGRAM( ) Function</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/ee3cb1dc-11b6-434d-8d4d-7a91daa5097a.htm">Properties (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="VFPXMLProgID Property">
<param name="ALink Name" value="VFPXMLProgID">
</OBJECT>
