<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Add OLE Objects to Applications</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Add OLE Objects to Applications</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>You can add OLE objects to tables, forms, and reports. For more information about adding OLE objects to reports, see <span class="linkTerms"><a href="/html/b06185d5-f225-4c63-956e-0080f8fb224f.htm">How to: Add General Fields to Reports</a></span>. </p>
  <h1 class="heading">Adding OLE Objects to Tables</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>You can include Word documents in a table by creating General fields and adding the documents by linking or embedding them.</p>
      <h3 class="procedureSubHeading">To add an OLE object to a table</h3><div class="subSection"><ol><li>
            
              <p>Open the table in the <b>Table Designer</b>.</p>
            
          </li><li>
            
              <p>In the <b>Table Designer</b>, create a <b>General</b> field.</p>
            
          </li><li>
            
              <p>Open a browse window for the table.</p>
            
          </li><li>
            
              <p>Double-click the <b>General</b> field to open an editing window. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
                <p>You can also use the <b>MODIFY GENERAL</b> command.</p>
              </td></tr></table></div>
            
          </li><li>
            
              <p>On the <b>Edit</b> menu, click <b>Insert Object</b>.</p>
            
          </li></ol></div>
      <h3 class="procedureSubHeading">To add an OLE object to a table programmatically</h3><div class="subSection"><ul><li>
            
              <p>Use the <b>APPEND GENERAL</b> command.</p>
            
          </li></ul></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/a87efd8b-c338-4489-83a1-9f2c8d52abb8.htm">APPEND GENERAL Command</a></span>.</p>
      <p>You can use <b>APPEND GENERAL</b> to embed OLE objects or link to OLE objects created by applications such as Microsoft Excel and Word. These applications support both linking and embedding. However, some applications such as Microsoft Graph only support embedding. When you use the <b>APPEND GENERAL</b> command, you can import the OLE object from a file and insert it into a General field. If the field already contains an object, the new object replaces it.</p>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>Unlike <b>APPEND</b> and <b>APPEND BLANK</b>, <b>APPEND GENERAL</b> does not add a new record to the table.</p>
      </td></tr></table></div>
      <p>For example, suppose you have Microsoft Word files that you want to store in a Visual FoxPro table. If the table has a General field named <code>WordDoc</code>, you can embed the documents by using the following code:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CREATE TABLE oletable (name c(24), worddoc g)
CD GETDIR()
nFiles = ADIR(aWordFiles, "*.doc")
IF nFiles &gt; 0
   FOR i = 1 to nFiles
      APPEND BLANK
      REPLACE Oletable.Name WITH aWordFiles(i,1)
      APPEND GENERAL WordDoc FROM aWordFiles(i,1)
   ENDFOR
ELSE
   MESSAGEBOX("No Word files found.")
ENDIF</pre></td></tr></table></span></div>
      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
        <p>The preceding example looks only for files ending in .doc, the standard extension used by Word files. Because Microsoft Word and OLE are aware of this, the files are automatically associated with the Word server when you use <b>APPEND GENERAL</b>.</p>
      </td></tr></table></div>
      <p>If you use a different extension than the one expected by the server, you must declare the class of the server, using the <b>CLASS</b> clause. For example, if you add the class for Word to the previous example, the code becomes:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>APPEND GENERAL WordDoc FROM wordfiles(i,1) CLASS "Word.Document"</pre></td></tr></table></span></div>
      <p>If you have files with common extensions (for example, .bmp) that other servers might use, you can use the <b>CLASS</b> clause to specify the particular server you want to use for those files. Alternatively, if you'd rather link than embed objects, use the <b>LINK</b> keyword, as in the following example:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>APPEND GENERAL WordDoc FROM wordfiles(i,1) LINK CLASS "Word.Document"</pre></td></tr></table></span></div>
      <p>In addition, you can replace data in an object by using the <b>DATA</b> keyword of <b>APPEND GENERAL</b>.</p>
    </div><h1 class="heading">Adding OLE Objects to Forms</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>Using the Form Designer, you can add insertable OLE objects to forms with the OLE Container control. In addition, you can display OLE objects from General fields by using the OLE Bound control. When you add an OLE object to a form in either the OLE Container control or the OLE Bound control, you have more control over the opening and editing of the object.</p>
      <p>You can determine whether the OLE object is opened or edited when the control gets the focus or when the user double-clicks the control by setting the <b>AutoActivate</b> property of an OLE bound or container control. The <b>AutoVerbMenu</b> property specifies whether the shortcut menu of the ActiveX control allows a user to open or edit the OLE object. To control access so that the OLE object can only be opened or edited programmatically with the <b>DoVerb</b> method, set <b>AutoActivate</b> to 0 - Manual and <b>AutoVerbMenu</b> to false (.F.). </p>
      <h3 class="procedureSubHeading">To add an OLE object to a form</h3><div class="subSection"><ol><li>
            
              <p>In the Form Designer, add an OLE Container control to your form. The <b>Insert Object</b> dialog box opens.</p>
            
          </li><li>
            
              <p>In the Insert Object dialog box, select <b>Create New</b> or <b>Create from File</b>.</p>
            
          </li><li>
            
              <p>Choose the appropriate OLE object from the <b>Object Type</b> list.</p>
            
          </li></ol></div>
      <p>You can also customize the Form Controls toolbar so that you can directly add specific OLE objects.</p>
      <h3 class="procedureSubHeading">To add OLE objects to the Form Controls toolbar</h3><div class="subSection"><ol><li>
            
              <p>From the <b>Tools</b> menu, choose <b>Options.</b></p>
            
          </li><li>
            
              <p>In the Controls tab of the <b>Options</b> dialog box, choose <b>ActiveX controls</b>.</p>
            
          </li><li>
            
              <p>In the <b>Selected</b> list, select the OLE objects and ActiveX controls you want to be available from the <b>Form Controls</b> toolbar.</p>
            
          </li><li>
            
              <p>Choose <b>Set as Default</b>, and then choose <b>OK</b>.</p>
            
          </li><li>
            
              <p>In the <b>Form Controls</b> toolbar, choose <b>View Classes</b>, and then choose <b>ActiveX Controls</b>.</p>
            
          </li></ol></div>
      <h3 class="procedureSubHeading">To display an OLE object from a General field</h3><div class="subSection"><ol><li>
            
              <p>In the Form Designer, add an OLE Bound control to your form.</p>
            
          </li><li>
            
              <p>Specify the General field that contains the data by setting the object's ControlSource property. </p>
              <p>For example, if the table name is <code>Inventory</code> and the General field name is <code>Current</code>, then set the ControlSource property to <code>Inventory.Current</code>. </p>
            
          </li></ol></div>
      <p>You can also display an OLE object from a General field programmatically:</p>
      <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
            <th>
              Code
            </th>
            <th>
              Comments
            </th>
          </tr><tr>
          <td>
            <p>
              <code>frm1 = CREATEOBJECT("form")</code>
            </p>
          </td>
          <td>
            <p>Create form.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <code>frm1.ADDOBJECT("olb1",</code>
            </p>
            <p>
              <code>"oleboundcontrol")</code>
            </p>
          </td>
          <td>
            <p>Add control.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <code>frm1.olb1.ControlSource = </code>
            </p>
            <p>
              <code>"Inventory.Current"</code>
            </p>
          </td>
          <td>
            <p>Bind the data to the control.</p>
          </td>
        </tr><tr>
          <td>
            <p>
              <code>frm1.olb1.Visible = .T.</code>
            </p>
            <p>
              <code>frm1.Visible = .T.</code>
            </p>
            <p>
            </p>
          </td>
          <td>
            <p>Make the control and form visible.</p>
          </td>
        </tr></table></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/573d7080-0736-4f7b-b2f5-11e7ea317767.htm">How to: Edit OLE Objects in Forms and Tables</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/4cf51b8a-236d-4906-8593-3bfb00f408da.htm">Working with OLE Objects</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Add OLE Objects to Applications">
</OBJECT>
