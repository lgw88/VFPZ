<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>LABEL Command</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">
      
      
    </img>
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">
      
      
    </img>
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">
      
      
    </img>
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">LABEL Command</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">
                
                
              </img>
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">
                Collapse All
              </label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">
                Expand All
              </label> </span>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Sends labels from a label file (lbx) to the specified output. </p>
    <p>The <b>LABEL</b> command can interpret Visual FoxPro report files (.frx format) as well as label files.  You can also use <b>LABEL</b> to run character-based label files created in FoxPro for MS-DOS.</p>
  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>
LABEL [FORM <span class="parameter">FileName1</span> | FORM ?] [ENVIRONMENT] [<span class="parameter">Scope</span>]
   [FOR <span class="parameter">lExpression1</span>] [WHILE <span class="parameter">lExpression2</span>] [NOOPTIMIZE]
   [RANGE <span class="parameter">nStartPage</span> [, <span class="parameter">nEndPage</span>]]
   [NOCONSOLE | OFF ] [SAMPLE] [PDSETUP]
   [NAME <span class="parameter">ObjectName</span>]
   [OBJECT <span class="parameter">oReportListener</span> | TYPE <span class="parameter">iExpression</span>]
   [TO PRINTER [PROMPT] | TO FILE <span class="parameter">FileName2</span>]
   [PREVIEW [<span class="parameter">PreviewDestination</span>] [NOWAIT] [WINDOW <span class="parameter">WindowName</span>]]</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>
    
      <dl><dt><span class="nonLinkTerms">[FORM <span class="parameter">FileName1 </span>| FORM ?] </span></dt><dd>
          <p>Specifies the name of the label file or displays the <b>Open</b> dialog box so you can select an existing label file. The default file name extension for labels is .lbx. </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>If the label file is on a drive or volume other than the default or in a directory other than the current directory, you must also specify the drive and directory. </p>
          </td></tr></table></div>
          <p>Calling <b>LABEL</b> without arguments opens the <b>Open</b> dialog box. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[ENVIRONMENT] </span></dt><dd>
          <p>Included for backward compatibility with 2.<span class="parameter">x</span> labels. For more information, see <span class="linkTerms"><a href="/html/856645aa-548d-479d-9d18-25394efae3de.htm">Controlling Data in Reports</a></span>.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
            <p>You can restore the data environment associated with a Visual FoxPro label by setting the data environment's <b>AutoOpenTables</b> property to True (.T.). To make sure that the label environment closes when the label finishes printing, set the <b>AutoCloseTables</b> property to True (.T.). For more information, see <span class="linkTerms"><a href="/html/2d8c85b7-9aac-4c20-9ca0-7a1eec2efede.htm">AutoOpenTables Property</a></span> and <span class="linkTerms"><a href="/html/f9177a4d-e35c-487a-a458-700e537fe4c7.htm">AutoCloseTables Property</a></span>.</p>
          </td></tr></table></div>
        </dd></dl><dl><dt><span class="nonLinkTerms">[<span class="parameter">Scope</span>] </span></dt><dd>
          <p>Specifies a range of records. Includes only the records that fall within the range. The scope clauses are: <b>ALL</b>, <b>NEXT</b> &lt;<span class="parameter">nRecords</span>&gt;, <b>RECORD</b> &lt;<span class="parameter">nRecordNumber</span>&gt;, and <b>REST</b>. The default scope for <b>LABEL</b> is <b>ALL</b> records. </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p> When you include a <span class="parameter">Scope</span> clause, the scope operates only on the table in the active work area.</p>
          </td></tr></table></div>
          <p>For more information on scope clauses, see <span class="linkTerms"><a href="/html/c8d51e13-0119-4fc5-a0df-b6a9ab7997bb.htm">Scope Clauses</a></span>.  </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[FOR <span class="parameter">lExpression1</span>] </span></dt><dd>
          <p>Specifies a condition whereby only the records that satisfy the logical condition <span class="parameter">lExpression1</span> are included. This argument allows you to filter out records you do not want to include.</p>
          <p>Rushmore Query Optimization optimizes a query created with <b>LABEL ... FOR</b> if <span class="parameter">lExpression1</span> is an optimizable expression. For best performance, use an optimizable expression in the <b>FOR</b> clause.   </p>
          <p>For more information, see <span class="linkTerms"><a href="/html/aeb46b6a-783a-4194-ac8d-c46cfb8e9eee.htm">SET OPTIMIZE Command</a></span> and <span class="linkTerms"><a href="/html/e7c36f99-0993-40a7-be80-0717cbe85b8c.htm">Using Rushmore Query Optimization to Speed Data Access</a></span>. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[WHILE <span class="parameter">lExpression2</span>] </span></dt><dd>
          <p>Specifies a condition where records are included while the logical expression <span class="parameter">lExpression2</span> evaluates to True (.T.).</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[NOOPTIMIZE] </span></dt><dd>
          <p>Disables Rushmore Query Optimization of <b>LABEL</b>. </p>
          <p>For more information, see <span class="linkTerms"><a href="/html/aeb46b6a-783a-4194-ac8d-c46cfb8e9eee.htm">SET OPTIMIZE Command</a></span> and <span class="linkTerms"><a href="/html/e7c36f99-0993-40a7-be80-0717cbe85b8c.htm">Using Rushmore Query Optimization to Speed Data Access</a></span>. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[RANGE <span class="parameter">nStartPage </span>[, <span class="parameter">nEndPage</span>]] </span></dt><dd>
          <p>Specifies a range of pages to print or other output. </p>
          <p>The <span class="parameter">nStartPage</span> parameter specifies the first page to print, while the <span class="parameter">nEndPage</span> parameter specifies the last page to print. If <span class="parameter">nEndPage</span> is omitted, the last page to print defaults to 32,767. </p>
          <p>
            <b>RANGE</b> selects pages for output, while scope clauses, <b>FOR</b>, and <b>WHILE</b> clauses select records. These selection criteria do not have an effect if you choose to print from preview, unless you have specified <i>object-assisted mode</i> by using the <b>OBJECT</b> clause or <b>SET REPORTBEHAVIOR 90</b>.  In object-assisted mode, you can print either the full <b>RANGE</b> you specified on the original <b>LABEL</b> command or some subset of that page range, using the ReportListener.CommandClauses's PrintPageCurrent, PrintRangeFrom, and PrintRangeTo members.  For more information, see <span class="linkTerms"><a href="/html/481b543d-7a57-4a98-91ed-96ec3bac29ca.htm">OnPreviewClose Method</a></span>.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[NOCONSOLE | OFF] </span></dt><dd>
          <p>Suppresses displaying labels in the main Visual FoxPro window or a user-defined window when printing labels or sending them to a file.</p>
          <p>When you use Visual FoxPro 9.0's object-assisted output mode, <b>LABEL</b> does not display the contents of your label to the current output window, so the <b>NOCONSOLE</b> and <b>OFF</b> keywords have no effect on native behavior.  However, the keywords are available in the ReportListener.CommandClauses object.  You can evaluate them in your ReportListener derived classes, and opt to suppress a display of label content or other user feedback based on their contents.  For more information, see <span class="linkTerms"><a href="/html/f5f90b33-e6ae-4139-9d13-be1495a87cf6.htm">CommandClauses Property</a></span>. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[SAMPLE]</span></dt><dd>
          <p>If you use character-based labels created in FoxPro for MS-DOS, <b>SAMPLE</b> can be used to test label alignment. The record pointer does not move during <b>SAMPLE</b> alignment tests  If you use the <b>SAMPLE</b> keyword, the prompt <b>Do you want more samples?</b> appears after a sample label prints. Choose <b>Yes</b> to retest your label alignment.  </p>
          <p>
            <b>SAMPLE</b> is ignored for graphics-based labels created in Visual FoxPro.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[PDSETUP] </span></dt><dd>
          <p>Loads a printer driver setup.</p>
          <p>You can include <b>PDSETUP</b> to use a printer driver setup for printing character-based labels created in FoxPro for MS-DOS. <b>PDSETUP</b> is ignored when you print graphics-based labels created in Visual FoxPro. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[NAME <span class="parameter">ObjectName</span>] </span></dt><dd>
          <p>Specifies an object variable name for the data environment of a label. The data environment and the objects in the data environment have properties and methods, for example <b>AddObject</b>, that need to be set or called at run time. The object variable provides access to these properties and methods. If you omit the <b>NAME</b> clause, Visual FoxPro uses as a default the name of the label file that can be referenced in the code associated with the events.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[OBJECT <span class="parameter">oReportListener</span> | TYPE <span class="parameter">iExpression </span>]</span></dt><dd>
          <p>Invokes Visual FoxPro's object-assisted output mode.  Use either an object reference to an object derived from the ReportListener base class, or a numeric value specifying a type of output.  For more information, see <span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span>, <span class="linkTerms"><a href="/html/ad1bf074-a169-4fd4-b160-c39bdd8c8402.htm">ListenerType Property</a></span>, and <span class="linkTerms"><a href="/html/1886c1da-b3df-4833-a768-980bdd34a364.htm">OutputType Property (Visual FoxPro)</a></span>.</p>
          <p>The <b>OBJECT</b> clause on an individual <b>LABEL</b> command takes precedence over the current setting of <b>SET REPORTBEHAVIOR</b>. </p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[TO PRINTER [PROMPT] | TO [FILE] <span class="parameter">FileName2</span> [[ADDITIVE] ASCII]</span></dt><dd>
          <p>Sends the label file to the printer or sends labels to a text file specified with <span class="parameter">FileName2</span> with the default file name extension of .txt.</p>
          <p>The <b>PROMPT</b> keyword displays the <b>Print</b> dialog box before printing starts.  In object-assisted mode, the options enabled in the <b>Print</b> dialog box are affected by the ReportListener.CommandClauses.PrintPageCurrent member value.</p>
          <p>When you omit the <b>ASCII</b> keyword or use Visual FoxPro's object-assisted output mode writes PostScript or other printer codes to the text file along with the content of your label layout. To create an ASCII text file from the label definition file, <b>SET REPORTBEHAVIOR 80</b> and include the <b>ASCII</b> keyword. </p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
            <p>When you include the <b>ASCII</b> keyword, you can process labels on a computer that has no printer driver setups installed.  Without the <b>ASCII</b> keyword, a <b>LABEL</b> command issued on a computer that has no printer driver setups installed generates an error.</p>
          </td></tr></table></div>
          <p>An ASCII file contains only text.  Any font or color settings, graphics, lines, rectangles, or rounded rectangles in the label definition file do not appear in the ASCII text file.</p>
          <p>To append new content to an ASCII file instead of overwriting it, precede the <b>ASCII</b> keyword with the <b>ADDITIVE</b> keyword. The <b>ADDITIVE</b> and <b>ASCII</b> keywords must be specified in the order shown.  </p>
          <p>Omitting the <b>ASCII</b> keyword or using Visual FoxPro's object-assisted output mode writes PostScript or other printer codes to the text file.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">[PREVIEW [<span class="parameter">PreviewDestination</span>] [NOWAIT] [WINDOW <span class="parameter">WindowName</span>]]</span></dt><dd>
          <p>Displays the labels in a preview window instead of printing the labels. By default, the preview window is modal but provides access to the <b>Print Preview</b> toolbar. The <b>NOWAIT</b> keyword specifies that Visual FoxPro does not wait at run time for the preview window to close before continuing program execution.</p>
          <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Tip </th></tr><tr><td>
            <p>Character-based reports and labels created in FoxPro MS-DOS have a special character-based preview window.  This mechanism is not affected by <b>SET REPORTBEHAVIOR</b> and does not support the <b>OBJECT</b> clause or <b>WINDOW</b>-related clauses.</p>
          </td></tr></table></div>
          <p>If you include <b>WINDOW</b> &lt;<span class="parameter">WindowName</span>&gt;, the preview window assumes the characteristics of the window, such as title, size, and so on, you specify with <span class="parameter">WindowName</span>.  <span class="parameter">WindowName</span> can be the name property of a form object, or it can be a variable referencing a window created with <b>DEFINE WINDOW</b>. For more information, see <span class="linkTerms"><a href="/html/400d1a36-63d5-496d-a54d-a57c2632f4ae.htm">DEFINE WINDOW Command</a></span>.</p>
          <p>The following table describes possible values for <span class="parameter">PreviewDestination</span>.  You can use the <b>WINDOW</b> clause alone or in combination with either <span class="parameter">PreviewDestination</span>.</p>
          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>
                <th>
                  
                    <b>PreviewDestination</b>
                  
                </th>
                <th>
                  
                    <b>Description</b>
                  
                </th>
              </tr><tr>
              <td>
                <p>[IN WINDOW <span class="parameter">WindowName</span>]</p>
              </td>
              <td>
                <p>Specifies a window for previewing a label layout. </p>
                <p>If you include <b>IN WINDOW</b> &lt;<span class="parameter">WindowName</span>&gt;, the label is previewed in the window you specify with <span class="parameter">WindowName</span>.  </p>
              </td>
            </tr><tr>
              <td>
                <p>IN SCREEN</p>
              </td>
              <td>
                <p>Specifies that the preview displays in the main Visual FoxPro window and cannot be moved outside it.</p>
              </td>
            </tr></table></div>
          <p>
          </p>
        </dd></dl>
    
  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">
    
      <p>You can create label files using the <span class="linkTerms"><a href="/html/3c68d83b-9a6c-4990-8361-79d3110c6c27.htm">CREATE LABEL Command</a></span> or <span class="linkTerms"><a href="/html/115e76bd-e92b-4f2f-a851-c35d8e88da56.htm">MODIFY LABEL Command</a></span>.</p>
      <p>When you use Visual FoxPro's object-assisted output mode, all the clauses of the <b>LABEL FORM</b> command are available to your ReportListener in its CommandClauses member object, with the exception of record selection clauses (scope, <b>FOR</b>, and <b>WHILE</b>).  You can use the CommandClauses.RecordTotal attribute for information about the scope of the label run, or assign these values to your ReportListener object before running your labels.  The <span class="linkTerms"><a href="/html/f5f90b33-e6ae-4139-9d13-be1495a87cf6.htm">CommandClauses Property</a></span> topic gives you more information about how each clause is represented in the CommandClauses member object.</p>
    
  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/5709df40-166a-439b-8d9a-9504c1f631c1.htm">ReportListener Object</a></span><br /><span class="linkTerms"><a href="/html/5d6e4527-8b6f-4f39-a670-c3397eff3bfd.htm">SET REPORTBEHAVIOR Command</a></span><br /><span class="linkTerms"><a href="/html/fdcc3a57-94e0-40f8-aea1-47931c4b8449.htm">REPORT FORM Command</a></span><br /><span class="linkTerms"><a href="/html/66975043-814c-4886-901c-53d3924ca1bb.htm">The Preview Container API</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/fd877c13-ade8-475e-bac3-d74115e43ce8.htm">Working with Reports</a></span><br /><span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="LABEL Command">
<param name="ALink Name" value="LABEL">
</OBJECT>
