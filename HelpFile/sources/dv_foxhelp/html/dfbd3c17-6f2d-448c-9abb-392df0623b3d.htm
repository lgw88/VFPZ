<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Define Query Results</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Define Query Results</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>After you have opened the Query Designer and selected the table or view that contains the information you want, you can define your results. At a minimum, you need to select the fields you want. You can also define your results by setting the order the selected fields appear and setting filters to select which records appear.</p>
  <h1 class="heading">Selecting Fields You Want</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>Before you can run a query, you must select some fields to include in the results. In some cases, you might want to use all the fields from the table or view. At other times, you might want to focus the query on a few selected fields, such as fields you want to include in a report.</p>
      <p>Be sure to include any fields you might want to use to sort or group the results of your query. When you select the fields, you can also set the order they appear in your output.</p>
      <p>Use the Fields tab in the lower pane of the Query Designer to select the fields you want to include in the results of your query.</p>
      <h3 class="procedureSubHeading">To add a field to the query output</h3><div class="subSection"><ul><li>
            
              <p>Select the name of the field and choose <b>Add</b>. </p>
              <p>-or- </p>
            
          </li><li>
            
              <p>Drag the field name to the <b>Selected fields</b> box.</p>
            
          </li></ul></div>
    <sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <h3 class="subHeading" xmlns="">Selecting All Fields for Output</h3><div class="subSection" xmlns="">
          <p>You can select all of the fields by name or use the asterisk wild card. If you select the fields by name, the exact names of the fields are included in the query. If you run the query after adding fields to the table, the new fields are not included in the results.</p>
          <p>If you use the wild card, the asterisk is included in the query and includes all fields that are in the table at the time of the query. If the table structure has changed since the query was created, the new fields also appear in the query results.</p>
          <h3 class="procedureSubHeading">To add all available fields to a query at once</h3><div class="subSection"><ul><li>
                
                  <p>Choose <b>Add All </b>to add fields by name. </p>
                  <p>-or- </p>
                
              </li><li>
                
                  <p>Drag the asterisk at the top of the table into the <b>Selected fields</b> box.</p>
                
              </li></ul></div>
        </div>
      <h3 class="subHeading" xmlns="">Displaying an Alias for a Field</h3><div class="subSection" xmlns="">
          <p>You can make your query results easier to read and understand by adding a descriptive caption to a results field. For example, you might want to display the word "SumMaxOrd" at the top of the results column instead of the field name or expression, SUM(MaxOrdAmount).</p>
          <h3 class="procedureSubHeading">To add an alias for a field</h3><div class="subSection"><ol><li>
                
                  <p>In the <b>Functions and expressions</b> box, type the field name, and then type <b>AS</b> and the alias, as in this example: </p>
                  <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SUM(maxorderamt) AS SumMaxOrd</pre></td></tr></table></span></div>
                
              </li><li>
                
                  <p>Choose <b>Add</b> to place the field with the alias in the <b>Selected fields</b> box.</p>
                
              </li></ol></div>
        </div>
    </sections></div><h1 class="heading">Setting the Order for Output Fields</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>The order that fields appear in the Fields tab determines the order of the columns of information in your query output.</p>
      <h3 class="procedureSubHeading">To change the column order of the query output</h3><div class="subSection"><ul><li>
            
              <p>Drag the mover box, located to the left of a field name, up or down.</p>
            
          </li></ul></div>
      <p>If you want to change the order that rows of information will be sorted, use the Order By tab instead.</p>
    </div><h1 class="heading">Selecting the Records You Want</h1><div id="sectionSection2" class="seeAlsoNoToggleSection">
      <p>Selecting the records you want to find is the key step that determines the results of your query. With the Filter tab in the Query Designer, you can formulate the WHERE clause of a select statement to tell Visual FoxPro which records to search for and retrieve.</p>
      <p>You may want to find a specific subset of data to include in a report or other output: for example, all customers with outstanding balances, all customers in a specific region or postal code, and so on. To see only the records you want, enter a value or range of values to compare the records against.</p>
      <p>In Visual FoxPro, you use the Filter tab to specify which field you want to use for selecting records, choose a comparison criterion, and enter an example of the value you want the field to be compared to.</p>
      <h3 class="procedureSubHeading">To specify a filter</h3><div class="subSection"><ol><li>
            
              <p>From the <b>Field Name</b> list, choose a field you want to use as the basis for selecting records. </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
                <p>You can't use General or Memo fields in a filter.</p>
              </td></tr></table></div>
            
          </li><li>
            
              <p>From the <b>Criteria</b> list, choose the type of comparison to use.</p>
            
          </li><li>
            
              <p>Enter the comparison criterion in the <b>Example</b> box. </p>
              <ul><li>
                  <p>Use quotation marks only if the string is the same as the name of a field in a table in the query; otherwise, do not enclose character strings in quotation marks.</p>
                </li><li>
                  <p>If you use dates, do not enclose them in braces.</p>
                </li><li>
                  <p>Place a period before and after a logical literal (.T.).</p>
                </li><li>
                  <p>If you enter a field name from a table in the query, Visual FoxPro will recognize it as a field.</p>
                </li></ul>
            
          </li><li>
            
              <p>If you want capitalization to be ignored in searches on character data, select the <b>Case</b> button.</p>
            
          </li></ol></div>
      <p>If you want to reverse the meaning of a logical operator, select the <b>Not</b> button. For example, if you want to find customers in all regions <i>except</i> Washington, use the selection expression in the following example:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>Customer.region Not Like WA</pre></td></tr></table></span></div>
      <p>To further tune your search, you can add more filters in the <a href="/html/0fc4c7c3-ee77-400c-86f7-0bc0c78f6543.htm">Filter tab</a>. For more information, see "Fine-Tuning Your Search" in <span class="linkTerms"><a href="/html/b88036cd-3320-4ef0-aea1-985a34ab5c2a.htm">How to: Customize Queries</a></span>.</p>
      <p>If you are using more than one table or view in your query, you can expand the records you select by the join type you choose.</p>
    </div><h1 class="heading">Selecting a Number or Percentage of Records</h1><div id="sectionSection3" class="seeAlsoNoToggleSection">
      <p>If you only need a certain number or percentage of records from the result set that your query returns, you can use the Top options on the Miscellaneous tab in the Query Designer or View Designer, or you can add a <b>TOP</b> clause to your SQL <b>SELECT</b> statement. You can provide a number from 1 to 32,767 or a percentage from 0.01 to 99.99 in a <b>TOP</b> clause. Visual FoxPro sorts records first and then extracts the top number or percent of records.</p>
      <h3 class="procedureSubHeading">To limit the number of records to retrieve</h3><div class="subSection"><ol><li>
            
              <p>In the <b>Query Designer</b>, select the <b>Miscellaneous</b> tab.</p>
            
          </li><li>
            
              <p>In the <b>Top</b> area, clear the <b>All</b> box to make other options in the <b>Top</b> area available.</p>
            
          </li><li>
            
              <p>Choose one of the following: </p>
              <ul><li>
                  <p>In the <b>Number of records</b> box, type or select the maximum number of records you want to retrieve.</p>
                </li></ul>
              <p>-OR-  </p>
              <ul><li>
                  <p>Click <b>Percent</b> to change the <b>Number of records</b> box to <b>Percentage</b> so you can type or select the maximum percentage of records you want to retrieve.</p>
                </li></ul>
            
          </li></ol></div>
      <p>For example, if you want to select the top 10 customers with the highest order amounts, you can specify a GROUP BY on CUST_ID to show one aggregate record for each customer and sort by ORDER_AMT in the ORDER BY clause. To get a true TOP 10, you need to specify a descending sort on the ORDER_AMT so that the records with the highest order amounts appear first in the results. If you use an ascending sort, the result records are ordered from the least order amount to the most. The top records you select from the result set would actually have the lowest values.</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>SELECT TOP 10 *;
FROM testdata!customer INNER JOIN testdata!orders ;
ON Customer.cust_id = Orders.cust_id;
GROUP BY Customer.cust_id;
ORDER BY Orders.order_amt DESC</pre></td></tr></table></span></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/f5b2d063-c8c2-4ada-bf3a-b599409cb41c.htm">How to: Create Queries (Visual FoxPro)</a></span><br /><span class="linkTerms"><a href="/html/93c91a44-e3d4-45b5-8d74-2539538a95a6.htm">How to: Organize Query Results</a></span><br /><span class="linkTerms"><a href="/html/11c1bca1-5871-4d98-812f-2cacc479feee.htm">How to: Query Multiple Tables and Views</a></span><br /><span class="linkTerms"><a href="/html/bb470e80-7893-4ca8-91bf-613c5f3eabb6.htm">How to: Update Data in a View</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/9470fb56-5444-40c1-bc5e-4e9d2adf88b7.htm">Fields Tab, Query and View Designers</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/ccb3a0ad-7fe4-4267-ba42-aa9918ed1f21.htm">Working with Queries</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="How to: Define Query Results">
</OBJECT>
