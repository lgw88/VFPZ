<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>Update Criteria Tab, View Designer</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">
      
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">
      
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">
      
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">
      
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Update Criteria Tab, View Designer</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">
              See Also
            </a>
          </td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- VFPX languageFilterToolTip removed -->
          </td>
        </tr>
      </table>
      <!-- VFPX languageSpan removed-->
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>Specifies conditions for sending changes in the view to the original records in the tables used in the view. The Update Criteria tab appears only in the View Designer.   </p>
    <dl><dt><span class="nonLinkTerms">
        <b>Table</b>
      </span></dt><dd>
        <p>Specifies which tables used in the view can accept changes. The list shows the tables that have fields in the Selected fields list of the <a href="/html/9470fb56-5444-40c1-bc5e-4e9d2adf88b7.htm">Fields Tab, Query and View Designers</a>.</p>
      </dd></dl><dl><dt><span class="nonLinkTerms">
        <b>Reset Key</b>
      </span></dt><dd>
        <p>Selects the primary key field from each table as the key fields for the view and places a check mark under the key symbol in the Field name list for each primary key field. Key fields are used for matching the changes in the view to the original record in the table.</p>
      </dd></dl><dl><dt><span class="nonLinkTerms">
        <b>Update All</b>
      </span></dt><dd>
        <p>Selects all fields other than the key fields for updating and places a check mark under the pencil symbol in the Field name list.</p>
      </dd></dl><dl><dt><span class="nonLinkTerms">
        <b>Send SQL Updates</b>
      </span></dt><dd>
        <p>Specifies whether changes to the records in the view are actually sent to the original tables.</p>
      </dd></dl><dl><dt><span class="nonLinkTerms">
        <b>Field Name Pane</b>
      </span></dt><dd>
        <p>Shows the fields that you have selected for output and, therefore, are available to update.</p>
        <ul><li>
            <p>
              <b>Key Field (marked with a key symbol)</b>   Specifies whether the field is a key field.</p>
          </li><li>
            <p>
              <b>Updatable (marked with a pencil symbol)</b>   Specifies whether the field is updatable.</p>
          </li><li>
            <p>
              <b>Field Name</b>   Displays the name of the output fields available to mark as key fields or updatable.</p>
          </li></ul>
      </dd></dl>
  <h1 class="heading">SQL WHERE Clause Includes</h1><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>Controls which fields are added to the WHERE clause to detect update conflicts on the server when the changes to the view are sent to the original tables. </p>
      <p>A conflict is based on a comparison between the old values in the view, OLDVAL( ), and the current values in the original table, CURVAL( ). If the values are equal, the original table is considered unchanged and no conflict exists. If they are not equal, a conflict exists and the data source returns an error.</p>
      <p>The error returned for a conflict between the old value and the current value is Error 1585 "Record has been modified by another" or Error 1494 "Update conflict. Use TABLEUPDATE( ) to force the update or TABLEREVERT( ) to rollback".  </p>
      <dl><dt><span class="nonLinkTerms">
          <b>Key Fields Only</b>
        </span></dt><dd>
          <p>Sets the WHERE clause to detect a conflict if a key field has been changed in the original table. Changes made by another user to any other field in the original record of the table are not compared.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <b>Key and Updatable Fields</b>
        </span></dt><dd>
          <p>Sets the WHERE clause to detect a conflict if another user changed any of the fields that were updatable.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <b>Key and Modified Fields</b>
        </span></dt><dd>
          <p>Sets the WHERE clause to detect a conflict if the key field or one of the modified fields in the record in the original table has changed since the view was first retrieved (default).</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <b>Key and Timestamp</b>
        </span></dt><dd>
          <p>Sets the WHERE clause to detect a conflict if the timestamp of the record on the original table has changed since it was first retrieved. This option is only available if the remote table has a timestamp column.</p>
        </dd></dl>
    </div><h1 class="heading">Update Using</h1><div id="sectionSection1" class="seeAlsoNoToggleSection">
      <p>Specifies how updates are performed on the back-end server.  </p>
      <dl><dt><span class="nonLinkTerms">
          <b>SQL DELETE then INSERT</b>
        </span></dt><dd>
          <p>Deletes the record from the original table, and then creates a new record from the modified record in the view.</p>
        </dd></dl><dl><dt><span class="nonLinkTerms">
          <b>SQL UPDATE</b>
        </span></dt><dd>
          <p>Uses the changes in the fields of the view to modify the fields in the original table.</p>
        </dd></dl>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/9470fb56-5444-40c1-bc5e-4e9d2adf88b7.htm">Fields Tab, Query and View Designers</a></span><br /><span class="linkTerms"><a href="/html/0fc4c7c3-ee77-400c-86f7-0bc0c78f6543.htm">Filter Tab, Query and View Designers</a></span><br /><span class="linkTerms"><a href="/html/07b83296-0be5-4adb-83b9-542cb97931a2.htm">Group By Tab, Query and View Designers</a></span><br /><span class="linkTerms"><a href="/html/cf658adc-be9b-4004-8bfd-875466ab2718.htm">Order By Tab, Query and View Designers</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/d9f7a435-663d-4523-9511-c847be4311ca.htm">Query and View Designers</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <!-- VFPX Footer-->
<div>
<img src="../local/vfpXnote.gif" style="float: left; border:0; margin-right:8px;">Microsoft Visual FoxPro 9 SP2 Help file, VFPX Edition v1.08<br />
<a href="https://github.com/VFPX/HelpFile/issues" target="_blank">Send feedback</a> on this topic to the <a href="https://github.com/VFPX/HelpFile/" target="_blank">VFPX Help file project team</a>.<br />
2009-2017 Placed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons licensing</a> by Microsoft Corporation. 
<noscript><p class="vfpx" style="color:#FF0000">&nbsp;&nbsp;<b>Not all help features are available because JavaScript is disabled on this computer!</b></p></noscript>
</div>
<!-- VFPX Footer-->
      </div>
    </div>
  </body>
</html>
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="ALink Name" value="Update Criteria Tab, View Designer">
<param name="Alink Name" value="vfp.30000019">
<param name="Alink Name" value="vfp.30000064">
</OBJECT>
