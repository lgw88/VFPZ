Clear Set Default To Justpath(  Sys(16)  )If !File("crypto.dll") Then     ?"调用库不存在"Endif Local lnHstimem.lnHstime = Seconds()*-- 关于AES加密解可参照：https://lzltool.cn/AES *PaddingMode #Define None				0		&& NoPadding #Define PKCS7				1		&& PKCS7		暂时只支持这个 #Define Zeros				2		&& Zeros #Define ANSIX923			3		&& ANSIX923 #Define ISO10126			4		&& ISO10126*--加密Declare string AesCBCEncrypt In crypto.dll	string 		Str		  	;										   ,string 		Key		  	;										   ,string     	Iv			;										   ,string @ 	ErrorMsg*--解密Declare string AesCBCDecrypt In crypto.dll	string 		EncryptStr	;										   ,string 		Key		  	;										   ,string     	Iv			;										   ,string @ 	ErrorMsg*--获取随机Iv向量Declare string GenerateIV 	 In crypto.dll string @ 	ErrorMsgClear Local lcStr ;	, lcIv*--注意中文时要转成UTF8m.lcStr = Strconv( "test VFP AES加解密" , 9 )?"明文：" + Strconv( m.lcStr , 11 )Local lcAesKey 		;	, lcEncryptStr  ;	, lcErrorMsg	m.lcErrorMsg      = Space(256)m.lcAesKey 		  = "myverystrongpasswordo32bitlength"?"密匙 文本："??m.lcAesKey?"密匙 Hex："??Strconv( m.lcAesKey , 15 ) *--向量以动态生成*m.lcIv  		  = GenerateIV( @lcErrorMsg )*--以cKey 的16字节开头为固定的向量 m.lcIv  		  = Left( m.lcAesKey  , 16 )?"IV 文本:"??m.lcIv?"IV Hex："??Strconv( m.lcIv , 15 )??"		字节数:" + Transform( Len( m.lcIv )  )m.lcEncryptStr = AesCBCEncrypt( m.lcStr , m.lcAesKey , m.lcIv , @lcErrorMsg )If !Empty( m.lcErrorMsg )   ?"错误："   ??m.lcErrorMsgElse  	?"密文：" 	_cliptext = m.lcEncryptStr  &&复制以便在lzltool上验证	??m.lcEncryptStr Endif m.lcErrorMsg      = Space(256)Local lcDecryptStrm.lcDecryptStr = AesCBCDecrypt ( m.lcEncryptStr  , m.lcAesKey , m.lcIv, @lcErrorMsg )If !Empty( m.lcErrorMsg )   ?"错误："   ??m.lcErrorMsgElse  	?"解密：" 	??StrConv( m.lcDecryptStr , 11 )Endif ?"耗时："?? Seconds() - m.lnHstime