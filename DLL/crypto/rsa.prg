* RSA PEM格式 加解密* 获取/手工设置   公钥 | 私钥* 使用rsa.EncryptPKCS1v15加密* 使用rsa.DecryptPKCS1v15解密Clear Set Default To Justpath(  Sys(16)  )If !File("crypto.dll") Then     ?"调用库不存在"Endif Local lnHstimem.lnHstime = Seconds()*-- 生成RSA PrivateKey | PublicKeyDeclare long GenerateRSAKey In crypto.dll   long 		bits 		;										   ,string @	PrivateKey	;										   ,string @	PublicKey	; 										   ,string @	ErrorMsgDeclare string RsaEncrypt In crypto.dll string PlainText ;									  , string PublicKey ;									  , string @ ErrorMsg									  Declare string RsaDecrypt In crypto.dll string PlainText ;									  , string PrivateKey;									  , string @ ErrorMsgLocal lcPrivateKey	;	, lcPublicKey	;	, lnReturn		;	, lcErrorMsg    m.lcErrorMsg   = Space( 1024 )		m.lcPrivateKey = Space( 1024 )	&& 按C *Char格式尾部：Chr(0) + "\n"，注意地址回参后去掉m.lcPublicKey  = Space( 1024 )	&& 按C *Char格式尾部：Chr(0) + "\n"，注意地址回参后去掉*bits 256 , 512 , 1024 , 2048 ,4096 一般来说位越高就需要CPU和内存就越高m.lnReturn = GenerateRSAKey( 512 ,@lcPrivateKey , @lcPublicKey , @lcErrorMsg  )If m.lnReturn = -1 Then    ?"生成配对公私钥错误："   ??StrTran( Alltrim( m.lcErrorMsg ) , Chr(0), "" ) Else    ?"生成配对公私钥："   m.lcPrivateKey = Left( Alltrim( m.lcPrivateKey ) , Len( Alltrim( m.lcPrivateKey ) ) -2 )   ?m.lcPrivateKey   ?Chr(13)   m.lcPublicKey  = Left( Alltrim( m.lcPublicKey ) , Len( Alltrim( m.lcPublicKey ) )  -2  )   ?m.lcPublicKeyEndif *!*	*--手工 PKCS1v15 私钥*!*	Text To m.lcPrivateKey Noshow *!*	-----BEGIN RSA PRIVATE KEY-----*!*	MIICWwIBAAKBgQDcGsUIIAINHfRTdMmgGwLrjzfMNSrtgIf4EGsNaYwmC1GjF/bM*!*	h0Mcm10oLhNrKNYCTTQVGGIxuc5heKd1gOzb7bdTnCDPPZ7oV7p1B9Pud+6zPaco*!*	qDz2M24vHFWYY2FbIIJh8fHhKcfXNXOLovdVBE7Zy682X1+R1lRK8D+vmQIDAQAB*!*	AoGAeWAZvz1HZExca5k/hpbeqV+0+VtobMgwMs96+U53BpO/VRzl8Cu3CpNyb7HY*!*	64L9YQ+J5QgpPhqkgIO0dMu/0RIXsmhvr2gcxmKObcqT3JQ6S4rjHTln49I2sYTz*!*	7JEH4TcplKjSjHyq5MhHfA+CV2/AB2BO6G8limu7SheXuvECQQDwOpZrZDeTOOBk*!*	z1vercawd+J9ll/FZYttnrWYTI1sSF1sNfZ7dUXPyYPQFZ0LQ1bhZGmWBZ6a6wd9*!*	R+PKlmJvAkEA6o32c/WEXxW2zeh18sOO4wqUiBYq3L3hFObhcsUAY8jfykQefW8q*!*	yPuuL02jLIajFWd0itjvIrzWnVmoUuXydwJAXGLrvllIVkIlah+lATprkypH3Gyc*!*	YFnxCTNkOzIVoXMjGp6WMFylgIfLPZdSUiaPnxby1FNM7987fh7Lp/m12QJAK9iL*!*	2JNtwkSR3p305oOuAz0oFORn8MnB+KFMRaMT9pNHWk0vke0lB1sc7ZTKyvkEJW0o*!*	eQgic9DvIYzwDUcU8wJAIkKROzuzLi9AvLnLUrSdI6998lmeYO9x7pwZPukz3era*!*	zncjRK3pbVkv0KrKfczuJiRlZ7dUzVO0b6QJr8TRAA==*!*	-----END RSA PRIVATE KEY-----*!*	Endtext *!*	*--手工 PKCS1v15 公钥*!*	Text To m.lcPublicKey  Noshow *!*	-----BEGIN RSA PUBLIC KEY-----*!*	MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDcGsUIIAINHfRTdMmgGwLrjzfM*!*	NSrtgIf4EGsNaYwmC1GjF/bMh0Mcm10oLhNrKNYCTTQVGGIxuc5heKd1gOzb7bdT*!*	nCDPPZ7oV7p1B9Pud+6zPacoqDz2M24vHFWYY2FbIIJh8fHhKcfXNXOLovdVBE7Z*!*	y682X1+R1lRK8D+vmQIDAQAB*!*	-----END RSA PUBLIC KEY-----*!*	Endtext *--注意中文时要转成UTF8m.lcStr = Strconv( "test VFP RAS加解密" , 9 )?"明文：" + Strconv( m.lcStr , 11 )Local lcEncryptStrm.lcEncryptStr = RsaEncrypt( m.lcStr , m.lcPublicKey , @lcErrorMsg )If !Empty( m.lcErrorMsg ) Then     ?"RSA加密出错："    ??StrConv( StrTran( Alltrim( m.lcErrorMsg ) , Chr(0), "" ) , 11 )    Return Endif ? "密文：" ??m.lcEncryptStrLocal lcDecryptStrm.lcDecryptStr = RsaDecrypt( m.lcEncryptStr , m.lcPrivateKey , @lcErrorMsg )If !Empty( m.lcErrorMsg ) Then     ?"RSA解密出错："    ??StrConv( StrTran( Alltrim( m.lcErrorMsg ) , Chr(0), "" ) , 11 )    Return Endif ? "解密："??Strconv( m.lcDecryptStr ,  11 )?"耗时："?? Seconds() - m.lnHstime*!*	Clear Dlls*!*	Clear all